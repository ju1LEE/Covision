<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://www.mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="user.approvalList">
    <!-- 예고함 목록 데이터 -->
	<select id="selectPreApprovalList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT ProcessID AS "ProcessID"
				, WorkItemID AS "WorkItemID"
				, PerformerID AS "PerformerID"
				, InitiatorID AS "InitiatorID"
				, InitiatorName AS "InitiatorName"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, SubKind AS "SubKind"
				, FormSubKind AS "FormSubKind"
				, ProcessDescriptionID AS "ProcessDescriptionID"				
                , BusinessData1 AS "BusinessData1"
                , BusinessData2 AS "BusinessData2"
                , BusinessData3 AS "BusinessData3"
                , BusinessData4 AS "BusinessData4"
                , BusinessData5 AS "BusinessData5"
                , BusinessData6 AS "BusinessData6"
                , BusinessData7 AS "BusinessData7"
                , BusinessData8 AS "BusinessData8"
                , BusinessData9 AS "BusinessData9"
                , BusinessData10 AS "BusinessData10"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormPrefix AS "FormPrefix"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, Created AS "Created"
				, TaskID AS "TaskID"
				, ExtInfo  AS "ExtInfo"
				, PhotoPath AS "PhotoPath"
			FROM (
				SELECT A.ProcessID
						, B.WorkItemID
						, C.PerformerID
						, A.InitiatorID
						, A.InitiatorName
						, A.InitiatorUnitID
						, A.InitiatorUnitName
						, C.UserCode
						, C.UserName
						, C.SubKind
						, C.SubKind AS FormSubKind
						, D.*
						, B.Created AS Created
						, B.TaskID
						, F.ExtInfo
						, U.PhotoPath
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				LEFT OUTER JOIN JWF_Forms F ON D.FormID = F.FormID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.InitiatorID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
				</if>					
				WHERE C.UserCode = #{userID}
				AND C.State = 1
				AND C.SubKind = 'T010'
				AND B.State = 528
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>					
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) PreApprovalList
		    <!-- 검색 데이터 Where 절 -->
		    <trim prefix="WHERE" prefixOverrides="AND |OR ">
			  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	    Created BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			  	</if>
				<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
		    		AND 
		    		<choose>
						<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
						<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
						<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
						<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					</choose>
					LIKE '%' || #{searchWord} || '%'
				</if>
				<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND (
						FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
						InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
						InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
					)
				</if>
				<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
					<choose>
		                <when test="searchGroupType == 'Date' ">
		                    AND Created BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
		                </when>
		                <otherwise>
		                	AND 
		            		<choose>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
								<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
								<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
		            		</choose>
		            		= #{searchGroupWord} 
		                </otherwise>
		            </choose>
				</if>
				<if test="userNm != null and userNm !=''">
					AND InitiatorName LIKE '%' || #{userNm} || '%'
				</if>
				<if test="titleNm != null and titleNm !=''">
					AND FormSubject LIKE '%' || #{titleNm} || '%'
				</if>
			</trim>
		    <!-- Order by 절 -->
			<trim prefix="ORDER BY"  prefixOverrides =",">
			    <if test = "sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
					, Priority DESC 
			    </if>
			    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
			        , Created Desc
			    </if>
			  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
				 	, 
		    		<choose>
						<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
						<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
						<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
						<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
						<when test='sortColumn.equalsIgnoreCase("Created")'>Created</when>
						<when test='sortColumn.equalsIgnoreCase("IsComment")'>IsComment</when>
						<when test='sortColumn.equalsIgnoreCase("IsModify")'>IsModify</when>
						<when test='sortColumn.equalsIgnoreCase("BusinessData3")'>BusinessData3</when>
						<when test='sortColumn.equalsIgnoreCase("BusinessData4")'>BusinessData4</when>
						<when test='sortColumn.equalsIgnoreCase("SubUserName")'>BusinessData5</when>
					</choose>
					<choose>
						<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
						<otherwise> DESC</otherwise>
					</choose>
				</if>
			</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 예고함 목록 개수 데이터 -->
	<select id="selectPreApprovalListCnt" resultType="java.lang.Long">
		SELECT COUNT(*) FROM (
			SELECT PreApprovalList.* FROM (
				SELECT A.ProcessID
						, B.WorkItemID
						, C.PerformerID
						, A.InitiatorID
						, A.InitiatorName
						, A.InitiatorUnitID
						, A.InitiatorUnitName
						, C.UserCode
						, C.UserName
						, C.SubKind
						, C.SubKind AS FormSubKind
						, D.*
						, B.Created AS Created
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
				</if>					
				WHERE C.UserCode = #{userID}
				AND C.State = 1
				AND C.SubKind = 'T010'
				AND B.State = 528
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>					
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
				UNION ALL
				SELECT A.ProcessID
						, B.WorkItemID
						, C.PerformerID
						, A.InitiatorID
						, A.InitiatorName
						, A.InitiatorUnitID
						, A.InitiatorUnitName
						, C.UserCode
						, C.UserName
						, C.SubKind
						, C.SubKind AS FormSubKind
						, D.*
						, B.Created AS Created
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
				</if>
				WHERE B.DeputyID = #{userID}
				AND C.State = 1
				AND C.SubKind = 'T010'
				AND B.State = 528
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>					
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) PreApprovalList
		    <!-- 검색 데이터 Where 절 -->
		    <trim prefix="WHERE" prefixOverrides="AND |OR ">
			  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	    Created BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			  	</if>
				<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
		    		AND 
		    		<choose>
						<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
						<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
						<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
						<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					</choose>
					LIKE '%' || #{searchWord} || '%'
				</if>
				<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND (
						FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
						InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
						InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
					)
				</if>
				<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
					<choose>
		                <when test="searchGroupType == 'Date' ">
		                    AND Created BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
		                </when>
		                <otherwise>
		                	AND 
		            		<choose>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
								<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
								<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
		            		</choose>
		            		= #{searchGroupWord}
		                </otherwise>
		            </choose>
				</if>
				<if test="userNm != null and userNm !=''">
					AND InitiatorName LIKE '%' || #{userNm} || '%'
				</if>
				<if test="titleNm != null and titleNm !=''">
					AND FormSubject LIKE '%' || #{titleNm} || '%'
				</if>
			</trim> 
	     ) A
	</select>

	<!-- 예고함 그룹별 목록 조회 -->
	<select id="selectPreApprovalGroupList" parameterType="cmap" resultType="cmap">
			SELECT 
         		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>PreApprovalList."Date" </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>PreApprovalList.InitiatorID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>PreApprovalList.InitiatorUnitID </when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>PreApprovalList.FormPrefix </when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>PreApprovalList.SubKind </when>
         		</choose>
			AS "fieldID"
			, COUNT(1) AS "fieldCnt"
		<if test="searchGroupType == 'Date'">
	        , PreApprovalList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	        , PreApprovalList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	        , PreApprovalList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	        , PreApprovalList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	        , PreApprovalList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT A.ProcessID
						, B.WorkItemID
						, C.PerformerID
						, A.InitiatorID
						, A.InitiatorName
						, A.InitiatorUnitID
						, A.InitiatorUnitName
						, C.UserCode
						, C.UserName
						, C.SubKind
						, C.SubKind AS FormSubKind
						, D.*
						<choose>
							<when test="searchGroupType == 'Date'">
								, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.Created), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
							</when>
							<otherwise>
								, TO_CHAR(B.Created,'YYYY-MM-DD') AS "Date"
							</otherwise>
						</choose>
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
				</if>				
				WHERE C.UserCode = #{userID}
				AND C.State = 1
				AND C.SubKind = 'T010'
				AND B.State = 528
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
				UNION ALL
				SELECT A.ProcessID
						, B.WorkItemID
						, C.PerformerID
						, A.InitiatorID
						, A.InitiatorName
						, A.InitiatorUnitID
						, A.InitiatorUnitName
						, C.UserCode
						, C.UserName
						, C.SubKind
						, C.SubKind AS FormSubKind
						, D.*
						<choose>
							<when test="searchGroupType == 'Date'">
								, TO_CHAR(B.Created,'YYYY-MM-DD') AS "Date"
							</when>
							<otherwise>
								, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.Created), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
							</otherwise>
						</choose>
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
				</if>				
				WHERE B.DeputyID = #{userID}
				AND C.State = 1
				AND C.SubKind = 'T010'
				AND B.State = 528
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) PreApprovalList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		"Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
		  	    <if test="searchGroupType == 'Date'">
			 		PreApprovalList."Date"
			 	</if>
			 	<if test="searchGroupType != 'Date' ">
	           		<choose>
						<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>PreApprovalList.InitiatorID</when>
						<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>PreApprovalList.InitiatorUnitID</when>
						<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>PreApprovalList.FormPrefix</when>
						<when test='searchGroupType.equalsIgnoreCase("SubKind")'>PreApprovalList.SubKind </when>
	           		</choose>
			 	    <if test="searchGroupType == 'FormPrefix'">
				        , PreApprovalList.FormName
				    </if>
				     <if test="searchGroupType == 'InitiatorID'">
				        , PreApprovalList.InitiatorName
				    </if>
				     <if test="searchGroupType == 'InitiatorUnitID'">
				        , PreApprovalList.InitiatorUnitName
				    </if>
			 	</if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

    <!-- 미결함 목록 데이터 -->
    <select id="selectApprovalList" parameterType="cmap" resultType="cmap">
         <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessID AS "ProcessID"
				, ParentProcessID AS "ParentProcessID"
				, WorkItemID AS "WorkItemID"
				, PerformerID AS "PerformerID"
				, InitiatorID AS "InitiatorID"
				, InitiatorName AS "InitiatorName"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, SubKind AS "SubKind"
				, SubKind AS "FormSubKind"
				, ProcessDescriptionID AS "ProcessDescriptionID"
                , BusinessData1 AS "BusinessData1"
                , BusinessData2 AS "BusinessData2"
                , BusinessData3 AS "BusinessData3"
                , BusinessData4 AS "BusinessData4"
                , BusinessData5 AS "BusinessData5"
                , BusinessData6 AS "BusinessData6"
                , BusinessData7 AS "BusinessData7"
                , BusinessData8 AS "BusinessData8"
                , BusinessData9 AS "BusinessData9"
                , BusinessData10 AS "BusinessData10"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormPrefix AS "FormPrefix"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, Created AS "Created"
				, TaskID AS "TaskID"
				, ReadDate AS "ReadDate"
				, ExtInfo AS "ExtInfo"
				, PhotoPath AS "PhotoPath"
				, ProcessName AS "ProcessName"
				, SchemaContext AS "SchemaContext"
			FROM (
				SELECT A.ProcessID
				, A.ParentProcessID
				, B.WorkItemID
				, C.PerformerID
				, A.InitiatorID
				, A.InitiatorName
				, A.InitiatorUnitID
				, A.InitiatorUnitName
				, C.UserCode
				, C.UserName
				, C.SubKind
				, C.SubKind AS FormSubKind
				, D.*
				, B.Created AS Created
				, B.TaskID
				, R.ReadDate AS ReadDate
				, F.ExtInfo
				, U.PhotoPath
				, A.ProcessName
				, NVL(JF.SchemaContext, '') as SchemaContext
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				LEFT OUTER JOIN JWF_DocReadHistory R ON A.ProcessID = R.ProcessID AND C.UserCode = R.UserID AND R.AdminYN = 'N' AND R.FormInstID > 0
				LEFT OUTER JOIN JWF_Forms F ON D.FormID = F.FormID
				LEFT OUTER JOIN jwf_formsschema JF ON F.SchemaID = JF.SchemaID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.InitiatorID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
				</if>					
				WHERE C.UserCode = #{userID}
				AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T023')
				AND C.State = 1
				AND B.State = 288
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
	
				<if test="userID != null and userID != '' ">
					UNION ALL
		
					SELECT A.ProcessID
					, A.ParentProcessID
					, B.WorkItemID
					, C.PerformerID
					, A.InitiatorID
					, A.InitiatorName
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, C.UserCode
					, C.UserName
					, C.SubKind
					, C.SubKind AS FormSubKind
					, D.*
					, B.Created AS Created
					, B.TaskID
					, R.ReadDate AS ReadDate
					, F.ExtInfo
					, U.PhotoPath
					, A.ProcessName
					, NVL(JF.SchemaContext, '') as SchemaContext
					FROM JWF_Process A
					INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
					INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
					INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
					LEFT OUTER JOIN JWF_DocReadHistory R ON A.ProcessID = R.ProcessID AND B.DeputyID = R.UserID AND R.FormInstID > 0
					LEFT OUTER JOIN JWF_Forms F ON D.FormID = F.FormID
					LEFT OUTER JOIN jwf_formsschema JF ON F.SchemaID = JF.SchemaID
					LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.InitiatorID
					<if test="companyCode != null and companyCode != '' ">
						INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
					</if>					
					WHERE B.DeputyID = #{userID}
					AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017')
					AND C.State = 1
					AND B.State = 288
					AND A.ProcessState = 288
					<if test="adminYn == null or adminYn == '' ">
						AND A.DeleteDate IS NULL
					</if>
					<if test="companyCode != null and companyCode != '' ">
						AND SOG.CompanyCode = #{companyCode}
						AND SOG.GroupType = 'Dept'
					</if>					
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (D.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR D.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND D.BusinessData1 = #{businessData1}
						</when>
					</choose>
				</if>
			) ApprovalList
		    <!-- 검색 데이터 Where 절 -->
		    <trim prefix="WHERE" prefixOverrides="AND |OR ">
			  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  		Created BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			  	</if>
				<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
		    		AND 
		    		<choose>
						<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
						<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
						<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
						<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					</choose>
					LIKE '%' || #{searchWord} || '%'
				</if>
				<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND (
						FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
						InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
						InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
					)
				</if>
				<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
					<choose>
		                <when test="searchGroupType == 'Date' ">
		                    AND Created BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
		                </when>
		                <otherwise>
		                	AND 
		            		<choose>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
								<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
								<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
		            		</choose>
		            		= #{searchGroupWord}
		                </otherwise>
		            </choose>
				</if>
				<if test="userNm != null and userNm !=''">
					AND InitiatorName LIKE '%' || #{userNm} || '%'
				</if>
				<if test="titleNm != null and titleNm !=''">
					AND FormSubject LIKE '%' || #{titleNm} || '%'
				</if>
			</trim>
		    <!-- Order by 절 -->
			<trim prefix="ORDER BY"  prefixOverrides =",">
			  	<if test = "sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
					, Priority DESC 
			    </if>
			    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
			        , Created Desc
			    </if>
			  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
				 	, 
		    		<choose>
						<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
						<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
						<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
						<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
						<when test='sortColumn.equalsIgnoreCase("Created")'>Created</when>
						<when test='sortColumn.equalsIgnoreCase("IsComment")'>IsComment</when>
						<when test='sortColumn.equalsIgnoreCase("IsModify")'>IsModify</when>
						<when test='sortColumn.equalsIgnoreCase("BusinessData3")'>BusinessData3</when>
						<when test='sortColumn.equalsIgnoreCase("BusinessData4")'>BusinessData4</when>
						<when test='sortColumn.equalsIgnoreCase("SubUserName")'>BusinessData5</when>
					</choose>
					<choose>
						<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
						<otherwise> DESC</otherwise>
					</choose>
				</if>
			</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 미결함 목록 개수 데이터 -->
	<select id="selectApprovalListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM  (
			SELECT ApprovalList.* FROM (
				SELECT A.ProcessID
				, B.WorkItemID
				, C.PerformerID
				, A.InitiatorID
				, A.InitiatorName
				, A.InitiatorUnitID
				, A.InitiatorUnitName
				, C.UserCode
				, C.UserName
				, C.SubKind
				, C.SubKind AS FormSubKind
				, D.*
				, B.Created AS Created
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
				</if>					
				WHERE C.UserCode = #{userID}
				AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T023')
				AND C.State = 1
				AND B.State = 288
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
	
				<if test="userID != null and userID != '' ">
					UNION ALL
		
					SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, A.InitiatorID
					, A.InitiatorName
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, C.UserCode
					, C.UserName
					, C.SubKind
					, C.SubKind AS FormSubKind
					, D.*
					, B.Created AS Created
					FROM JWF_Process A
					INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
					INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
					INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
					<if test="companyCode != null and companyCode != '' ">
						INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
					</if>					
					WHERE B.DeputyID = #{userID}
					AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017')
					AND C.State = 1
					AND B.State = 288
					AND A.ProcessState = 288
					<if test="adminYn == null or adminYn == '' ">
						AND A.DeleteDate IS NULL
					</if>
					<if test="companyCode != null and companyCode != '' ">
						AND SOG.CompanyCode = #{companyCode}
						AND SOG.GroupType = 'Dept'
					</if>					
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (D.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR D.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND D.BusinessData1 = #{businessData1}
						</when>
					</choose>
				</if>
			) ApprovalList
		    <!-- 검색 데이터 Where 절 -->
		    <trim prefix="WHERE" prefixOverrides="AND |OR ">
			  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	    Created BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			  	</if>
				<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
		    		AND 
		    		<choose>
						<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
						<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
						<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
						<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					</choose>
					LIKE '%' || #{searchWord} || '%'
				</if>
				<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND (
						FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
						InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
						InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
					)
				</if>
				<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
					<choose>
		                <when test="searchGroupType == 'Date' ">
		                    AND Created BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
		                </when>
		                <otherwise>
		                	AND 
		            		<choose>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
								<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
								<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
		            		</choose>
		            		= #{searchGroupWord}
		                </otherwise>
		            </choose>
				</if>
				<if test="userNm != null and userNm !=''">
					AND InitiatorName LIKE '%' || #{userNm} || '%'
				</if>
				<if test="titleNm != null and titleNm !=''">
					AND FormSubject LIKE '%' || #{titleNm} || '%'
				</if>
			</trim>
		) A
	</select>

	<!-- 미결함 그룹별 목록 조회 -->
	<select id="selectApprovalGroupList" parameterType="cmap" resultType="cmap">
			SELECT 
         		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>ApprovalList."Date" </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>ApprovalList.InitiatorID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>ApprovalList.InitiatorUnitID </when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>ApprovalList.FormPrefix </when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>ApprovalList.SubKind </when>
         		</choose>
			AS "fieldID"
			, COUNT(1) AS "fieldCnt"
		<if test="searchGroupType == 'Date'">
	        , ApprovalList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	        , ApprovalList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	        , ApprovalList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	        , ApprovalList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	        , ApprovalList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT A.ProcessID
				, A.DocSubject AS FormSubject
				, B.WorkItemID
				, C.PerformerID
				, A.InitiatorID
				, A.InitiatorName
				, A.InitiatorUnitID
				, A.InitiatorUnitName
				, C.UserCode
				, C.UserName
				, C.SubKind
				, D.FormID
				, D.FormPrefix
				, D.FormName
				<choose>
					<when test="searchGroupType == 'Date'">
						, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.Created), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
					</when>
					<otherwise>
						, TO_CHAR(B.Created,'YYYY-MM-DD') AS "Date"
					</otherwise>
				</choose>
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
				</if>				
				WHERE C.UserCode = #{userID}
				AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T023')
				AND C.State = 1
				AND B.State = 288
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>

				<if test="userID != null and userID != '' ">
					UNION ALL
	
					SELECT A.ProcessID
					, A.DocSubject AS FormSubject
					, B.WorkItemID
					, C.PerformerID
					, A.InitiatorID
					, A.InitiatorName
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, C.UserCode
					, C.UserName
					, C.SubKind
					, D.FormID
					, D.FormPrefix
					, D.FormName
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(B.Created,'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.Created), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
					FROM JWF_Process A
					INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
					INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
					INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
					<if test="companyCode != null and companyCode != '' ">
						INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
					</if>					
					WHERE B.DeputyID = #{userID}
					AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017')
					AND C.State = 1
					AND B.State = 288
					AND A.ProcessState = 288
					<if test="adminYn == null or adminYn == '' ">
						AND A.DeleteDate IS NULL
					</if>
					<if test="companyCode != null and companyCode != '' ">
						AND SOG.CompanyCode = #{companyCode}
						AND SOG.GroupType = 'Dept'
					</if>					
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (D.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR D.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND D.BusinessData1 = #{businessData1}
						</when>
					</choose>
				</if>
			) ApprovalList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	"Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
		  	    <if test="searchGroupType == 'Date'">
			 		ApprovalList."Date"
			 	</if>
			 	<if test="searchGroupType != 'Date'">
	           		<choose>
						<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>ApprovalList.InitiatorID</when>
						<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>ApprovalList.InitiatorUnitID</when>
						<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>ApprovalList.FormPrefix</when>
						<when test='searchGroupType.equalsIgnoreCase("SubKind")'>ApprovalList.SubKind </when>
	           		</choose>
			 	    <if test="searchGroupType == 'FormPrefix'">
				      , ApprovalList.FormName
				  	</if>
				   	<if test="searchGroupType == 'InitiatorID'">
				      , ApprovalList.InitiatorName
				  	</if>
				   	<if test="searchGroupType == 'InitiatorUnitID'">
				      , ApprovalList.InitiatorUnitName
				  	</if>
			 	</if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 미결함 엑셀 데이터 조회 -->
	<select id="selectApprovalListExcel" parameterType="cmap" resultType="cmap">
		SELECT
			SubKind AS "SubKind"
			,ApprovalStep AS "ApprovalStep"
			,FormSubject AS "FormSubject"
			,InitiatorID AS "InitiatorID"
			,InitiatorName AS "InitiatorName"
			,InitiatorUnitID AS "InitiatorUnitID"
			,InitiatorUnitName AS "InitiatorUnitName"
			,IsFile AS "IsFile"
			,FormName AS "FormName"
			,TO_CHAR(Created, 'YYYY-MM-DD HH24:MI:SS') AS "Created"
			,IsComment AS "IsComment"
			,IsModify AS "IsModify"
			,FormID AS "FormID"
			,Priority AS "Priority"
			,BusinessData3 AS "BusinessData3"
			,BusinessData4 AS "BusinessData4"
			,BusinessData5 AS "BusinessData5"
			,SubUserName as "SubUserName"
		FROM (
			SELECT C.SubKind
			,D.ApprovalStep
			,D.FormSubject
			,A.InitiatorID
			,A.InitiatorName
			,A.InitiatorUnitID
			,A.InitiatorUnitName
			,D.IsFile
			,D.FormName
			,D.FormPrefix
			,B.Created AS Created
			,D.IsComment
			,D.IsModify
			,D.FormID
			,D.Priority
			,D.BusinessData3 AS BusinessData3
			,D.BusinessData4 AS BusinessData4
			,D.BusinessData5 AS BusinessData5
			,Fn_SplitString_r(D.businessdata5, '^^^', 2) as SubUserName
			FROM JWF_Process A
			INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
			INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
			INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
			<if test="companyCode != null and companyCode != '' ">
				INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
			</if>					
			WHERE C.UserCode = #{userID}
			AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T023')
			AND C.State = 1
			AND B.State = 288
			AND A.ProcessState = 288
			<if test="adminYn == null or adminYn == '' ">
				AND A.DeleteDate IS NULL
			</if>
			<if test="companyCode != null and companyCode != '' ">
				AND SOG.CompanyCode = #{companyCode}
				AND SOG.GroupType = 'Dept'
			</if>
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (D.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR D.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND D.BusinessData1 = #{businessData1}
				</when>
			</choose>

			<if test="userID != null and userID != '' ">
				UNION ALL
	
				SELECT C.SubKind
				,D.ApprovalStep
				,D.FormSubject
				,A.InitiatorID
				,A.InitiatorName
				,A.InitiatorUnitID
				,A.InitiatorUnitName
				,D.IsFile
				,D.FormName
				,D.FormPrefix
				,B.Created AS Created
				,D.IsComment
				,D.IsModify
				,D.FormID
				,D.Priority
				,D.BusinessData3 AS BusinessData3
				,D.BusinessData4 AS BusinessData4
				,D.BusinessData5 AS BusinessData5
				,Fn_SplitString_r(D.businessdata5, '^^^', 2) as SubUserName
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
				</if>					
				WHERE B.DeputyID = #{userID}
				AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017')
				AND C.State = 1
				AND B.State = 288
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			</if>
		) ApprovalList
		<!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	 Created BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND Created BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY"  prefixOverrides =",">
		    <if test = "sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
				, Priority DESC 
		    </if>
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , Created Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("Created")'>Created</when>
					<when test='sortColumn.equalsIgnoreCase("IsComment")'>IsComment</when>
					<when test='sortColumn.equalsIgnoreCase("IsModify")'>IsModify</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData3")'>BusinessData3</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData4")'>BusinessData4</when>
					<when test='sortColumn.equalsIgnoreCase("SubUserName")'>BusinessData5</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>

	<!-- 진행함 목록 데이터 -->
	<select id="selectProcessList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessList.ProcessID AS "ProcessID"
				, WorkItemID AS "WorkItemID"
				, PerformerID AS "PerformerID"
				, InitiatorID AS "InitiatorID"
				, InitiatorName AS "InitiatorName"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, SubKind AS "SubKind"
				, SubKind AS "FormSubKind"
				, ProcessDescriptionID AS "ProcessDescriptionID"				
                , BusinessData1 AS "BusinessData1"
                , BusinessData2 AS "BusinessData2"
                , BusinessData3 AS "BusinessData3"
                , BusinessData4 AS "BusinessData4"
                , BusinessData5 AS "BusinessData5"
                , BusinessData6 AS "BusinessData6"
                , BusinessData7 AS "BusinessData7"
                , BusinessData8 AS "BusinessData8"
                , BusinessData9 AS "BusinessData9"
                , BusinessData10 AS "BusinessData10"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormPrefix AS "FormPrefix"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, StartDate AS "StartDate"
				, Finished AS "Finished"
				, ReadDate AS "ReadDate"
				, TaskID AS "TaskID"
				, ExtInfo AS "ExtInfo"
				, PhotoPath AS "PhotoPath"
				, JD.DomainDataContext AS "DomainDataContext"
			FROM (
				SELECT A.ProcessID
				, B.WorkItemID
				, C.PerformerID
				, A.InitiatorID
				, A.InitiatorName
				, A.InitiatorUnitID
				, A.InitiatorUnitName
				, C.UserCode
				, C.UserName
				, C.SubKind
				, C.SubKind AS FormSubKind
				, D.*
				, A.StartDate AS StartDate
				, NVL(B.Finished, '') AS Finished
				, NVL(R.ReadDate, '') AS ReadDate
				, B.TaskID
				, F.ExtInfo
				, U.PhotoPath
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				LEFT OUTER JOIN JWF_Forms F ON D.FormID = F.FormID
				LEFT OUTER JOIN JWF_DocReadHistory R ON A.ProcessID = R.ProcessID AND C.UserCode = R.UserID AND R.AdminYN = 'N' AND R.FormInstID > 0
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.InitiatorID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
				</if>				
				WHERE C.UserCode = #{userID}
				AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T020','T023')
				AND C.State = 1
				AND B.State = 528
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>

				<if test="userID != null and userID != '' ">
					UNION ALL
	
					SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, A.InitiatorID
					, A.InitiatorName
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, C.UserCode
					, C.UserName
					, C.SubKind
					, C.SubKind AS FormSubKind
					, D.*
					, A.StartDate AS StartDate
					, NVL(B.Finished, '') AS Finished
					, NVL(R.ReadDate, '') AS ReadDate
					, B.TaskID
					, F.ExtInfo
					, U.PhotoPath
					FROM JWF_Process A
					INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
					INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
					INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
					LEFT OUTER JOIN JWF_Forms F ON D.FormID = F.FormID
					LEFT OUTER JOIN JWF_DocReadHistory R ON A.ProcessID = R.ProcessID AND C.UserCode = R.UserID AND R.AdminYN = 'N' AND R.FormInstID > 0
					LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.InitiatorID
					<if test="companyCode != null and companyCode != '' ">
						INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
					</if>					
					WHERE B.DeputyID = #{userID}
					AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016')
					AND C.State = 1
					AND B.State = 528
					AND A.ProcessState = 288
					<if test="adminYn == null or adminYn == '' ">
						AND A.DeleteDate IS NULL
					</if>
					<if test="companyCode != null and companyCode != '' ">
						AND SOG.CompanyCode = #{companyCode}
						AND SOG.GroupType = 'Dept'
					</if>					
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (D.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR D.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND D.BusinessData1 = #{businessData1}
						</when>
					</choose>
				</if>
			) ProcessList
		INNER JOIN jwf_domaindata JD ON ProcessList.ProcessID = JD.ProcessID
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	Finished BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 --> 
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND Finished BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY"  prefixOverrides =",">  
		    <if test = "sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
				, Priority DESC 
		    </if>
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , Finished Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("Created")'>Created</when>
					<when test='sortColumn.equalsIgnoreCase("IsComment")'>IsComment</when>
					<when test='sortColumn.equalsIgnoreCase("IsModify")'>IsModify</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData3")'>BusinessData3</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData4")'>BusinessData4</when>
					<when test='sortColumn.equalsIgnoreCase("SubUserName")'>BusinessData5</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 진행함 목록 개수 데이터 -->
	<select id="selectProcessListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
			SELECT ProcessList.* FROM (
				SELECT A.ProcessID
				, B.WorkItemID
				, C.PerformerID
				, A.InitiatorID
				, A.InitiatorName
				, A.InitiatorUnitID
				, A.InitiatorUnitName
				, C.UserCode
				, C.UserName
				, C.SubKind
				, C.SubKind AS FormSubKind
				, D.*
				, A.StartDate AS StartDate
				, NVL(B.Finished, '') AS Finished
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
				</if>				
				WHERE C.UserCode = #{userID}
				AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T020','T023')
				AND C.State = 1
				AND B.State = 528
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
				
				<if test="userID != null and userID != '' ">
					UNION ALL
	
					SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, A.InitiatorID
					, A.InitiatorName
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, C.UserCode
					, C.UserName
					, C.SubKind
					, C.SubKind AS FormSubKind
					, D.*
					, A.StartDate AS StartDate
					, NVL(B.Finished, '') AS Finished
					FROM JWF_Process A
					INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
					INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
					INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
					<if test="companyCode != null and companyCode != '' ">
						INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
					</if>					
					WHERE B.DeputyID = #{userID}
					AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016')
					AND C.State = 1
					AND B.State = 528
					AND A.ProcessState = 288
					<if test="adminYn == null or adminYn == '' ">
						AND A.DeleteDate IS NULL
					</if>
					<if test="companyCode != null and companyCode != '' ">
						AND SOG.CompanyCode = #{companyCode}
						AND SOG.GroupType = 'Dept'
					</if>					
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (D.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR D.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND D.BusinessData1 = #{businessData1}
						</when>
					</choose>
				</if>
			) ProcessList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	Finished BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 --> 
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND Finished BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 진행함 그룹별 목록 조회 -->
	<select id="selectProcessGroupList" parameterType="cmap" resultType="cmap">
			SELECT 
         		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>ProcessList."Date" </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>ProcessList.InitiatorID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>ProcessList.InitiatorUnitID </when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>ProcessList.FormPrefix </when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>ProcessList.SubKind </when>
         		</choose>
			AS "fieldID"
			, COUNT(1) AS "fieldCnt"
		<if test="searchGroupType == 'Date'">
	        , ProcessList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	        , ProcessList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	        , ProcessList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	        , ProcessList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	        , ProcessList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT A.ProcessID
				, B.WorkItemID
				, C.PerformerID
				, A.InitiatorID
				, A.InitiatorName
				, A.InitiatorUnitID
				, A.InitiatorUnitName
				, C.UserCode
				, C.UserName
				, C.SubKind
				, D.*
				<choose>
					<when test="searchGroupType == 'Date'">
						, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.Finished), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
					</when>
					<otherwise>
						, TO_CHAR(B.Finished,'YYYY-MM-DD') AS "Date"
					</otherwise>
				</choose>
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
				</if>
				WHERE C.UserCode = #{userID}
				AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T020','T023')
				AND C.State = 1
				AND B.State = 528
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>

				<if test="userID != null and userID != '' ">
					UNION ALL
	
					SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, A.InitiatorID
					, A.InitiatorName
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, C.UserCode
					, C.UserName
					, C.SubKind
					, D.*
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.Finished), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(B.Finished,'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
					FROM JWF_Process A
					INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
					INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
					INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
					<if test="companyCode != null and companyCode != '' ">
						INNER JOIN sys_object_group AS SOG  ON SOG.GroupCode = A.InitiatorUnitID
					</if>
					WHERE B.DeputyID = #{userID}
					AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016')
					AND C.State = 1
					AND B.State = 528
					AND A.ProcessState = 288
					<if test="adminYn == null or adminYn == '' ">
						AND A.DeleteDate IS NULL
					</if>
					<if test="companyCode != null and companyCode != '' ">
						AND SOG.CompanyCode = #{companyCode}
						AND SOG.GroupType = 'Dept'
					</if>
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (D.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR D.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND D.BusinessData1 = #{businessData1}
						</when>
					</choose>
				</if>
			) ProcessList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	"Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%'			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
           		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>ProcessList."Date"</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>ProcessList.InitiatorID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>ProcessList.InitiatorUnitID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>ProcessList.InitiatorUnitName</when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>ProcessList.FormPrefix</when>
					<when test='searchGroupType.equalsIgnoreCase("FormName")'>ProcessList.FormName</when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>ProcessList.SubKind </when>
           		</choose>
			 	<if test="searchGroupType != 'Date'">
			 		<if test="searchGroupType == 'FormPrefix'">
				        , ProcessList.FormName
				    </if>
				     <if test="searchGroupType == 'InitiatorID'">
				        , ProcessList.InitiatorName
				    </if>
				     <if test="searchGroupType == 'InitiatorUnitID'">
				        , ProcessList.InitiatorUnitName
				    </if>
			 	</if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 진행함 엑셀 데이터 조회 -->
	<select id="selectProcessListExcel" parameterType="cmap" resultType="cmap">
		SELECT
			SubKind AS "SubKind"
			,ApprovalStep AS "ApprovalStep"
			,FormSubject AS "FormSubject"
			,InitiatorID AS "InitiatorID"
			,InitiatorName AS "InitiatorName"
			,InitiatorUnitID AS "InitiatorUnitID"
			,InitiatorUnitName AS "InitiatorUnitName"
			,IsFile AS "IsFile"
			,FormName AS "FormName"
			,NVL(TO_CHAR(Finished, 'YYYY-MM-DD HH24:MI:SS'), '') AS "Finished"
			,IsComment AS "IsComment"
			,IsModify AS "IsModify"
			,FormID AS "FormID"
			,Priority AS "Priority" 
			,SubUserName AS "SubUserName" 
		FROM (
			SELECT A.ProcessID
			, B.WorkItemID
			, C.PerformerID
			, A.InitiatorID
			, A.InitiatorName
			, A.InitiatorUnitID
			, A.InitiatorUnitName
			, C.UserCode
			, C.UserName
			, C.SubKind
			, D.*
			, B.Finished AS Finished
			, Fn_SplitString_r(D.businessdata5, '^^^', 2) as SubUserName
			FROM JWF_Process A
			INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
			INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
			INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
			<if test="companyCode != null and companyCode != '' ">
				INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
			</if>			
			WHERE C.UserCode = #{userID}
			AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T020','T023')
			AND C.State = 1
			AND B.State = 528
			AND A.ProcessState = 288
			<if test="adminYn == null or adminYn == '' ">
				AND A.DeleteDate IS NULL
			</if>
			<if test="companyCode != null and companyCode != '' ">
				AND SOG.CompanyCode = #{companyCode}
				AND SOG.GroupType = 'Dept'
			</if>			
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (D.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR D.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND D.BusinessData1 = #{businessData1}
				</when>
			</choose>

			<if test="userID != null and userID != '' ">
				UNION ALL
	
				SELECT A.ProcessID
				, B.WorkItemID
				, C.PerformerID
				, A.InitiatorID
				, A.InitiatorName
				, A.InitiatorUnitID
				, A.InitiatorUnitName
				, C.UserCode
				, C.UserName
				, C.SubKind
				, D.*
				, B.Finished AS Finished
				, Fn_SplitString_r(D.businessdata5, '^^^', 2) as SubUserName
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = A.InitiatorUnitID
				</if>				
				WHERE B.DeputyID = #{userID}
				AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016')
				AND C.State = 1
				AND B.State = 528
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			</if>
		) ProcessList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	Finished BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND Finished BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("FormName")'>FormName</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test = "sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
				, Priority DESC 
		    </if>
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , Finished Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("Created")'>Created</when>
					<when test='sortColumn.equalsIgnoreCase("IsComment")'>IsComment</when>
					<when test='sortColumn.equalsIgnoreCase("IsModify")'>IsModify</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData3")'>BusinessData3</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData4")'>BusinessData4</when>
					<when test='sortColumn.equalsIgnoreCase("SubUserName")'>BusinessData5</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>

	<!-- 완료함 목록 데이터 -->
	<select id="selectCompleteList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessArchiveID AS "ProcessArchiveID"
				, PerformerID AS "PerformerID"
				, WorkitemArchiveID AS "WorkitemArchiveID"
				, FormPrefix AS "FormPrefix"
				, InitiatorID AS "InitiatorID"
				, InitiatorName AS "InitiatorName"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, SubKind AS "SubKind"
				, SubKind AS "FormSubKind"
				, ProcessDescriptionArchiveID AS "ProcessDescriptionArchiveID"				
                , BusinessData1 AS "BusinessData1"
                , BusinessData2 AS "BusinessData2"
                , BusinessData3 AS "BusinessData3"
                , BusinessData4 AS "BusinessData4"
                , BusinessData5 AS "BusinessData5"
                , BusinessData6 AS "BusinessData6"
                , BusinessData7 AS "BusinessData7"
                , BusinessData8 AS "BusinessData8"
                , BusinessData9 AS "BusinessData9"
                , BusinessData10 AS "BusinessData10"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, DocNo AS "DocNo"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, EndDate AS "EndDate"
				, TaskID AS "TaskID"
				, ExtInfo AS "ExtInfo"
				, PhotoPath AS "PhotoPath"
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					, BodyContextOrg AS "BodyContextOrg"
				</if>
			FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkitemID AS WorkitemArchiveID
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.ProcessDescriptionID AS ProcessDescriptionArchiveID
					, C.FormInstID,C.FormID, C.FormPrefix, C.FormName,C.FormSubject,C.IsSecureDoc,C.IsFile,C.FileExt,C.IsComment
					, C.DocNo, C.ApproverCode,C.ApproverName,C.ApprovalStep
					, C.ApproverSIPAddress,C.IsReserved,C.ReservedGubun,C.ReservedTime,C.Priority,C.IsModify,C.Reserved1,C.Reserved2,C.BusinessData1,C.BusinessData2,C.BusinessData3,C.BusinessData4,C.BusinessData5
					, C.BusinessData6,C.BusinessData7,C.BusinessData8,C.BusinessData9,C.BusinessData10
					, B.EndDate
					, A.TaskID
					, F.ExtInfo
					, U.PhotoPath
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg AS BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				LEFT OUTER JOIN JWF_Forms F ON C.FormID = F.FormID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE ((A.UserCode = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021','T023'))
					<if test="userID != null and userID != '' ">
						OR (A.DeputyID = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021'))
					</if>
				)
				AND B.ProcessState = 528
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_01'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) CompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%'			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="formSubject != null and formSubject !=''">
				AND FormSubject LIKE '%' || #{formSubject} || '%'
			</if>
			<if test="initiatorName != null and initiatorName !=''">
				AND InitiatorName LIKE '%' || #{initiatorName} || '%'
			</if>
			<if test="initiatorUnitName != null and initiatorUnitName !=''">
				AND InitiatorUnitName LIKE '%' || #{initiatorUnitName} || '%'
			</if>
			<if test="formName != null and formName !=''">
				AND FormName LIKE '%' || #{formName} || '%'
			</if>
			<if test="docNo != null and docNo !=''">
				AND DocNo LIKE '%' || #{docNo} || '%'
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("FormName")'>FormName</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("IsModify")'>IsModify</when>
					<when test='sortColumn.equalsIgnoreCase("endDate")'>endDate</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData3")'>BusinessData3</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData4")'>BusinessData4</when>
					<when test='sortColumn.equalsIgnoreCase("SubUserName")'>BusinessData5</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 완료함 목록 개수 데이터 -->
	<select id="selectCompleteListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
			SELECT CompleteList.ProcessArchiveID FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkitemID AS WorkitemArchiveID
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					, B.EndDate AS EndDate
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE ((A.UserCode = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021','T023'))
					<if test="userID != null and userID != '' ">
						OR (A.DeputyID = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021'))
					</if>
				)
				AND B.ProcessState = 528				
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_01'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) CompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%'			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="formSubject != null and formSubject !=''">
				AND FormSubject LIKE '%' || #{formSubject} || '%'
			</if>
			<if test="initiatorName != null and initiatorName !=''">
				AND InitiatorName LIKE '%' || #{initiatorName} || '%'
			</if>
			<if test="initiatorUnitName != null and initiatorUnitName !=''">
				AND InitiatorUnitName LIKE '%' || #{initiatorUnitName} || '%'
			</if>
			<if test="formName != null and formName !=''">
				AND FormName LIKE '%' || #{formName} || '%'
			</if>
			<if test="docNo != null and docNo !=''">
				AND DocNo LIKE '%' || #{docNo} || '%'
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("FormName")'>FormName</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 완료함 그룹별 목록 조회 -->
	<select id="selectCompleteGroupList" parameterType="cmap" resultType="cmap">
			SELECT 
         		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>CompleteList."Date" </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>CompleteList.InitiatorID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>CompleteList.InitiatorUnitID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>CompleteList.InitiatorUnitName </when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>CompleteList.FormPrefix </when>
					<when test='searchGroupType.equalsIgnoreCase("FormName")'>CompleteList.FormName </when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>CompleteList.SubKind </when>
         		</choose>
			AS "fieldID"
			, COUNT(1) AS "fieldCnt"
		<if test="searchGroupType == 'Date'">
	        , CompleteList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix' or searchGroupType == 'FormName'">
	        , CompleteList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	        , CompleteList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID' or searchGroupType == 'InitiatorUnitName'">
	        , CompleteList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	        , CompleteList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkitemID AS WorkitemArchiveID
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.EndDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(B.EndDate,'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE ((A.UserCode = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021','T023'))
					<if test="userID != null and userID != '' ">
						OR (A.DeputyID = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021'))
					</if>
				)
				AND B.ProcessState = 528				
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_01'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) CompleteList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	"Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND "Date" <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND "Date" <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="formSubject != null and formSubject !=''">
				AND FormSubject LIKE '%' || #{formSubject} || '%'
			</if>
			<if test="initiatorName != null and initiatorName !=''">
				AND InitiatorName LIKE '%' || #{initiatorName} || '%'
			</if>
			<if test="initiatorUnitName != null and initiatorUnitName !=''">
				AND InitiatorUnitName LIKE '%' || #{initiatorUnitName} || '%'
			</if>
			<if test="formName != null and formName !=''">
				AND FormName LIKE '%' || #{formName} || '%'
			</if>
			<if test="docNo != null and docNo !=''">
				AND DocNo LIKE '%' || #{docNo} || '%'
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
           		<choose>
           			<when test='searchGroupType.equalsIgnoreCase("Date")'>CompleteList."Date"</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>CompleteList.InitiatorID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>CompleteList.InitiatorUnitID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>CompleteList.InitiatorUnitName</when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>CompleteList.FormPrefix</when>
					<when test='searchGroupType.equalsIgnoreCase("FormName")'>CompleteList.FormName</when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>CompleteList.SubKind </when>
           		</choose>
		  	    <if test="searchGroupType != 'Date'">
			 		<if test="searchGroupType == 'FormPrefix'">
				        , CompleteList.FormName
				    </if>
				     <if test="searchGroupType == 'InitiatorID'">
				        , CompleteList.InitiatorName
				    </if>
				     <if test="searchGroupType == 'InitiatorUnitID'">
				        , CompleteList.InitiatorUnitName
				    </if>
		  	    </if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
		  	    "fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 완료함 엑셀 데이터 조회 -->
	<select id="selectCompleteListExcel" parameterType="cmap" resultType="cmap">
		SELECT
			SubKind AS "SubKind"
			, FormSubject AS "FormSubject"
			, InitiatorUnitName AS "InitiatorUnitName"
			, InitiatorName AS "InitiatorName"
			, IsFile AS "IsFile"
			, FormName AS "FormName"
			, NVL(DocNo, ' ') AS "DocNo"
			, TO_CHAR(EndDate, 'YYYY-MM-DD HH24:MI:SS')  AS "EndDate"
			, IsComment AS "IsComment"
			, IsModify AS "IsModify"
			, SubUserName AS "SubUserName"
		FROM (
			SELECT B.ProcessID AS ProcessArchiveID
				, A.PerformerID
				, A.WorkitemID AS WorkitemArchiveID
				, B.FormPrefix
				, B.InitiatorID
				, B.InitiatorName
				, B.InitiatorUnitID
				, B.InitiatorUnitName
				, A.UserCode
				, A.UserName
				, A.SubKind
				, A.SubKind AS FormSubKind
				, C.ProcessDescriptionID AS ProcessDescriptionArchiveID
				, C.FormInstID,C.FormID, C.FormPrefix, C.FormName,C.FormSubject,C.IsSecureDoc,C.IsFile,C.FileExt,C.IsComment
				, C.DocNo, C.ApproverCode,C.ApproverName,C.ApprovalStep
				, C.ApproverSIPAddress,C.IsReserved,C.ReservedGubun,C.ReservedTime,C.Priority,C.IsModify,C.Reserved1,C.Reserved2,C.BusinessData1,C.BusinessData2,C.BusinessData3,C.BusinessData4,C.BusinessData5
				, C.BusinessData6,C.BusinessData7,C.BusinessData8,C.BusinessData9,C.BusinessData10
				, B.EndDate AS EndDate
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					, D.BodyContextOrg
				</if>
				,Fn_SplitString_r(C.businessdata5, '^^^', 2) as SubUserName
			FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
			<if test="searchType != null and searchType == 'BodyContextOrg' ">
				INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
			</if>
			<if test="companyCode != null and companyCode != '' ">
				INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
			</if>
			WHERE ((A.UserCode = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021','T023'))
				<if test="userID != null and userID != '' ">
					OR (A.DeputyID = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021'))
				</if>
			)
			AND B.ProcessState = 528
			<if test="adminYn == null or adminYn == '' ">
				AND A.Deleted IS NULL
			</if>
			AND A.PIDeleted IS NULL
			AND A.PIBusinessState = '02_01'
			<if test="companyCode != null and companyCode != '' ">
				AND SOG.CompanyCode = #{companyCode}
				AND SOG.GroupType = 'Dept'
			</if>			
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (C.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR C.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND C.BusinessData1 = #{businessData1}
				</when>
			</choose>
		) CompleteList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%'			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="formSubject != null and formSubject !=''">
				AND FormSubject LIKE '%' || #{formSubject} || '%'
			</if>
			<if test="initiatorName != null and initiatorName !=''">
				AND InitiatorName LIKE '%' || #{initiatorName} || '%'
			</if>
			<if test="initiatorUnitName != null and initiatorUnitName !=''">
				AND InitiatorUnitName LIKE '%' || #{initiatorUnitName} || '%'
			</if>
			<if test="formName != null and formName !=''">
				AND FormName LIKE '%' || #{formName} || '%'
			</if>
			<if test="docNo != null and docNo !=''">
				AND DocNo LIKE '%' || #{docNo} || '%'
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("FormName")'>FormName</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =","> 
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("IsComment")'>IsComment</when>
					<when test='sortColumn.equalsIgnoreCase("IsModify")'>IsModify</when>
					<when test='sortColumn.equalsIgnoreCase("endDate")'>endDate</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData3")'>BusinessData3</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData4")'>BusinessData4</when>
					<when test='sortColumn.equalsIgnoreCase("SubUserName")'>BusinessData5</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>

	<!-- 수신공람함 목록 데이터 -->
	<select id="selectReceiveExhibitList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessArchiveID AS "ProcessArchiveID"
				, PerformerID AS "PerformerID"
				, WorkitemArchiveID AS "WorkitemArchiveID"
				, FormPrefix AS "FormPrefix"
				, InitiatorID AS "InitiatorID"
				, InitiatorName AS "InitiatorName"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, SubKind AS "SubKind"
				, SubKind AS "FormSubKind"
				, ProcessDescriptionArchiveID AS "ProcessDescriptionArchiveID"				
                , BusinessData1 AS "BusinessData1"
                , BusinessData2 AS "BusinessData2"
                , BusinessData3 AS "BusinessData3"
                , BusinessData4 AS "BusinessData4"
                , BusinessData5 AS "BusinessData5"
                , BusinessData6 AS "BusinessData6"
                , BusinessData7 AS "BusinessData7"
                , BusinessData8 AS "BusinessData8"
                , BusinessData9 AS "BusinessData9"
                , BusinessData10 AS "BusinessData10"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, DocNo AS "DocNo"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, EndDate AS "EndDate"
				, TaskID AS "TaskID"
				, ExtInfo AS "ExtInfo"
				, PhotoPath AS "PhotoPath"
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					, BodyContextOrg AS "BodyContextOrg"
				</if>
			FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkitemID AS WorkitemArchiveID
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind

					, C.ProcessDescriptionID AS ProcessDescriptionArchiveID
					, C.FormInstID,C.FormID, C.FormPrefix, C.FormName,C.FormSubject,C.IsSecureDoc,C.IsFile,C.FileExt,C.IsComment
					, C.DocNo, C.ApproverCode,C.ApproverName,C.ApprovalStep
					, C.ApproverSIPAddress,C.IsReserved,C.ReservedGubun,C.ReservedTime,C.Priority,C.IsModify,C.Reserved1,C.Reserved2,C.BusinessData1,C.BusinessData2,C.BusinessData3,C.BusinessData4,C.BusinessData5
					, C.BusinessData6,C.BusinessData7,C.BusinessData8,C.BusinessData9,C.BusinessData10
					
					, B.EndDate
					, A.TaskID
					, F.ExtInfo
					, U.PhotoPath
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				LEFT OUTER JOIN JWF_Forms F ON C.FormID = F.FormID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE A.UserCode = #{userID}
				AND B.ProcessState = 528
				AND A.SubKind = 'T022'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_01'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) CompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%'			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("IsComment")'>IsComment</when>
					<when test='sortColumn.equalsIgnoreCase("IsModify")'>IsModify</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 수신공람함 목록 개수 데이터 -->
	<select id="selectReceiveExhibitListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
			SELECT CompleteList.* FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkitemID AS WorkitemArchiveID
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind

					, C.ProcessDescriptionID AS ProcessDescriptionArchiveID
					, C.FormInstID,C.FormID, C.FormPrefix, C.FormName,C.FormSubject,C.IsSecureDoc,C.IsFile,C.FileExt,C.IsComment
					, C.DocNo, C.ApproverCode,C.ApproverName,C.ApprovalStep
					, C.ApproverSIPAddress,C.IsReserved,C.ReservedGubun,C.ReservedTime,C.Priority,C.IsModify,C.Reserved1,C.Reserved2,C.BusinessData1,C.BusinessData2,C.BusinessData3,C.BusinessData4,C.BusinessData5
					, C.BusinessData6,C.BusinessData7,C.BusinessData8,C.BusinessData9,C.BusinessData10
					
					, B.EndDate
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE A.UserCode = #{userID}
				AND B.ProcessState = 528
				AND A.SubKind = 'T022'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_01'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) CompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%'			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 수신공람함 그룹별 목록 조회 -->
	<select id="selectReceiveExhibitGroupList" parameterType="cmap" resultType="cmap">
			SELECT 
         		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>CompleteList."Date" </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>CompleteList.InitiatorID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>CompleteList.InitiatorUnitID </when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>CompleteList.FormPrefix </when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>CompleteList.SubKind </when>
         		</choose>
			AS "fieldID"
			, COUNT(1) AS "fieldCnt"
		<if test="searchGroupType == 'Date'">
	        , CompleteList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	        , CompleteList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	        , CompleteList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	        , CompleteList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	        , CompleteList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkitemID AS WorkitemArchiveID
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.EndDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(B.EndDate,'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE A.UserCode = #{userID}
				AND B.ProcessState = 528
				AND A.SubKind = 'T022'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_01'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) CompleteList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	 "Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
           		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>CompleteList."Date"</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>CompleteList.InitiatorID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>CompleteList.InitiatorUnitID</when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>CompleteList.FormPrefix</when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>CompleteList.SubKind </when>
           		</choose>
		  	    <if test="searchGroupType != 'Date'">
			 		<if test="searchGroupType == 'FormPrefix'">
				        , CompleteList.FormName
				    </if>
				     <if test="searchGroupType == 'InitiatorID'">
				        , CompleteList.InitiatorName
				    </if>
				     <if test="searchGroupType == 'InitiatorUnitID'">
				        , CompleteList.InitiatorUnitName
				    </if>
		  	    </if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
		  	    "fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 수신공람함 엑셀 데이터 조회 -->
	<select id="selectReceiveExhibitListExcel" parameterType="cmap" resultType="cmap">
		SELECT
			SubKind AS "SubKind"
			, FormSubject AS "FormSubject"
			, InitiatorUnitName AS "InitiatorUnitName"
			, InitiatorName AS "InitiatorName"
			, IsFile AS "IsFile"
			, FormName AS "FormName"
			, NVL(DocNo, ' ') AS "DocNo"
			, EndDate AS "EndDate"
			, IsComment AS "IsComment"
			, IsModify AS "IsModify"
		FROM (
			SELECT B.ProcessID AS ProcessArchiveID
				, A.PerformerID
				, A.WorkitemID AS WorkitemArchiveID
				, B.InitiatorID
				, B.InitiatorName
				, B.InitiatorUnitID
				, B.InitiatorUnitName
				, A.UserCode
				, A.UserName
				, A.SubKind
				, A.SubKind AS FormSubKind
				, C.ProcessDescriptionID AS ProcessDescriptionArchiveID
				, C.FormInstID,C.FormID, C.FormPrefix, C.FormName,C.FormSubject,C.IsSecureDoc,C.IsFile,C.FileExt,C.IsComment
				, C.DocNo, C.ApproverCode,C.ApproverName,C.ApprovalStep
				, C.ApproverSIPAddress,C.IsReserved,C.ReservedGubun,C.ReservedTime,C.Priority,C.IsModify,C.Reserved1,C.Reserved2,C.BusinessData1,C.BusinessData2,C.BusinessData3,C.BusinessData4,C.BusinessData5
				, C.BusinessData6,C.BusinessData7,C.BusinessData8,C.BusinessData9,C.BusinessData10				
				, TO_CHAR(B.EndDate, 'YYYY-MM-DD HH24:MI:SS') AS EndDate
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					, D.BodyContextOrg
				</if>
			FROM JWF_Workitem A
			INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
			INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
			<if test="searchType != null and searchType == 'BodyContextOrg' ">
				INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
			</if>
			<if test="companyCode != null and companyCode != '' ">
				INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
			</if>			
			WHERE A.UserCode = #{userID}
			AND B.ProcessState = 528
			AND A.SubKind = 'T022'
			<if test="adminYn == null or adminYn == '' ">
				AND A.Deleted IS NULL
			</if>
			AND A.PIDeleted IS NULL
			AND A.PIBusinessState = '02_01'
			<if test="companyCode != null and companyCode != '' ">
				AND SOG.CompanyCode = #{companyCode}
				AND SOG.GroupType = 'Dept'
			</if>			
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (C.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR C.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND C.BusinessData1 = #{businessData1}
				</when>
			</choose>
		) CompleteList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%'			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =","> 
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("IsComment")'>IsComment</when>
					<when test='sortColumn.equalsIgnoreCase("IsModify")'>IsModify</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>

	<!-- 반려함 목록 데이터 -->
	<select id="selectRejectList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessArchiveID AS "ProcessArchiveID"
				, PerformerID AS "PerformerID"
				, WorkitemArchiveID AS "WorkitemArchiveID"
				, FormPrefix AS "FormPrefix"
				, InitiatorID AS "InitiatorID"
				, InitiatorName AS "InitiatorName"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, SubKind AS "SubKind"
				, SubKind AS "FormSubKind"
				, ProcessDescriptionArchiveID AS "ProcessDescriptionArchiveID"				
                , BusinessData1 AS "BusinessData1"
                , BusinessData2 AS "BusinessData2"
                , BusinessData3 AS "BusinessData3"
                , BusinessData4 AS "BusinessData4"
                , BusinessData5 AS "BusinessData5"
                , BusinessData6 AS "BusinessData6"
                , BusinessData7 AS "BusinessData7"
                , BusinessData8 AS "BusinessData8"
                , BusinessData9 AS "BusinessData9"
                , BusinessData10 AS "BusinessData10"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, DocNo AS "DocNo"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, EndDate AS "EndDate"
				, TaskID AS "TaskID"
				, ExtInfo AS "ExtInfo"
				, PhotoPath AS "PhotoPath"
			FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkitemID AS WorkitemArchiveID
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind

					, C.ProcessDescriptionID AS ProcessDescriptionArchiveID
					, C.FormInstID,C.FormID, C.FormPrefix, C.FormName,C.FormSubject,C.IsSecureDoc,C.IsFile,C.FileExt,C.IsComment
					, C.DocNo, C.ApproverCode,C.ApproverName,C.ApprovalStep
					, C.ApproverSIPAddress,C.IsReserved,C.ReservedGubun,C.ReservedTime,C.Priority,C.IsModify,C.Reserved1,C.Reserved2,C.BusinessData1,C.BusinessData2,C.BusinessData3,C.BusinessData4,C.BusinessData5
					, C.BusinessData6,C.BusinessData7,C.BusinessData8,C.BusinessData9,C.BusinessData10
					
					, B.EndDate
					, A.TaskID
					, F.ExtInfo
					, U.PhotoPath
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				LEFT OUTER JOIN JWF_Forms F ON C.FormID = F.FormID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE ((A.UserCode = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021','T023'))
					<if test="userID != null and userID != '' ">
						OR (A.DeputyID = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021'))
					</if>
				)
				AND B.ProcessState = 528
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_02'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) RejectList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				 <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("IsComment")'>IsComment</when>
					<when test='sortColumn.equalsIgnoreCase("IsModify")'>IsModify</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData3")'>BusinessData3</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData4")'>BusinessData4</when>
					<when test='sortColumn.equalsIgnoreCase("SubUserName")'>BusinessData5</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 반려함 목록 개수 데이터 -->
	<select id="selectRejectListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
			SELECT RejectList.* FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkitemID AS WorkitemArchiveID
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					, B.EndDate
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE ((A.UserCode = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021','T023'))
					<if test="userID != null and userID != '' ">
						OR (A.DeputyID = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021'))
					</if>
				)
				AND	B.ProcessState = 528
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_02'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) RejectList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				 <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 반려함 그룹별 목록 조회 -->
	<select id="selectRejectGroupList" parameterType="cmap" resultType="cmap">
			SELECT 
         		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>RejectList."Date" </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>RejectList.InitiatorID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>RejectList.InitiatorUnitID </when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>RejectList.FormPrefix </when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>RejectList.SubKind </when>
         		</choose>
			AS "fieldID"
			, COUNT(1) AS "fieldCnt"
		<if test="searchGroupType == 'Date'">
	        , RejectList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	        , RejectList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	        , RejectList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	        , RejectList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	        , RejectList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkitemID AS WorkitemArchiveID
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.EndDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(B.EndDate,'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE ((A.UserCode = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021','T023'))
					<if test="userID != null and userID != '' ">
						OR (A.DeputyID = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021'))
					</if>
				)
				AND	B.ProcessState = 528
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_02'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) RejectList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		"Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
           		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>RejectList."Date"</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>RejectList.InitiatorID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>RejectList.InitiatorUnitID</when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>RejectList.FormPrefix</when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>RejectList.SubKind </when>
           		</choose>
			 	<if test="searchGroupType != 'Date'">
			 		<if test="searchGroupType == 'FormPrefix'">
				        , RejectList.FormName
				    </if>
				     <if test="searchGroupType == 'InitiatorID'">
				        , RejectList.InitiatorName
				    </if>
				     <if test="searchGroupType == 'InitiatorUnitID'">
				        , RejectList.InitiatorUnitName
				    </if>
			 	</if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 반려함 엑셀 데이터 조회 -->
	<select id="selectRejectListExcel" parameterType="cmap" resultType="cmap">
		SELECT
			SubKind AS "SubKind"
			, FormSubject AS "FormSubject"
			, InitiatorUnitName AS "InitiatorUnitName"
			, InitiatorName AS "InitiatorName"
			, IsFile AS "IsFile"
			, FormName AS "FormName"
			, NVL(DocNo, ' ') AS "DocNo"
			, TO_CHAR(EndDate, 'YYYY-MM-DD HH24:MI:SS') AS "EndDate"
			, IsComment AS "IsComment"
			, IsModify AS "IsModify"
			, SubUserName AS "SubUserName"
		FROM (
			SELECT B.ProcessID AS ProcessArchiveID
				, A.PerformerID
				, A.WorkitemID AS WorkitemArchiveID
				, B.InitiatorID
				, B.InitiatorName
				, B.InitiatorUnitID
				, B.InitiatorUnitName
				, A.UserCode
				, A.UserName
				, A.SubKind
				, A.SubKind AS FormSubKind
				, C.ProcessDescriptionID AS ProcessDescriptionArchiveID
				, C.FormInstID,C.FormID, C.FormPrefix, C.FormName,C.FormSubject,C.IsSecureDoc,C.IsFile,C.FileExt,C.IsComment
				, C.DocNo, C.ApproverCode,C.ApproverName,C.ApprovalStep
				, C.ApproverSIPAddress,C.IsReserved,C.ReservedGubun,C.ReservedTime,C.Priority,C.IsModify,C.Reserved1,C.Reserved2,C.BusinessData1,C.BusinessData2,C.BusinessData3,C.BusinessData4,C.BusinessData5
				, C.BusinessData6,C.BusinessData7,C.BusinessData8,C.BusinessData9,C.BusinessData10
				, B.EndDate AS EndDate
				,Fn_SplitString_r(C.businessdata5, '^^^', 2) as SubUserName
			FROM JWF_Workitem A
			INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
			INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
			<if test="companyCode != null and companyCode != '' ">
				INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
			</if>			
			WHERE ((A.UserCode = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021','T023'))
				<if test="userID != null and userID != '' ">
					OR (A.DeputyID = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021'))
				</if>
			)
			AND	B.ProcessState = 528
			<if test="adminYn == null or adminYn == '' ">
				AND A.Deleted IS NULL
			</if>
			AND A.PIDeleted IS NULL
			AND A.PIBusinessState = '02_02'
			<if test="companyCode != null and companyCode != '' ">
				AND SOG.CompanyCode = #{companyCode}
				AND SOG.GroupType = 'Dept'
			</if>			
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (C.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR C.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND C.BusinessData1 = #{businessData1}
				</when>
			</choose>
		) RejectList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("IsComment")'>IsComment</when>
					<when test='sortColumn.equalsIgnoreCase("IsModify")'>IsModify</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData3")'>BusinessData3</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData4")'>BusinessData4</when>
					<when test='sortColumn.equalsIgnoreCase("SubUserName")'>BusinessData5</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>

	<!-- 임시함 목록 데이터 -->
	<select id="selectTempSaveList" parameterType="cmap" resultType="cmap">
		<include refid="oracle.include.pagingHeader"/>
			SELECT
				FormTempInstBoxID AS "FormTempInstBoxID"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, SchemaID AS "SchemaID"
				, FormPrefix AS "FormPrefix"
				, FormInstTableName AS "FormInstTableName"
				, UserCode AS "UserCode"
				, TO_CHAR(CreatedDate, 'YYYY-MM-DD HH24:MI:SS') AS "CreatedDate"
				, Subject AS "Subject"
				, Kind AS "Kind"
				, SubKind AS "SubKind"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, PhotoPath AS "PhotoPath"
			FROM (
				SELECT
					 A .FormTempInstBoxID
					, A.FormInstID
					, A.FormID
					, A.SchemaID
					, A.FormPrefix
					, A.FormInstTableName
					, A.UserCode
					, A.CreatedDate AS CreatedDate
					, A.Subject
					, A.Kind
					, A.Kind AS SubKind
					, B.FormName
					, B.FormName AS FormSubject
					, U.PhotoPath
				FROM JWF_FormsTempInstBox A
				INNER JOIN JWF_Forms B ON B.FormID = A.FormID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.UserCode
				WHERE A.UserCode = #{userID}
				<if test="isMobile != null and isMobile !='' and isMobile =='Y'.toString()">
					AND B.ExtInfo LIKE '%"MobileFormYN":"' || #{isMobile} || '"%'
				</if>
			) TempSaveList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		CreatedDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
	    			<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND TempSaveList.Subject LIKE '%' || #{searchWord} || '%'  <!-- 제목 -->
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND TempSaveList.CreatedDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND TempSaveList.Subject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , CreatedDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("Subject")'>Subject</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("CreatedDate")'>CreatedDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 임시함 목록 개수 데이터 -->
	<select id="selectTempSaveListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
			SELECT TempSaveList.* FROM (
				SELECT
					  A .FormTempInstBoxID
					, A.FormInstID
					, A.FormID
					, A.SchemaID
					, A.FormPrefix
					, A.FormInstTableName
					, A.UserCode
					, A.CreatedDate AS CreatedDate
					, A.Subject
					, A.Kind
					, A.Kind AS SubKind
					, B.FormName
					, B.FormName AS FormSubject
				FROM JWF_FormsTempInstBox A
				INNER JOIN JWF_Forms B ON B.FormID = A.FormID
				WHERE A.UserCode = #{userID}
				<if test="isMobile != null and isMobile !='' and isMobile =='Y'.toString()">
					AND B.ExtInfo LIKE '%"MobileFormYN":"' || #{isMobile} || '"%'
				</if>
			) TempSaveList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		CreatedDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND TempSaveList.Subject LIKE '%' || #{searchWord} || '%'  <!-- 제목 -->
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND TempSaveList.CreatedDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND TempSaveList.Subject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 임시함 그룹별 목록 조회 -->
	<select id="selectTempSaveGroupList" parameterType="cmap" resultType="cmap">
			SELECT 
         		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>TempSaveList."Date" </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>TempSaveList.InitiatorID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>TempSaveList.InitiatorUnitID </when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>TempSaveList.FormPrefix </when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>TempSaveList.SubKind </when>
         		</choose>
			AS "fieldID"
			, COUNT(1) AS "fieldCnt"
		<if test="searchGroupType == 'Date'">
	        , TempSaveList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	        , TempSaveList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	        , TempSaveList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	        , TempSaveList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	        , TempSaveList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT
					  A .*
					, A.Kind AS SubKind
					  <choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, A.CreatedDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(A.CreatedDate,'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
					, B.FormName
				FROM JWF_FormsTempInstBox A
				INNER JOIN JWF_Forms B ON B.FormID = A.FormID
				WHERE A.UserCode = #{userID}
			) TempSaveList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    "Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND TempSaveList.Subject LIKE '%' || #{searchWord} || '%'  <!-- 제목 -->
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND TempSaveList.Subject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
           		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>TempSaveList."Date"</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>TempSaveList.InitiatorID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>TempSaveList.InitiatorUnitID</when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>TempSaveList.FormPrefix</when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>TempSaveList.SubKind </when>
           		</choose>
		  	    <if test="searchGroupType != 'Date'">
		  	    	<if test="searchGroupType == 'FormPrefix'">
				        , TempSaveList.FormName
				    </if>
		  	    </if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 참조/회람함 목록 데이터 -->
	<select id="selectTCInfoList" parameterType="cmap" resultType="cmap">
	   <include refid="oracle.include.pagingHeader"/>
			SELECT
				CirculationBoxID AS "CirculationBoxID"
				, ProcessID AS "ProcessID"
				, CirculationBoxDescriptionID AS "CirculationBoxDescriptionID"
				, FormInstID AS "FormInstID"
				, ReceiptID AS "ReceiptID"
				, ReceiptType AS "ReceiptType"
				, ReceiptName AS "ReceiptName"
				, ReceiptDate AS "ReceiptDate"
				, Kind AS "Kind"
				, State AS "State"
				, ReadDate AS "ReadDate"
				, SenderID AS "SenderID"
				, SenderName AS "SenderName"
				, Subject AS "Subject"
				, "Comment"
				, DataState AS "DataState"
				, RegID AS "RegID"
				, RegDate AS "RegDate"
				, ModID AS "ModID"
				, ModDate AS "ModDate"
				, FormSubKind AS "FormSubKind"
				, SubKind AS "SubKind"
				, InitiatorID AS "InitiatorID"
				, InitiatorName AS "InitiatorName"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, InitiatedDate AS "InitiatedDate"
				, FormID AS "FormID"
				, FormName AS "FormName"
				, FormPrefix AS "FormPrefix"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, ExtInfo AS "ExtInfo"
				, DocNo AS "DocNo"
				, PhotoPath AS "PhotoPath"
				, BodyContextOrg AS "BodyContextOrg"
				, BusinessData1 AS "BusinessData1"
				, BusinessData2 AS "BusinessData2"
				, BusinessData3 AS "BusinessData3"
				, BusinessData4 AS "BusinessData4"
				, BusinessData5 AS "BusinessData5"
				, BusinessData6 AS "BusinessData6"
				, BusinessData7 AS "BusinessData7"
				, BusinessData8 AS "BusinessData8"
				, BusinessData9 AS "BusinessData9"
				, BusinessData10 AS "BusinessData10"
			FROM (
					SELECT 	  A.CirculationBoxID
							, A.ProcessID
							, A.CirculationBoxDescriptionID
							, A.FormInstID
							, A.ReceiptID
							, A.ReceiptType
							, A.ReceiptName
							, A.ReceiptDate AS ReceiptDate
							, A.Kind
							, A.State
							, A.ReadDate AS ReadDate
							, A.SenderID
							, A.SenderName
							, A.Subject
							, A.Comment_ AS "Comment"
							, A.DataState
							, A.RegID
							, A.RegDate AS RegDate
							, A.ModID
							, A.ModDate AS ModDate
							, A.kind AS FormSubKind
							, A.kind AS SubKind
							, B.InitiatorID
							, P.InitiatorName
							, B.InitiatorUnitID
							, P.InitiatorUnitName
							, B.InitiatedDate AS InitiatedDate
							, B.DocNo
							, B.BodyContextOrg
							, C.FormID
							, F.FormName
							, C.FormPrefix
							, C.FormSubject
							, C.IsSecureDoc
							, C.IsFile
							, C.FileExt
							, C.IsComment
							, C.ApproverCode
							, C.ApproverName
							, C.ApprovalStep
							, C.ApproverSIPAddress
							, C.IsReserved
							, C.ReservedGubun
							, C.ReservedTime
							, C.Priority
							, C.IsModify
							, C.Reserved1
							, C.Reserved2
							, F.ExtInfo
							, U.PhotoPath
							, D.BusinessData1
							, D.BusinessData2
							, D.BusinessData3
							, D.BusinessData4
							, D.BusinessData5
							, D.BusinessData6
							, D.BusinessData7
							, D.BusinessData8
							, D.BusinessData9
							, D.BusinessData10
					FROM JWF_CirculationBox A
					INNER JOIN JWF_FormInstance B ON A.FormInstID = B.FormInstID
					INNER JOIN JWF_CirculationBoxDescription C ON A.CirculationBoxDescriptionID = C.CirculationBoxDescriptionID
					LEFT OUTER JOIN JWF_Forms F ON C.FormID = F.FormID
					LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
					INNER JOIN jwf_processdescription D ON B.FormInstID = D.FormInstID
					INNER JOIN jwf_process P ON D.ProcessDescriptionID = P.ProcessDescriptionID AND P.ParentProcessID = 0
					WHERE A.State = 'C'
					<if test="adminYn == null or adminYn == '' ">
						AND B.DeletedDate IS NULL
					</if>
					AND A.ReceiptType = 'P'
					AND A.ReceiptID = #{userID}					
					<if test='requestType != null and requestType.equalsIgnoreCase("DocList")'>AND P.BusinessState like '02_01%'</if>
					AND A.DataState != 'D'
					<if test="companyCode != null and companyCode != '' ">
						AND B.EntCode = #{companyCode}
					</if>				
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (D.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR D.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND D.BusinessData1 = #{businessData1}
						</when>
					</choose>
			) TCInfoList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		RegDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND RegDate <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND RegDate <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND RegDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("FormName")'>FormName</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		     <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , RegDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatedDate")'>InitiatedDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData3")'>BusinessData3</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData4")'>BusinessData4</when>
					<when test='sortColumn.equalsIgnoreCase("SubUserName")'>BusinessData5</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 참조/회람함 목록 개수 데이터 -->
	<select id="selectTCInfoListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
			SELECT TCInfoList.* FROM (
				SELECT A.*
						, A.kind AS FormSubKind
						, A.kind AS SubKind
						, B.InitiatorID
						, B.InitiatorName
						, B.InitiatorUnitID
						, B.InitiatorUnitName
						, B.InitiatedDate
						, B.DocNo
						, B.BodyContextOrg
						, C.FormID
						, C.FormName
						, C.FormPrefix
						, C.FormSubject
						, C.IsSecureDoc
						, C.IsFile
						, C.FileExt
						, C.IsComment
						, C.ApproverCode
						, C.ApproverName
						, C.ApprovalStep
						, C.ApproverSIPAddress
						, C.IsReserved
						, C.ReservedGubun
						, C.ReservedTime
						, C.Priority
						, C.IsModify
						, C.Reserved1
						, C.Reserved2
				FROM JWF_CirculationBox	A
				INNER JOIN JWF_FormInstance	B ON A.FormInstID = B.FormInstID
				INNER JOIN JWF_CirculationBoxDescription C ON A.CirculationBoxDescriptionID = C.CirculationBoxDescriptionID
				INNER JOIN jwf_processdescription D ON B.FormInstID = D.FormInstID
				INNER JOIN jwf_process P ON D.ProcessDescriptionID = P.ProcessDescriptionID AND P.ParentProcessID = 0
				WHERE A.State = 'C'
				<if test="adminYn == null or adminYn == '' ">
					AND B.DeletedDate IS NULL
				</if>
				AND A.ReceiptType = 'P'
					<if test='requestType != null and requestType.equalsIgnoreCase("DocList")'>AND P.BusinessState like '02_01%'</if>
				AND A.ReceiptID = #{userID}
				AND A.DataState != 'D'
				<if test="companyCode != null and companyCode != '' ">
					AND B.EntCode = #{companyCode}
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) TCInfoList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		RegDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND RegDate <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND RegDate <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND RegDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("FormName")'>FormName</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 참조/회람함 그룹별 목록 조회 -->
	<select id="selectTCInfoGroupList" parameterType="cmap" resultType="cmap">
			SELECT 
         		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>TCInfoList."Date" </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>TCInfoList.InitiatorID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>TCInfoList.InitiatorUnitID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>TCInfoList.InitiatorUnitName </when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>TCInfoList.FormPrefix </when>
					<when test='searchGroupType.equalsIgnoreCase("FormName")'>TCInfoList.FormName </when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>TCInfoList.SubKind </when>
         		</choose>
			AS "fieldID"
			, COUNT(1) AS "fieldCnt"
		<if test="searchGroupType == 'Date'">
	        , TCInfoList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix' or searchGroupType == 'FormName'">
	        , TCInfoList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	        , TCInfoList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID' or searchGroupType == 'InitiatorUnitName'">
	        , TCInfoList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	        , TCInfoList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT 	  A.*
						, A.kind AS SubKind
						, B.InitiatorID
						, P.InitiatorName
						, B.InitiatorUnitID
						, P.InitiatorUnitName
						, B.FormID
						, C.FormPrefix
						, B.BodyContextOrg
						<choose>
							<when test="searchGroupType == 'Date'">
								, TO_CHAR(A.RegDate,'YYYY-MM-DD') AS "Date"
							</when>
							<otherwise>
								, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, A.RegDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
							</otherwise>
						</choose>
						, C.FormID AS BoxFormID
						, F.FormName
						, C.FormSubject
						, C.IsSecureDoc
						, C.IsFile
						, C.FileExt
						, C.IsComment
						, C.ApproverCode
						, C.ApproverName
						, C.ApprovalStep
						, C.ApproverSIPAddress
						, C.IsReserved
						, C.ReservedGubun
						, C.ReservedTime
						, C.Priority
						, C.IsModify
						, C.Reserved1
						, C.Reserved2
						, F.ExtInfo
				FROM JWF_CirculationBox A
				INNER JOIN JWF_FormInstance B ON A.FormInstID = B.FormInstID
				INNER JOIN JWF_CirculationBoxDescription C ON A.CirculationBoxDescriptionID = C.CirculationBoxDescriptionID
				LEFT OUTER JOIN JWF_Forms F ON C.FormID = F.FormID
				INNER JOIN jwf_processdescription D ON B.FormInstID = D.FormInstID
				INNER JOIN jwf_process P ON D.ProcessDescriptionID = P.ProcessDescriptionID AND P.ParentProcessID = 0
				WHERE A.State = 'C'
				AND B.DeletedDate IS NULL
				AND A.ReceiptType = 'P'
				AND A.ReceiptID = #{userID}
				AND A.DataState != 'D'
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) TCInfoList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		"Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND "Date" <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND "Date" <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
           		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>TCInfoList."Date"</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>TCInfoList.InitiatorID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>TCInfoList.InitiatorUnitID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>TCInfoList.InitiatorUnitName</when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>TCInfoList.FormPrefix</when>
					<when test='searchGroupType.equalsIgnoreCase("FormName")'>TCInfoList.FormName</when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>TCInfoList.SubKind </when>
           		</choose>
			 	<if test="searchGroupType != 'Date'">
			 		<if test="searchGroupType == 'FormPrefix'">
				        , TCInfoList.FormName
				    </if>
				     <if test="searchGroupType == 'InitiatorID'">
				        , TCInfoList.InitiatorName
				    </if>
				     <if test="searchGroupType == 'InitiatorUnitID'">
				        , TCInfoList.InitiatorUnitName
				    </if>
			 	</if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 참조함 엑셀 데이터 조회 -->
	<select id="selectTCInfoListExcel" parameterType="cmap" resultType="cmap">
		SELECT
			SubKind AS "SubKind"
			, FormName AS "FormName"
			, FormSubject AS "FormSubject"
			, InitiatorUnitName AS "InitiatorUnitName"
			, InitiatorName AS "InitiatorName"
			, TO_CHAR(RegDate, 'YYYY-MM-DD HH24:MI:SS') AS "RegDate"
			, BusinessData3 AS "BusinessData3"
			, BusinessData4 AS "BusinessData4"
			, BusinessData5 AS "BusinessData5"
			, SubUserName AS "SubUserName"
		FROM (
			SELECT A.CirculationBoxID
						, A.ProcessID
						, A.CirculationBoxDescriptionID
						, A.FormInstID
						, A.ReceiptID
						, A.ReceiptType
						, A.ReceiptName
						, A.ReceiptDate AS ReceiptDate
						, A.Kind
						, A.State
						, A.ReadDate AS ReadDate
						, A.SenderID
						, A.SenderName
						, A.Subject
						, A.Comment_ AS "Comment"
						, A.DataState
						, A.RegID
						, A.RegDate AS RegDate
						, A.ModID
						, A.ModDate AS ModDate
						, A.kind AS FormSubKind
						, A.kind AS SubKind
						, B.InitiatorID
						, P.InitiatorName
						, B.InitiatorUnitID
						, P.InitiatorUnitName
						, B.InitiatedDate AS InitiatedDate
						, B.BodyContextOrg
						, C.FormID
						, F.FormName
						, C.FormPrefix
						, C.FormSubject
						, C.IsSecureDoc
						, C.IsFile
						, C.FileExt
						, C.IsComment
						, C.ApproverCode
						, C.ApproverName
						, C.ApprovalStep
						, C.ApproverSIPAddress
						, C.IsReserved
						, C.ReservedGubun
						, C.ReservedTime
						, C.Priority
						, C.IsModify
						, C.Reserved1
						, F.ExtInfo
						,D.BusinessData3
						,D.BusinessData4
						,D.BusinessData5
						,Fn_SplitString_r(D.businessdata5, '^^^', 2) as SubUserName
					FROM JWF_CirculationBox A
					INNER JOIN JWF_FormInstance B ON A.FormInstID = B.FormInstID
					INNER JOIN JWF_CirculationBoxDescription C ON A.CirculationBoxDescriptionID = C.CirculationBoxDescriptionID
					LEFT OUTER JOIN JWF_Forms F ON C.FormID = F.FormID
					INNER JOIN jwf_processdescription D ON B.FormInstID = D.FormInstID
					INNER JOIN jwf_process P ON D.ProcessDescriptionID = P.ProcessDescriptionID AND P.ParentProcessID = 0
			WHERE A.State = 'C'
			AND B.DeletedDate IS NULL
			AND A.ReceiptType = 'P'
			AND A.ReceiptID = #{userID}
			AND A.DataState != 'D'
			<if test="companyCode != null and companyCode != '' ">
				AND B.EntCode = #{companyCode}
			</if>			
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (D.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR D.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND D.BusinessData1 = #{businessData1}
				</when>
			</choose>
		) TCInfoList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		RegDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND RegDate <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND RegDate <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND RegDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("FormName")'>FormName</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , RegDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatedDate")'>InitiatedDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData3")'>BusinessData3</when>
					<when test='sortColumn.equalsIgnoreCase("BusinessData4")'>BusinessData4</when>
					<when test='sortColumn.equalsIgnoreCase("SubUserName")'>BusinessData5</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>

	<!-- 임시함 JWF_FormsTempInstBox 삭제 -->
	<delete id="deleteFormsTempInstBox" parameterType="cmap">
		DELETE FROM JWF_FormsTempInstBox
		WHERE
			UserCode = #{userID}
		AND FormInstID IN
		<foreach collection="FormInstId" item="item" index="index" separator="," open="(" close=")">
		    #{item}
		</foreach>
	</delete>

	<!-- 임시함 JWF_FormInstance 삭제 -->
	<delete id="deleteFormInstance" parameterType="cmap">
		DELETE FROM JWF_FormInstance
		WHERE
			InitiatorID = #{userID}
		AND FormInstID IN
	    <foreach collection="FormInstId" item="item" index="index" separator="," open="(" close=")">
		    #{item}
		</foreach>
	</delete>

	<!-- 임시함 JWF_PrivateDomainData 삭제 -->
	<delete id="deletePrivateDomainData" parameterType="cmap">
		DELETE FROM JWF_PrivateDomainData
		WHERE OWNERID IN
		<foreach collection="FormInstBoxId" item="item" index="index" separator="," open="(" close=")">
		    #{item}
		</foreach>
	</delete>

	<!-- 반려함 JWF_WorkitemArchive 업데이트 -->
	<update id="updateWorkitemArchive" parameterType="cmap">
		UPDATE
			JWF_Workitem
		SET Deleted	= SYSDATE
		WHERE WorkitemID IN
		<foreach collection="WorkItemId" item="item" index="index" separator="," open="(" close=")">
		    #{item}
		</foreach>
	</update>

	<select id="selectAdminMnLIstData" parameterType="cmap" resultType="cmap">
	    <![CDATA[
	    	SELECT
				MenuID AS "MenuID"
				, DisplayName AS "DisplayName"
				, Reserved2 AS "TypeCode"
			FROM sys_object_menu
			WHERE IsUse = 'Y'
			AND IsDisplay = 'Y'
			AND MenuType = 'LeftSub'
			AND Reserved1 = #{MemberOf}
			AND DomainID = (
		        CASE WHEN EXISTS (
		        SELECT 'X' FROM sys_object_menu 
		        		WHERE IsUse = 'Y'
						AND IsDisplay = 'Y'
						AND MenuType = 'LeftSub'
						AND Reserved1 = #{MemberOf}
						AND DomainID = #{DomainID})
		        THEN #{DomainID}
		        ELSE '0'
		        END
	        )
	        ORDER BY SORTKEY
		]]>
	</select>

	<select id="selectApprovalNotDocReadCnt" resultType="java.lang.Long">
		SELECT COUNT(ApprovalList.FormInstID) FROM (
			SELECT A.ProcessID
			, B.WorkItemID
			, C.PerformerID
			, A.InitiatorID
			, A.InitiatorName
			, A.InitiatorUnitID
			, A.InitiatorUnitName
			, C.UserCode
			, C.UserName
			, C.SubKind
			, C.SubKind AS FormSubKind
			, D.*
			, B.Created
			FROM JWF_Process A
			INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
			INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
			INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
			WHERE C.UserCode = #{userID}
			AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019')
			AND C.State = 1
			AND B.State = 288
			AND A.ProcessState = 288
			<if test="adminYn == null or adminYn == '' ">
				AND A.DeleteDate IS NULL
			</if>
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (D.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR D.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND D.BusinessData1 = #{businessData1}
				</when>
			</choose>

			<if test="userID != null and userID != '' ">
				UNION ALL
	
				SELECT A.ProcessID
				, B.WorkItemID
				, C.PerformerID
				, A.InitiatorID
				, A.InitiatorName
				, A.InitiatorUnitID
				, A.InitiatorUnitName
				, C.UserCode
				, C.UserName
				, C.SubKind
				, C.SubKind AS FormSubKind
				, D.*
				, B.Created
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				WHERE B.DeputyID = #{userID}
				AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017')
				AND C.State = 1
				AND B.State = 288
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			</if>
		) ApprovalList
		WHERE NOT EXISTS (
			SELECT
					DISTINCT R.FormInstID
			FROM
					jwf_docreadhistory R
					INNER JOIN jwf_forminstance FI ON R.FormInstID = FI.FormInstID
			WHERE AdminYN = 'N'
			AND UserID = #{userID}
			AND ApprovalList.FormInstID = R.FormInstID
		)
	</select>

	<select id="selectProcessNotDocReadCnt" resultType="java.lang.Long">
    	SELECT COUNT(ProcessList.FormInstID) FROM (
			SELECT A.ProcessID
			, B.WorkItemID
			, C.PerformerID
			, A.InitiatorID
			, A.InitiatorName
			, A.InitiatorUnitID
			, A.InitiatorUnitName
			, C.UserCode
			, C.UserName
			, C.SubKind
			, C.SubKind AS FormSubKind
			, D.*
			, B.Created AS Created
			, B.Finished AS Finished
			FROM JWF_Process A
			INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
			INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
			INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
			WHERE C.UserCode = #{userID}
			AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T020')
			AND C.State = 1
			AND B.State = 528
			AND A.ProcessState = 288
			<if test="adminYn == null or adminYn == '' ">
				AND A.DeleteDate IS NULL
			</if>
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (D.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR D.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND D.BusinessData1 = #{businessData1}
				</when>
			</choose>

			<if test="userID != null and userID != '' ">
				UNION ALL
	
				SELECT A.ProcessID
				, B.WorkItemID
				, C.PerformerID
				, A.InitiatorID
				, A.InitiatorName
				, A.InitiatorUnitID
				, A.InitiatorUnitName
				, C.UserCode
				, C.UserName
				, C.SubKind
				, C.SubKind AS FormSubKind
				, D.*
				, B.Created AS Created
				, B.Finished AS Finished
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				WHERE B.DeputyID = #{userID}
				AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016')
				AND C.State = 1
				AND B.State = 528
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			</if>
		) ProcessList
		WHERE NOT EXISTS (
			SELECT
					DISTINCT R.FormInstID
			FROM
					jwf_docreadhistory R
					INNER JOIN jwf_forminstance FI ON R.FormInstID = FI.FormInstID
			WHERE AdminYN = 'N'
			AND UserID = #{userID}
			AND ProcessList.FormInstID = R.FormInstID
		)
	</select>

	<select id="selectTCInfoNotDocReadCnt" resultType="java.lang.Long">
		SELECT count(*)
		FROM (
			SELECT A.CirculationBoxID
			FROM JWF_CirculationBox A
			INNER JOIN JWF_FormInstance B ON A.FormInstID = B.FormInstID
			INNER JOIN JWF_CirculationBoxDescription C ON A.CirculationBoxDescriptionID = C.CirculationBoxDescriptionID
			INNER JOIN jwf_processdescription D ON B.FormInstID = D.FormInstID
			INNER JOIN jwf_process P ON D.ProcessDescriptionID = P.ProcessDescriptionID AND P.ParentProcessID = 0
			WHERE A.State = 'C'
			<if test="adminYn == null or adminYn == '' ">
				AND B.DeletedDate IS NULL
			</if>
			AND A.ReceiptType = 'P'
			AND A.ReceiptID = #{userID}
			AND A.DataState != 'D'
			AND (A.ReadDate IS NULL)
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (D.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR D.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND D.BusinessData1 = #{businessData1}
				</when>
			</choose>
		) AA
	</select>
	
	<select id="selectApprovalTCInfoSingleDocRead" resultType="java.lang.Long">
		SELECT COUNT(A.FormInstID)
		FROM (
			SELECT A.CirculationBoxID
			FROM JWF_CirculationBox A
			INNER JOIN JWF_FormInstance B ON A.FormInstID = B.FormInstID
			INNER JOIN JWF_CirculationBoxDescription C ON A.CirculationBoxDescriptionID = C.CirculationBoxDescriptionID
			INNER JOIN jwf_processdescription D ON B.FormInstID = D.FormInstID
			INNER JOIN jwf_process P ON D.ProcessDescriptionID = P.ProcessDescriptionID AND P.ParentProcessID = 0 AND P.ProcessState = '288'
			WHERE A.State = 'C'
			AND A.ReceiptType = 'P'
			AND A.DataState != 'D'
			AND A.ReceiptID = #{userID}
			AND A.ProcessID = #{ProcessID}
			AND A.FormInstID = #{FormInstID}
			AND A.ReadDate IS NOT NULL
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (D.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR D.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND D.BusinessData1 = #{businessData1}
				</when>
			</choose>
		) AA
	</select>

	<!-- 개인결재함- 특정사용자 부서조회-->
	<select id="selectPersonOneCount" parameterType="cmap" resultType="int">
		<![CDATA[
	    SELECT COUNT(*)
		FROM jwf_persondirector A 
		LEFT OUTER JOIN jwf_persondirectormember B ON A.UserCode = B.UserCode AND A.EntCode = B.EntCode
		WHERE A.UserCode = #{UserCode}
		AND A.EntCode IN ('ORGROOT', #{EntCode})
		AND ((A.AuthEndDate IS NULL) OR (TO_CHAR(A.AuthStartDate,'YYYYMMDD')  <= TO_CHAR(sysdate,'YYYYMMDD') AND TO_CHAR(A.AuthEndDate,'YYYYMMDD')  >= TO_CHAR(sysdate,'YYYYMMDD')))
		]]>
	</select>
	
	<select id="selectPersonOne" parameterType="cmap" resultType="cmap">
		<![CDATA[
		SELECT
			UserName AS "UserName"
			, UserCode AS "UserCode"
			, ViewStartDate AS "ViewStartDate"
			, ViewEndDate AS "ViewEndDate"
		FROM (
			SELECT
				'사용자명'  AS UserName
				,'all'        AS UserCode
				,NULL AS ViewStartDate
				,NULL AS ViewEndDate
			FROM DUAL
			
			UNION ALL
			
			SELECT B.TargetName AS UserName
					,B.TargetCode AS UserCode
					,to_char(B.ViewStartDate,'YYYY-MM-DD'),to_char( B.ViewEndDate,'YYYY-MM-DD')
			FROM jwf_persondirector A 
			LEFT OUTER JOIN jwf_persondirectormember B ON A.UserCode = B.UserCode AND A.EntCode = B.EntCode
			WHERE A.UserCode = #{UserCode}
			AND A.EntCode IN ('ORGROOT', #{EntCode})
			AND ((A.AuthEndDate IS NULL) OR (TO_CHAR(A.AuthStartDate,'YYYYMMDD')  <= TO_CHAR(sysdate,'YYYYMMDD') AND TO_CHAR(A.AuthEndDate,'YYYYMMDD')  >= TO_CHAR(sysdate,'YYYYMMDD')))
		) A
		]]>
	</select>
	
	<select id="selectProfileImagePath" parameterType="cmap" resultType="cmap">
	    SELECT U.UserCode AS "UserCode", P.PhotoPath AS "PhotoPath"
	    FROM
		<foreach collection="UserCodes" item="UserCode" open="(" close=")" separator=" UNION ">
		    SELECT #{UserCode} AS UserCode FROM DUAL
		</foreach>
		 U
		LEFT JOIN sys_object_user P ON U.UserCode = P.UserCode
	</select>
	
	<!-- 지연 알림 미결함 리스트 -->
	<select id="selectDelayApprovalUsers" parameterType="cmap" resultType="cmap">
	    SELECT UserCode AS "UserCode" FROM (
			SELECT C.UserCode
			, B.Created AS Created
			FROM JWF_Process A
			INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
			INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
			INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
			LEFT OUTER JOIN JWF_DocReadHistory R ON A.ProcessID = R.ProcessID AND C.UserCode = R.UserID AND R.AdminYN = 'N' AND R.FormInstID > 0
			LEFT OUTER JOIN JWF_Forms F ON D.FormID = F.FormID
			WHERE C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T023')
			AND C.State = 1
			AND B.State = 288
			AND A.ProcessState = 288
			AND A.DeleteDate IS NULL
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (D.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR D.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND D.BusinessData1 = #{businessData1}
				</when>
			</choose>
	 		<if test="DelayFormPrefix != '' and DelayFormPrefix != null">
	 			AND F.FormPrefix IN
	 			<foreach collection="DelayFormPrefix" item="item" index="index" separator="," open="(" close=")">
					#{item}
				</foreach>
	 		</if>

			UNION ALL

			SELECT B.DeputyID AS UserCode
			, B.Created AS Created
			FROM JWF_Process A
			INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
			INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
			INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
			LEFT OUTER JOIN JWF_DocReadHistory R ON A.ProcessID = R.ProcessID AND C.UserCode = R.UserID AND R.FormInstID > 0
			LEFT OUTER JOIN JWF_Forms F ON D.FormID = F.FormID
			WHERE C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017')
			AND C.State = 1
			AND B.State = 288
			AND A.ProcessState = 288
			AND A.DeleteDate IS NULL
			AND B.DeputyID != ''
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (D.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR D.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND D.BusinessData1 = #{businessData1}
				</when>
			</choose>
	 		<if test="DelayFormPrefix != '' and DelayFormPrefix != null">
	 			AND F.FormPrefix IN
	 			<foreach collection="DelayFormPrefix" item="item" index="index" separator="," open="(" close=")">
					#{item}
				</foreach>
	 		</if>
		) ApprovalList
		WHERE (TO_DATE(SYSDATE, 'YYYY-MM-DD') - TO_DATE(Created, 'YYYY-MM-DD')) >= #{DelayPeriodDay}
		GROUP BY UserCode
	</select>
	
	<!-- 지연 알림 미결함 리스트 -->
	<select id="selectDelayApprovalList" parameterType="cmap" resultType="cmap">
	    SELECT
	    	ProcessID AS "ProcessID"
	    	, WorkItemID AS "WorkItemID"
	    	, PerformerID AS "PerformerID"
	    	, InitiatorID AS "InitiatorID"
	    	, InitiatorName AS "InitiatorName"
	    	, InitiatorUnitID AS "InitiatorUnitID"
	    	, InitiatorUnitName AS "InitiatorUnitName"
	    	, UserCode AS "UserCode"
	    	, UserName AS "UserName"
	    	, SubKind AS "SubKind"
	    	, SubKind AS "FormSubKind"
	    	, ProcessDescriptionID AS "ProcessDescriptionID"
			, FormInstID AS "FormInstID"
			, FormID AS "FormID"
			, FormPrefix AS "FormPrefix"
			, FormName AS "FormName"
			, FormSubject AS "FormSubject"
			, IsSecureDoc AS "IsSecureDoc"
			, IsFile AS "IsFile"
			, FileExt AS "FileExt"
			, IsComment AS "IsComment"
			, ApproverCode AS "ApproverCode"
			, ApproverName AS "ApproverName"
			, ApprovalStep AS "ApprovalStep"
			, ApproverSIPAddress AS "ApproverSIPAddress"
			, IsReserved AS "IsReserved"
			, ReservedGubun AS "ReservedGubun"
			, ReservedTime AS "ReservedTime"
			, Priority AS "Priority"
			, IsModify AS "IsModify"
			, Reserved1 AS "Reserved1"
			, Reserved2 AS "Reserved2"
	    	, Created AS "Created"
	    	, TaskID AS "TaskID"
	    	, ReadDate AS "ReadDate"
	    	, ExtInfo AS "ExtInfo"
	    FROM (
				SELECT A.ProcessID
				, B.WorkItemID
				, C.PerformerID
				, A.InitiatorID
				, A.InitiatorName
				, A.InitiatorUnitID
				, A.InitiatorUnitName
				, C.UserCode
				, C.UserName
				, C.SubKind
				, C.SubKind AS FormSubKind
				, D.*
				, B.Created AS Created
				, B.TaskID
				, R.ReadDate AS ReadDate
				, F.ExtInfo
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				LEFT OUTER JOIN JWF_DocReadHistory R ON A.ProcessID = R.ProcessID AND C.UserCode = R.UserID AND R.AdminYN = 'N' AND R.FormInstID > 0
				LEFT OUTER JOIN JWF_Forms F ON D.FormID = F.FormID
				WHERE C.UserCode = #{UserCode}
				AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T023')
				AND C.State = 1
				AND B.State = 288
				AND A.ProcessState = 288
				AND A.DeleteDate IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
		 		<if test="DelayFormPrefix != '' and DelayFormPrefix != null">
		 			AND F.FormPrefix IN
		 			<foreach collection="DelayFormPrefix" item="item" index="index" separator="," open="(" close=")">
						#{item}
					</foreach>
		 		</if>

				<if test="UserCode != null and UserCode != '' ">
					UNION ALL
	
					SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, A.InitiatorID
					, A.InitiatorName
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, C.UserCode
					, C.UserName
					, C.SubKind
					, C.SubKind AS FormSubKind
					, D.*
					, B.Created AS Created
					, B.TaskID
					, R.ReadDate AS ReadDate
					, F.ExtInfo
					FROM JWF_Process A
					INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
					INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
					INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
					LEFT OUTER JOIN JWF_DocReadHistory R ON A.ProcessID = R.ProcessID AND C.UserCode = R.UserID AND R.FormInstID > 0
					LEFT OUTER JOIN JWF_Forms F ON D.FormID = F.FormID
					WHERE B.DeputyID = #{UserCode}
					AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017')
					AND C.State = 1
					AND B.State = 288
					AND A.ProcessState = 288
					AND A.DeleteDate IS NULL
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (D.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR D.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND D.BusinessData1 = #{businessData1}
						</when>
					</choose>
			 		<if test="DelayFormPrefix != '' and DelayFormPrefix != null">
			 			AND F.FormPrefix IN
			 			<foreach collection="DelayFormPrefix" item="item" index="index" separator="," open="(" close=")">
							#{item}
						</foreach>
			 		</if>
			 	</if>
			) ApprovalList
		WHERE (TO_DATE(SYSDATE, 'YYYY-MM-DD') - TO_DATE(Created, 'YYYY-MM-DD')) >= #{DelayPeriodDay}
		ORDER BY Priority DESC, Created ASC
		<!-- LIMIT #{DelayListCount} -->
	</select>
	
	<!-- 홈화면 미결함 쿼리 -->
	<select id="selectHomeApprovalList" parameterType="cmap" resultType="cmap">
	    SELECT T.*
		  FROM (SELECT ROWNUM AS RNUM, A.*
	            FROM   (
				    SELECT ProcessID AS "ProcessID"
						, WorkItemID AS "WorkItemID"
						, PerformerID AS "PerformerID"
						, FormInstID AS "FormInstID"
						, ProcessDescriptionID AS "ProcessDescriptionID"
						, FormSubject AS "FormSubject"
						, FormPrefix AS "FormPrefix"
						, FormID AS "FormID"
						, InitiatorID AS "InitiatorID"
						, InitiatorName AS "InitiatorName"
						, UserCode AS "UserCode"
						, UserName AS "UserName"
						, FormSubKind AS "FormSubKind"
						, Created AS "Created"
						, TaskID AS "TaskID"
						, PhotoPath AS "PhotoPath"
						, DomainDataContext AS "DomainDataContext"
						, SchemaContext AS "SchemaContext"
						, BusinessData1 AS "BusinessData1"
						, BusinessData2 AS "BusinessData2"
						, ProcessName AS "ProcessName"
					FROM (
						SELECT A.ProcessID
						, B.WorkItemID
						, C.PerformerID
						, A.FormInstID
						, A.ProcessDescriptionID
						, A.DocSubject AS FormSubject
						, D.FormPrefix
						, F.FormID
						, A.InitiatorID
						, A.InitiatorName
						, C.UserCode
						, C.UserName
						, C.SubKind AS FormSubKind
						, B.Created
						, B.TaskID
						, U.PhotoPath
						, E.DomainDataContext
						, S.SchemaContext
						, D.BusinessData1
						, D.BusinessData2
						, A.ProcessName
						FROM JWF_Process A
						INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
						INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
						INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
						LEFT OUTER JOIN jwf_domaindata E ON A.ProcessID = E.ProcessID
						LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.InitiatorID
						LEFT OUTER JOIN jwf_forms F ON D.FormID = F.FormID
						LEFT OUTER JOIN jwf_formsschema S ON F.SchemaID = S.SchemaID
						WHERE C.UserCode = #{userID}
						AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T023')
						AND C.State = 1
						AND B.State = 288
						AND A.ProcessState = 288
						AND A.DeleteDate IS NULL
						<choose>
							<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
								AND (D.BusinessData1 IS NULL
									<if test='bizDataList != null'>
										OR D.BusinessData1 IN 
										<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
											#{item}
										</foreach>
									</if>
								)
							</when>
							<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
								AND D.BusinessData1 = #{businessData1}
							</when>
						</choose>
			
						<if test="userID != null and userID != '' ">
							UNION ALL
				
							SELECT A.ProcessID
							, B.WorkItemID
							, C.PerformerID
							, A.FormInstID
							, A.ProcessDescriptionID
							, A.DocSubject AS FormSubject
							, D.FormPrefix
							, F.FormID
							, A.InitiatorID
							, A.InitiatorName
							, C.UserCode
							, C.UserName
							, C.SubKind AS FormSubKind
							, B.Created
							, B.TaskID
							, U.PhotoPath
							, E.DomainDataContext
							, S.SchemaContext
							, D.BusinessData1
							, D.BusinessData2
							, A.ProcessName
							FROM JWF_Process A
							INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
							INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
							INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
							LEFT OUTER JOIN jwf_domaindata E ON A.ProcessID = E.ProcessID
							LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.InitiatorID
							LEFT OUTER JOIN jwf_forms F ON D.FormID = F.FormID
							LEFT OUTER JOIN jwf_formsschema S ON F.SchemaID = S.SchemaID
							WHERE B.DeputyID = #{userID}
							AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017')
							AND C.State = 1
							AND B.State = 288
							AND A.ProcessState = 288
							AND A.DeleteDate IS NULL
							<choose>
								<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
									AND (D.BusinessData1 IS NULL
										<if test='bizDataList != null'>
											OR D.BusinessData1 IN 
											<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
												#{item}
											</foreach>
										</if>
									)
								</when>
								<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
									AND D.BusinessData1 = #{businessData1}
								</when>
							</choose>
						</if>
					) ApprovalList
					ORDER BY Created DESC
				) A
			WHERE ROWNUM &lt;= 5
		) T
		WHERE T.RNUM &gt;= 1
	</select>
	
	<!-- 홈화면 진행함 쿼리 -->
	<select id="selectHomeProcessList" parameterType="cmap" resultType="cmap">
	    SELECT T.*
		  FROM (SELECT ROWNUM AS RNUM, A.*
	            FROM   (
				    SELECT ProcessID AS "ProcessID"
						, WorkItemID AS "WorkItemID"
						, PerformerID AS "PerformerID"
						, FormInstID AS "FormInstID"
						, ProcessDescriptionID AS "ProcessDescriptionID"
						, FormSubject AS "FormSubject"
						, FormPrefix AS "FormPrefix"
						, FormID AS "FormID"
						, InitiatorID AS "InitiatorID"
						, InitiatorName AS "InitiatorName"
						, UserCode AS "UserCode"
						, UserName AS "UserName"
						, FormSubKind AS "FormSubKind"
						, startDate AS "StartDate"
						, Finished AS "Finished"
						, TaskID AS "TaskID"
						, DomainDataContext AS "DomainDataContext"
						, PhotoPath AS "PhotoPath"
						, BusinessData1 AS "BusinessData1"
						, BusinessData2 AS "BusinessData2"
					FROM (
						SELECT A.ProcessID
						, B.WorkItemID
						, C.PerformerID
						, A.FormInstID
						, A.ProcessDescriptionID
						, A.DocSubject AS FormSubject
						, D.FormPrefix
						, D.FormID
						, A.InitiatorID
						, A.InitiatorName
						, C.UserCode
						, C.UserName
						, C.SubKind AS FormSubKind
						, A.StartDate
						, NVL(B.Finished, '') AS Finished
						, B.TaskID
						, E.DomainDataContext
						, U.PhotoPath
						, D.BusinessData1
						, D.BusinessData2
						FROM JWF_Process A
						INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
						INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
						INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
						LEFT OUTER JOIN jwf_domaindata E ON A.ProcessID = E.ProcessID
						LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.InitiatorID
						WHERE C.UserCode = #{userID}
						AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T020','T023')
						AND C.State = 1
						AND B.State = 528
						AND A.ProcessState = 288
						AND A.DeleteDate IS NULL
						<choose>
							<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
								AND (D.BusinessData1 IS NULL
									<if test='bizDataList != null'>
										OR D.BusinessData1 IN 
										<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
											#{item}
										</foreach>
									</if>
								)
							</when>
							<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
								AND D.BusinessData1 = #{businessData1}
							</when>
						</choose>
			
						<if test="userID != null and userID != '' ">
							UNION ALL
				
							SELECT A.ProcessID
							, B.WorkItemID
							, C.PerformerID
							, A.FormInstID
							, A.ProcessDescriptionID
							, A.DocSubject AS FormSubject
							, D.FormPrefix
							, D.FormID
							, A.InitiatorID
							, A.InitiatorName
							, C.UserCode
							, C.UserName
							, C.SubKind AS FormSubKind
							, A.StartDate
							, NVL(B.Finished, '') AS Finished
							, B.TaskID
							, E.DomainDataContext
							, U.PhotoPath
							, D.BusinessData1
							, D.BusinessData2
							FROM JWF_Process A
							INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
							INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
							INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
							LEFT OUTER JOIN jwf_domaindata E ON A.ProcessID = E.ProcessID
							LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.InitiatorID
							WHERE B.DeputyID = #{userID}
							AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016')
							AND C.State = 1
							AND B.State = 528
							AND A.ProcessState = 288
							AND A.DeleteDate IS NULL
							<choose>
								<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
									AND (D.BusinessData1 IS NULL
										<if test='bizDataList != null'>
											OR D.BusinessData1 IN 
											<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
												#{item}
											</foreach>
										</if>
									)
								</when>
								<otherwise>
									AND D.BusinessData1 = #{businessData1}
								</otherwise>
							</choose>
						</if>
					) ProcessList
					ORDER BY Finished DESC
				) A
			WHERE ROWNUM &lt;= 5
		) T
		WHERE T.RNUM &gt;= 1
	</select>
	
	<!-- 홈화면 완료함 쿼리 -->
	<select id="selectHomeCompleteList" parameterType="cmap" resultType="cmap">
	    SELECT T.*
		  FROM (SELECT ROWNUM AS RNUM, A.*
	            FROM   (
					SELECT ProcessArchiveID AS "ProcessArchiveID"
						, PerformerID AS "PerformerID"
						, WorkitemArchiveID AS "WorkitemArchiveID"
						, ProcessDescriptionArchiveID AS "ProcessDescriptionArchiveID"
						, FormInstID AS "FormInstID"
						, FormPrefix AS "FormPrefix"
						, FormID AS "FormID"
						, InitiatorID AS "InitiatorID"
						, InitiatorName AS "InitiatorName"
						, FormSubject AS "FormSubject"
						, UserCode AS "UserCode"
						, EndDate AS "EndDate"
						, FormSubKind AS "FormSubKind"
						, PhotoPath AS "PhotoPath"
						, BusinessData1 AS "BusinessData1"
						, BusinessData2 AS "BusinessData2"
					FROM (
						SELECT B.ProcessID AS ProcessArchiveID
							, A.PerformerID
							, A.WorkitemID AS WorkitemArchiveID
							, B.ProcessDescriptionID AS ProcessDescriptionArchiveID
							, B.FormInstID
							, B.FormPrefix
							, C.FormID
							, B.InitiatorID
							, B.InitiatorName
							, B.DocSubject AS FormSubject
							, A.UserCode
							, B.EndDate
							, A.SubKind AS FormSubKind
							, U.PhotoPath
							, C.BusinessData1
							, C.BusinessData2
						FROM JWF_Workitem A
						INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
						INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
						LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
						WHERE ((A.UserCode = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021','T023'))
							<if test="userID != null and userID != '' ">
								OR (A.DeputyID = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021'))
							</if>
						)
						AND	B.ProcessState = 528
						AND A.Deleted IS NULL
						AND A.PIDeleted IS NULL
						AND A.PIBusinessState = '02_01'
						<choose>
							<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
								AND (C.BusinessData1 IS NULL
									<if test='bizDataList != null'>
										OR C.BusinessData1 IN 
										<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
											#{item}
										</foreach>
									</if>
								)
							</when>
							<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
								AND C.BusinessData1 = #{businessData1}
							</when>
						</choose>
					) CompleteList
					ORDER BY endDate DESC
				) A
			WHERE ROWNUM &lt;= 5
		) T
		WHERE T.RNUM &gt;= 1
	</select>
	
	<!-- 홈화면 반려함 쿼리 -->
	<select id="selectHomeRejectList" parameterType="cmap" resultType="cmap">
	    SELECT T.*
		  FROM (SELECT ROWNUM AS RNUM, A.*
	            FROM   (
				    SELECT ProcessArchiveID AS "ProcessArchiveID"
							, PerformerID AS "PerformerID"
							, WorkitemArchiveID AS "WorkitemArchiveID"
							, ProcessDescriptionArchiveID AS "ProcessDescriptionArchiveID"
							, FormInstID AS "FormInstID"
							, FormPrefix AS "FormPrefix"
							, FormID AS "FormID"
							, InitiatorID AS "InitiatorID"
							, InitiatorName AS "InitiatorName"
							, FormSubject AS "FormSubject"
							, UserCode AS "UserCode"
							, EndDate AS "EndDate"
							, FormSubKind AS "FormSubKind"
							, PhotoPath AS "PhotoPath"
							, BusinessData1 AS "BusinessData1"
							, BusinessData2 AS "BusinessData2"
						FROM (
						SELECT B.ProcessID AS ProcessArchiveID
							, A.PerformerID
							, A.WorkitemID AS WorkitemArchiveID
							, B.ProcessDescriptionID AS ProcessDescriptionArchiveID
							, B.FormInstID
							, B.FormPrefix
							, C.FormID
							, B.InitiatorID
							, B.InitiatorName
							, B.DocSubject AS FormSubject
							, A.UserCode
							, B.EndDate
							, A.SubKind AS FormSubKind
							, U.PhotoPath
							, C.BusinessData1
							, C.BusinessData2
						FROM JWF_Workitem A
						INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
						INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
						LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
						WHERE ((A.UserCode = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021','T023'))
							<if test="userID != null and userID != '' ">
								OR (A.DeputyID = #{userID} AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021'))
							</if>
						)
						AND B.ProcessState = 528
						AND A.Deleted IS NULL
						AND A.PIDeleted IS NULL
						AND A.PIBusinessState = '02_02'
						<choose>
							<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
								AND (C.BusinessData1 IS NULL
									<if test='bizDataList != null'>
										OR C.BusinessData1 IN 
										<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
											#{item}
										</foreach>
									</if>
								)
							</when>
							<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
								AND C.BusinessData1 = #{businessData1}
							</when>
						</choose>
					) RejectList
					ORDER BY endDate DESC
				) A
			WHERE ROWNUM &lt;= 5
		) T
		WHERE T.RNUM &gt;= 1
	</select>
	<!-- 통합진행함 목록 데이터 -->
	<select id="selectTotalProcessList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessID AS "ProcessID"
				, WorkItemID AS "WorkItemID"
				, PerformerID AS "PerformerID"
				, InitiatorID AS "InitiatorID"
				, InitiatorName AS "InitiatorName"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, SubKind AS "SubKind"
				, SubKind AS "FormSubKind"
				, ProcessDescriptionID AS "ProcessDescriptionID"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormPrefix AS "FormPrefix"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, StartDate AS "StartDate"
				, Finished AS "Finished"
				, ReadDate AS "ReadDate"
				, TaskID AS "TaskID"
				, ExtInfo AS "ExtInfo"
				, PhotoPath AS "PhotoPath"
				, DECODE(WIState,288,'Approval','Process') AS "Mode"
				, WIState AS "WIState"
				, ApprovalPassword AS "ApprovalPassword" 	
			FROM (
				SELECT A.ProcessID
				, B.WorkItemID
				, C.PerformerID
				, A.InitiatorID
				, A.InitiatorName
				, A.InitiatorUnitID
				, A.InitiatorUnitName
				, C.UserCode
				, C.UserName
				, C.SubKind
				, C.SubKind AS FormSubKind
				, D.*
				, A.StartDate AS StartDate
				, NVL(B.Finished, '') AS Finished
				, NVL(R.ReadDate, '') AS ReadDate
				, B.TaskID
				, F.ExtInfo
				, U.PhotoPath
				, CASE WHEN B.State = 288 THEN 'Approval' ELSE 'Process' END AS "Mode"
				, B.State AS WIState
				, NVL(OA.ApprovalPassword,'') AS ApprovalPassword
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				INNER JOIN sys_object_user_approval OA ON OA.USERCODE = C.USERCODE
				LEFT OUTER JOIN JWF_DocReadHistory R ON A.ProcessID = R.ProcessID AND C.UserCode = R.UserID AND R.AdminYN = 'N' AND R.FormInstID > 0
				LEFT OUTER JOIN JWF_Forms F ON D.FormID = F.FormID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.InitiatorID
				WHERE C.UserCode = #{userID}
				AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T020','T023')
				AND C.State = 1
				AND B.State IN (288,528)
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>

				<if test="userID != null and userID != '' ">
					UNION ALL
	
					SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, A.InitiatorID
					, A.InitiatorName
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, C.UserCode
					, C.UserName
					, C.SubKind
					, C.SubKind AS FormSubKind
					, D.*
					, A.StartDate AS StartDate
					, NVL(B.Finished, '') AS Finished
					, NVL(R.ReadDate, '') AS ReadDate
					, B.TaskID
					, F.ExtInfo
					, U.PhotoPath
					, CASE WHEN B.State = 288 THEN 'Approval' ELSE 'Process' END AS "Mode"
					, B.State AS WIState
					, NVL(OA.ApprovalPassword,'') AS ApprovalPassword
					FROM JWF_Process A
					INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
					INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
					INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
					INNER JOIN sys_object_user_approval OA ON OA.USERCODE = C.USERCODE
					LEFT OUTER JOIN JWF_DocReadHistory R ON A.ProcessID = R.ProcessID AND C.UserCode = R.UserID AND R.AdminYN = 'N' AND R.FormInstID > 0
					LEFT OUTER JOIN JWF_Forms F ON D.FormID = F.FormID
					LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.InitiatorID
					WHERE B.DeputyID = #{userID}
					AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016')
					AND C.State = 1
					AND B.State IN (288,528)
					AND A.ProcessState = 288
					<if test="adminYn == null or adminYn == '' ">
						AND A.DeleteDate IS NULL
					</if>
				</if>
			) ProcessList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		Finished BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 --> 
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND Finished BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY"  prefixOverrides =",">  
		    <if test = "sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
				, Priority DESC 
		    </if>
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , StartDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>	
    <!-- 통합진행함 목록 개수 데이터 -->
	<select id="selectTotalProcessListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM  (
			SELECT ApprovalList.* FROM (
				SELECT A.ProcessID
				, B.WorkItemID
				, C.PerformerID
				, A.InitiatorID
				, A.InitiatorName
				, A.InitiatorUnitID
				, A.InitiatorUnitName
				, C.UserCode
				, C.UserName
				, C.SubKind
				, D.*
				, A.StartDate
				, NVL(B.Finished, '') AS Finished
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				WHERE C.UserCode = #{userID}
				AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T019','T020','T023')
				AND C.State = 1
				AND B.State IN (288, 528)
				AND A.ProcessState = 288
								
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
	
				<if test="userID != null and userID != '' ">
					UNION ALL
		
					SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, A.InitiatorID
					, A.InitiatorName
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, C.UserCode
					, C.UserName
					, C.SubKind
					, D.*
					, A.StartDate
					, NVL(B.Finished, '') AS Finished
					FROM JWF_Process A
					INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
					INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
					INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
					WHERE B.DeputyID = #{userID}
					AND C.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017')
					AND C.State = 1
					AND B.State IN (288,528)
					AND A.ProcessState = 288
					<if test="adminYn == null or adminYn == '' ">
						AND A.DeleteDate IS NULL
					</if>
				</if>
			) ApprovalList
		    <!-- 검색 데이터 Where 절 -->
		    <trim prefix="WHERE" prefixOverrides="AND |OR ">
			  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	    Finished BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			  	</if>
				<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
		    		AND 
		    		<choose>
						<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
						<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
						<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
						<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					</choose>
					LIKE '%' || #{searchWord} || '%'
				</if>
				<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND (
						FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
						InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
						InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
					)
				</if>
				<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
					<choose>
		                <when test="searchGroupType == 'Date' ">
		                    AND Finished BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
		                </when>
		                <otherwise>
		                	AND 
		            		<choose>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
								<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
								<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
		            		</choose>
		            		= #{searchGroupWord}
		                </otherwise>
		            </choose>
				</if>
				<if test="userNm != null and userNm !=''">
					AND InitiatorName LIKE '%' || #{userNm} || '%'
				</if>
				<if test="titleNm != null and titleNm !=''">
					AND FormSubject LIKE '%' || #{titleNm} || '%'
				</if>
			</trim>
		) A
	</select>
	
	<update id="updateHandoverUser" parameterType="cmap">
	    UPDATE JWF_FormsTempInstBox
		SET UserCode = #{UserCode}
		WHERE FormInstID IN
		<foreach collection="FormInstId" item="item" index="index" separator="," open="(" close=")">
		    #{item}
		</foreach>
		AND UserCode = #{SessionUserCode}
	</update>

	<!-- 완료함 목록 데이터 -->
	<select id="selectStoreCompleteList" parameterType="cmap" resultType="cmap">
			<include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessArchiveID AS "ProcessArchiveID"
				, PerformerID AS "PerformerID"
				, WorkitemArchiveID AS "WorkitemArchiveID"
				, FormPrefix AS "FormPrefix"
				, InitiatorID AS "InitiatorID"
				, InitiatorName AS "InitiatorName"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, SubKind AS "SubKind"
				, SubKind AS "FormSubKind"
				, ProcessDescriptionArchiveID AS "ProcessDescriptionArchiveID"				
                , BusinessData1 AS "BusinessData1"
                , BusinessData2 AS "BusinessData2"
                , BusinessData3 AS "BusinessData3"
                , BusinessData4 AS "BusinessData4"
                , BusinessData5 AS "BusinessData5"
                , BusinessData6 AS "BusinessData6"
                , BusinessData7 AS "BusinessData7"
                , BusinessData8 AS "BusinessData8"
                , BusinessData9 AS "BusinessData9"
                , BusinessData10 AS "BusinessData10"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, DocNo AS "DocNo"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, EndDate AS "EndDate"
				, TaskID AS "TaskID"
				, ExtInfo AS "ExtInfo"
				, PhotoPath AS "PhotoPath"
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					, BodyContextOrg AS "BodyContextOrg"
				</if>
			FROM (
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, B.FormPrefix
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					, B.EndDate AS EndDate
					, A.TaskID
					, F.ExtInfo
					, U.PhotoPath
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg AS BodyContextOrg
					</if>
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				LEFT OUTER JOIN JWF_Forms F ON C.FormID = F.FormID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE A.UserCode = #{userID}
				AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021')
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_01'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
				
				<if test="userID != null and userID != '' ">				
					UNION ALL
					SELECT B.ProcessArchiveID
						, A.PerformerID
						, A.WorkitemArchiveID
						, B.FormPrefix
						, B.InitiatorID
						, B.InitiatorName
						, B.InitiatorUnitID
						, B.InitiatorUnitName
						, A.UserCode
						, A.UserName
						, A.SubKind
						, A.SubKind AS FormSubKind
						, C.*
						, B.EndDate AS EndDate
						, A.TaskID
						, F.ExtInfo
						, U.PhotoPath
						<if test="searchType != null and searchType == 'BodyContextOrg' ">
							, D.BodyContextOrg
						</if>
					FROM JWF_WorkitemArchive A
					INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
					INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
					</if>
					LEFT OUTER JOIN JWF_Forms F ON C.FormID = F.FormID
					LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
					<if test="companyCode != null and companyCode != '' ">
						INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
					</if>					
					WHERE A.DeputyID = #{userID}
					AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021')
					<if test="adminYn == null or adminYn == '' ">
						AND A.Deleted IS NULL
					</if>
					AND A.PIDeleted IS NULL
					AND A.PIBusinessState = '02_01'
					<if test="companyCode != null and companyCode != '' ">
						AND SOG.CompanyCode = #{companyCode}
						AND SOG.GroupType = 'Dept'
					</if>					
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (C.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR C.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND C.BusinessData1 = #{businessData1}
						</when>
					</choose>
				</if>
			) CompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%'			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("FormName")'>FormName</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<otherwise>endDate</otherwise>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 완료함 목록 개수 데이터 -->
	<select id="selectStoreCompleteListCnt" resultType="java.lang.Long">
		SELECT COUNT(*) FROM (
			SELECT CompleteList.* FROM (
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, B.FormPrefix
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					, B.EndDate AS EndDate
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE A.UserCode = #{userID}
				AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021')
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_01'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
				<if test="userID != null and userID != '' ">
					UNION ALL
					SELECT B.ProcessArchiveID
						, A.PerformerID
						, A.WorkitemArchiveID
						, B.FormPrefix
						, B.InitiatorID
						, B.InitiatorName
						, B.InitiatorUnitID
						, B.InitiatorUnitName
						, A.UserCode
						, A.UserName
						, A.SubKind
						, A.SubKind AS FormSubKind
						, C.*
						, B.EndDate AS EndDate
						<if test="searchType != null and searchType == 'BodyContextOrg' ">
							, D.BodyContextOrg
						</if>
					FROM JWF_WorkitemArchive A
					INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
					INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
					</if>
					<if test="companyCode != null and companyCode != '' ">
						INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
					</if>					
					WHERE A.DeputyID = #{userID}
					AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021')
					<if test="adminYn == null or adminYn == '' ">
						AND A.Deleted IS NULL
					</if>
					AND A.PIDeleted IS NULL
					AND A.PIBusinessState = '02_01'
					<if test="companyCode != null and companyCode != '' ">
						AND SOG.CompanyCode = #{companyCode}
						AND SOG.GroupType = 'Dept'
					</if>					
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (C.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR C.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND C.BusinessData1 = #{businessData1}
						</when>
					</choose>
				</if>
			) CompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%'			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("FormName")'>FormName</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 완료함 그룹별 목록 조회 -->
	<select id="selectStoreCompleteGroupList" parameterType="cmap" resultType="cmap">
		SELECT 
         		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>CompleteList."Date" </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>CompleteList.InitiatorID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>CompleteList.InitiatorUnitID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>CompleteList.InitiatorUnitName </when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>CompleteList.FormPrefix </when>
					<when test='searchGroupType.equalsIgnoreCase("FormName")'>CompleteList.FormName </when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>CompleteList.SubKind </when>
         		</choose>
			AS "fieldID"
			, COUNT(1) AS "fieldCnt"
		<if test="searchGroupType == 'Date'">
	        , CompleteList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix' or searchGroupType == 'FormName'">
	        , CompleteList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	        , CompleteList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID' or searchGroupType == 'InitiatorUnitName'">
	        , CompleteList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	        , CompleteList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, B.FormPrefix
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.EndDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(B.EndDate,'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE A.UserCode = #{userID}
				AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021')
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_01'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
				<if test="userID != null and userID != '' ">
					UNION ALL
					SELECT B.ProcessArchiveID
						, A.PerformerID
						, A.WorkitemArchiveID
						, B.FormPrefix
						, B.InitiatorID
						, B.InitiatorName
						, B.InitiatorUnitID
						, B.InitiatorUnitName
						, A.UserCode
						, A.UserName
						, A.SubKind
						, A.SubKind AS FormSubKind
						, C.*
						<choose>
							<when test="searchGroupType == 'Date'">
								, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.EndDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
							</when>
							<otherwise>
								, TO_CHAR(B.EndDate,'YYYY-MM-DD') AS "Date"
							</otherwise>
						</choose>
						<if test="searchType != null and searchType == 'BodyContextOrg' ">
							, D.BodyContextOrg
						</if>
					FROM JWF_WorkitemArchive A
					INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
					INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
					</if>
					<if test="companyCode != null and companyCode != '' ">
						INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
					</if>					
					WHERE A.DeputyID = #{userID}
					AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021')
					<if test="adminYn == null or adminYn == '' ">
						AND A.Deleted IS NULL
					</if>
					AND A.PIDeleted IS NULL
					AND A.PIBusinessState = '02_01'
					<if test="companyCode != null and companyCode != '' ">
						AND SOG.CompanyCode = #{companyCode}
						AND SOG.GroupType = 'Dept'
					</if>					
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (C.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR C.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND C.BusinessData1 = #{businessData1}
						</when>
					</choose>
				</if>
			) CompleteList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	"Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND "Date" <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND "Date" <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
           		<choose>
           			<when test='searchGroupType.equalsIgnoreCase("Date")'>CompleteList."Date"</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>CompleteList.InitiatorID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>CompleteList.InitiatorUnitID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>CompleteList.InitiatorUnitName</when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>CompleteList.FormPrefix</when>
					<when test='searchGroupType.equalsIgnoreCase("FormName")'>CompleteList.FormName</when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>CompleteList.SubKind </when>
           		</choose>
		  	    <if test="searchGroupType != 'Date'">
			 		<if test="searchGroupType == 'FormPrefix'">
				        , CompleteList.FormName
				    </if>
				     <if test="searchGroupType == 'InitiatorID'">
				        , CompleteList.InitiatorName
				    </if>
				     <if test="searchGroupType == 'InitiatorUnitID'">
				        , CompleteList.InitiatorUnitName
				    </if>
		  	    </if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
		  	    "fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 완료함 엑셀 데이터 조회 -->
	<select id="selectStoreCompleteListExcel" parameterType="cmap" resultType="cmap">
		SELECT
			SubKind AS "SubKind"
			, FormSubject AS "FormSubject"
			, InitiatorUnitName AS "InitiatorUnitName"
			, InitiatorName AS "InitiatorName"
			, IsFile AS "IsFile"
			, FormName AS "FormName"
			, NVL(DocNo, ' ') AS "DocNo"
			, TO_CHAR(EndDate, 'YYYY-MM-DD HH24:MI:SS') AS "EndDate"
			, IsComment AS "IsComment"
			, IsModify AS "IsModify"
			, SubUserName AS "SubUserName"
		FROM (
			SELECT B.ProcessArchiveID
				, A.PerformerID
				, A.WorkitemArchiveID
				, B.FormPrefix
				, B.InitiatorID
				, B.InitiatorName
				, B.InitiatorUnitID
				, B.InitiatorUnitName
				, A.UserCode
				, A.UserName
				, A.SubKind
				, A.SubKind AS FormSubKind
				, C.*
				, B.EndDate AS EndDate
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					, D.BodyContextOrg
				</if>
				,Fn_SplitString_r(C.businessdata5, '^^^', 2) as SubUserName
			FROM JWF_WorkitemArchive A
			INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
			INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
			<if test="searchType != null and searchType == 'BodyContextOrg' ">
				INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
			</if>
			<if test="companyCode != null and companyCode != '' ">
				INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
			</if>			
			WHERE A.UserCode = #{userID}
			AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021')
			<if test="adminYn == null or adminYn == '' ">
				AND A.Deleted IS NULL
			</if>
			AND A.PIDeleted IS NULL
			AND A.PIBusinessState = '02_01'
			<if test="companyCode != null and companyCode != '' ">
				AND SOG.CompanyCode = #{companyCode}
				AND SOG.GroupType = 'Dept'
			</if>			
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (C.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR C.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND C.BusinessData1 = #{businessData1}
				</when>
			</choose>
			<if test="userID != null and userID != '' ">
				UNION ALL
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, B.FormPrefix
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					, B.EndDate AS EndDate
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					, D.BodyContextOrg AS BodyContextOrg
				</if>					
					,Fn_SplitString_r(C.businessdata5, '^^^', 2) as SubUserName
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE A.DeputyID = #{userID}
				AND A.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021')
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_01'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			</if>
		) CompleteList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%'			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("FormName")'>FormName</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =","> 
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<otherwise>endDate</otherwise>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>
	
	<!-- 수신공람함 목록 데이터 -->
	<select id="selectStoreReceiveExhibitList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessArchiveID AS "ProcessArchiveID"
				, PerformerID AS "PerformerID"
				, WorkitemArchiveID AS "WorkitemArchiveID"
				, FormPrefix AS "FormPrefix"
				, InitiatorID AS "InitiatorID"
				, InitiatorName AS "InitiatorName"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, SubKind AS "SubKind"
				, SubKind AS "FormSubKind"
				, ProcessDescriptionArchiveID AS "ProcessDescriptionArchiveID"				
                , BusinessData1 AS "BusinessData1"
                , BusinessData2 AS "BusinessData2"
                , BusinessData3 AS "BusinessData3"
                , BusinessData4 AS "BusinessData4"
                , BusinessData5 AS "BusinessData5"
                , BusinessData6 AS "BusinessData6"
                , BusinessData7 AS "BusinessData7"
                , BusinessData8 AS "BusinessData8"
                , BusinessData9 AS "BusinessData9"
                , BusinessData10 AS "BusinessData10"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, DocNo AS "DocNo"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, EndDate AS "EndDate"
				, TaskID AS "TaskID"
				, ExtInfo AS "ExtInfo"
				, PhotoPath AS "PhotoPath"
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					, BodyContextOrg AS "BodyContextOrg"
				</if>
			FROM (
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, B.FormPrefix
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					, B.EndDate AS EndDate
					, A.TaskID
					, F.ExtInfo
					, U.PhotoPath
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				LEFT OUTER JOIN JWF_Forms F ON C.FormID = F.FormID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE A.UserCode = #{userID}
				AND A.SubKind = 'T022'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_01'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) CompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%'			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<otherwise>endDate</otherwise>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 수신공람함 목록 개수 데이터 -->
	<select id="selectStoreReceiveExhibitListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
			SELECT CompleteList.* FROM (
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, B.FormPrefix
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					, B.EndDate AS EndDate
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE A.UserCode = #{userID}
				AND A.SubKind = 'RE'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_01'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) CompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%'			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 수신공람함 그룹별 목록 조회 -->
	<select id="selectStoreReceiveExhibitGroupList" parameterType="cmap" resultType="cmap">
			SELECT 
         		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>CompleteList."Date" </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>CompleteList.InitiatorID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>CompleteList.InitiatorUnitID </when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>CompleteList.FormPrefix </when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>CompleteList.SubKind </when>
         		</choose>
			AS "fieldID"
			, COUNT(1) AS "fieldCnt"
		<if test="searchGroupType == 'Date'">
	        , CompleteList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	        , CompleteList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	        , CompleteList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	        , CompleteList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	        , CompleteList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, B.FormPrefix
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(B.EndDate,'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.EndDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE A.UserCode = #{userID}
				AND A.SubKind = 'T022'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_01'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) CompleteList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	 "Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
           		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>CompleteList."Date"</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>CompleteList.InitiatorID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>CompleteList.InitiatorUnitID</when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>CompleteList.FormPrefix</when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>CompleteList.SubKind </when>
           		</choose>
		  	    <if test="searchGroupType != 'Date'">
			 		<if test="searchGroupType == 'FormPrefix'">
				        , CompleteList.FormName
				    </if>
				     <if test="searchGroupType == 'InitiatorID'">
				        , CompleteList.InitiatorName
				    </if>
				     <if test="searchGroupType == 'InitiatorUnitID'">
				        , CompleteList.InitiatorUnitName
				    </if>
		  	    </if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
		  	    "fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 수신공람함 엑셀 데이터 조회 -->
	<select id="selectStoreReceiveExhibitListExcel" parameterType="cmap" resultType="cmap">
		SELECT
			SubKind AS "SubKind"
			, FormSubject AS "FormSubject"
			, InitiatorUnitName AS "InitiatorUnitName"
			, InitiatorName AS "InitiatorName"
			, IsFile AS "IsFile"
			, FormName AS "FormName"
			, NVL(DocNo, ' ') AS "DocNo"
			, TO_CHAR(EndDate, 'YYYY-MM-DD HH24:MI:SS') AS "EndDate"
			, IsComment AS "IsComment"
			, IsModify AS "IsModify"
		FROM (
			SELECT B.ProcessArchiveID
				, A.PerformerID
				, A.WorkitemArchiveID
				, B.FormPrefix
				, B.InitiatorID
				, B.InitiatorName
				, B.InitiatorUnitID
				, B.InitiatorUnitName
				, A.UserCode
				, A.UserName
				, A.SubKind
				, A.SubKind AS FormSubKind
				, C.*
				, B.EndDate AS EndDate
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					, D.BodyContextOrg
				</if>
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
			<if test="searchType != null and searchType == 'BodyContextOrg' ">
				INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
			</if>
			<if test="companyCode != null and companyCode != '' ">
				INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
			</if>			
			WHERE A.UserCode = #{userID}
			AND A.SubKind = 'T022'
			<if test="adminYn == null or adminYn == '' ">
				AND A.Deleted IS NULL
			</if>
			AND A.PIDeleted IS NULL
			AND A.PIBusinessState = '02_01'
			<if test="companyCode != null and companyCode != '' ">
				AND SOG.CompanyCode = #{companyCode}
				AND SOG.GroupType = 'Dept'
			</if>			
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (C.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR C.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND C.BusinessData1 = #{businessData1}
				</when>
			</choose>
		) CompleteList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%'			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =","> 
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<otherwise>endDate</otherwise>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>	
	
	<!-- 반려함 목록 데이터 -->
	<select id="selectStoreRejectList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessArchiveID AS "ProcessArchiveID"
				, PerformerID AS "PerformerID"
				, WorkitemArchiveID AS "WorkitemArchiveID"
				, FormPrefix AS "FormPrefix"
				, InitiatorID AS "InitiatorID"
				, InitiatorName AS "InitiatorName"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, SubKind AS "SubKind"
				, SubKind AS "FormSubKind"
				, ProcessDescriptionArchiveID AS "ProcessDescriptionArchiveID"				
                , BusinessData1 AS "BusinessData1"
                , BusinessData2 AS "BusinessData2"
                , BusinessData3 AS "BusinessData3"
                , BusinessData4 AS "BusinessData4"
                , BusinessData5 AS "BusinessData5"
                , BusinessData6 AS "BusinessData6"
                , BusinessData7 AS "BusinessData7"
                , BusinessData8 AS "BusinessData8"
                , BusinessData9 AS "BusinessData9"
                , BusinessData10 AS "BusinessData10"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, DocNo AS "DocNo"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, EndDate AS "EndDate"
				, TaskID AS "TaskID"
				, ExtInfo AS "ExtInfo"
				, PhotoPath AS "PhotoPath"
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					, BodyContextOrg AS "BodyContextOrg"
				</if>
			FROM (
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, B.FormPrefix
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					, B.EndDate AS EndDate
					, A.TaskID
					, F.ExtInfo
					, U.PhotoPath
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
				LEFT OUTER JOIN JWF_Forms F ON C.FormID = F.FormID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE A.UserCode = #{userID}
				AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021')
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_02'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
				<if test="userID != null and userID != '' ">
					UNION ALL
					SELECT B.ProcessArchiveID
						, A.PerformerID
						, A.WorkitemArchiveID
						, B.FormPrefix
						, B.InitiatorID
						, B.InitiatorName
						, B.InitiatorUnitID
						, B.InitiatorUnitName
						, A.UserCode
						, A.UserName
						, A.SubKind
						, A.SubKind AS FormSubKind
						, C.*
						, B.EndDate AS EndDate
						, A.TaskID
						, F.ExtInfo
						, U.PhotoPath
						<if test="searchType != null and searchType == 'BodyContextOrg' ">
							, D.BodyContextOrg
						</if>
					FROM JWF_WorkitemArchive A
					INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
					INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
					LEFT OUTER JOIN JWF_Forms F ON C.FormID = F.FormID
					LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
					<if test="companyCode != null and companyCode != '' ">
						INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
					</if>					
					WHERE A.DeputyID = #{userID}
					AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021')
					<if test="adminYn == null or adminYn == '' ">
						AND A.Deleted IS NULL
					</if>
					AND A.PIDeleted IS NULL
					AND A.PIBusinessState = '02_02'
					<if test="companyCode != null and companyCode != '' ">
						AND SOG.CompanyCode = #{companyCode}
						AND SOG.GroupType = 'Dept'
					</if>					
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (C.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR C.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND C.BusinessData1 = #{businessData1}
						</when>
					</choose>
				</if>
			) RejectList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				 <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<otherwise>endDate</otherwise>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 반려함 목록 개수 데이터 -->
	<select id="selectStoreRejectListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
			SELECT RejectList.* FROM (
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, B.FormPrefix
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					, B.EndDate AS EndDate
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE A.UserCode = #{userID}
				AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021')
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_02'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
				<if test="userID != null and userID != '' ">
					UNION ALL
					SELECT B.ProcessArchiveID
						, A.PerformerID
						, A.WorkitemArchiveID
						, B.FormPrefix
						, B.InitiatorID
						, B.InitiatorName
						, B.InitiatorUnitID
						, B.InitiatorUnitName
						, A.UserCode
						, A.UserName
						, A.SubKind
						, A.SubKind AS FormSubKind
						, C.*
						, B.EndDate AS EndDate
					FROM JWF_WorkitemArchive A
					INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
					INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
					<if test="companyCode != null and companyCode != '' ">
						INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
					</if>					
					WHERE A.DeputyID = #{userID}
					AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021')
					<if test="adminYn == null or adminYn == '' ">
						AND A.Deleted IS NULL
					</if>
					AND A.PIDeleted IS NULL
					AND A.PIBusinessState = '02_02'
					<if test="companyCode != null and companyCode != '' ">
						AND SOG.CompanyCode = #{companyCode}
						AND SOG.GroupType = 'Dept'
					</if>					
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (C.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR C.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND C.BusinessData1 = #{businessData1}
						</when>
					</choose>
				</if>
			) RejectList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				 <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 반려함 그룹별 목록 조회 -->
	<select id="selectStoreRejectGroupList" parameterType="cmap" resultType="cmap">
			SELECT 
         		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>RejectList."Date" </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>RejectList.InitiatorID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>RejectList.InitiatorUnitID </when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>RejectList.FormPrefix </when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>RejectList.SubKind </when>
         		</choose>
			AS "fieldID"
			, COUNT(1) AS "fieldCnt"
		<if test="searchGroupType == 'Date'">
	        , RejectList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	        , RejectList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	        , RejectList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	        , RejectList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	        , RejectList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, B.FormPrefix
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(B.EndDate,'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.EndDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE A.UserCode = #{userID}
				AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021')
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_02'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
				<if test="userID != null and userID != '' ">
					UNION ALL
					SELECT B.ProcessArchiveID
						, A.PerformerID
						, A.WorkitemArchiveID
						, B.FormPrefix
						, B.InitiatorID
						, B.InitiatorName
						, B.InitiatorUnitID
						, B.InitiatorUnitName
						, A.UserCode
						, A.UserName
						, A.SubKind
						, A.SubKind AS FormSubKind
						, C.*
						<choose>
							<when test="searchGroupType == 'Date'">
								, TO_CHAR(B.EndDate,'YYYY-MM-DD') AS "Date"
							</when>
							<otherwise>
								, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.EndDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
							</otherwise>
						</choose>
					FROM JWF_WorkitemArchive A
					INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
					INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
					<if test="companyCode != null and companyCode != '' ">
						INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
					</if>					
					WHERE A.DeputyID = #{userID}
					AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021')
					<if test="adminYn == null or adminYn == '' ">
						AND A.Deleted IS NULL
					</if>
					AND A.PIDeleted IS NULL
					AND A.PIBusinessState = '02_02'
					<if test="companyCode != null and companyCode != '' ">
						AND SOG.CompanyCode = #{companyCode}
						AND SOG.GroupType = 'Dept'
					</if>					
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (C.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR C.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND C.BusinessData1 = #{businessData1}
						</when>
					</choose>
				</if>
			) RejectList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		"Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
           		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>RejectList."Date"</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>RejectList.InitiatorID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>RejectList.InitiatorUnitID</when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>RejectList.FormPrefix</when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>RejectList.SubKind </when>
           		</choose>
			 	<if test="searchGroupType != 'Date'">
			 		<if test="searchGroupType == 'FormPrefix'">
				        , RejectList.FormName
				    </if>
				     <if test="searchGroupType == 'InitiatorID'">
				        , RejectList.InitiatorName
				    </if>
				     <if test="searchGroupType == 'InitiatorUnitID'">
				        , RejectList.InitiatorUnitName
				    </if>
			 	</if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 반려함 엑셀 데이터 조회 -->
	<select id="selectStoreRejectListExcel" parameterType="cmap" resultType="cmap">
		SELECT
			SubKind AS "SubKind"
			, FormSubject AS "FormSubject"
			, InitiatorUnitName AS "InitiatorUnitName"
			, InitiatorName AS "InitiatorName"
			, IsFile AS "IsFile"
			, FormName AS "FormName"
			, NVL(DocNo, ' ') AS "DocNo"
			, TO_CHAR(EndDate, 'YYYY-MM-DD HH24:MI:SS') AS "EndDate"
			, IsComment AS "IsComment"
			, IsModify AS "IsModify"
			, SubUserName AS "SubUserName"
		FROM (
			SELECT B.ProcessArchiveID
				, A.PerformerID
				, A.WorkitemArchiveID
				, B.FormPrefix
				, B.InitiatorID
				, B.InitiatorName
				, B.InitiatorUnitID
				, B.InitiatorUnitName
				, A.UserCode
				, A.UserName
				, A.SubKind
				, A.SubKind AS FormSubKind
				, C.*
				, B.EndDate AS EndDate
				,Fn_SplitString_r(C.businessdata5, '^^^', 2) as SubUserName
			FROM JWF_WorkitemArchive A
			INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
			INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
			<if test="companyCode != null and companyCode != '' ">
				INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
			</if>			
			WHERE A.UserCode = #{userID}
			AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021')
			<if test="adminYn == null or adminYn == '' ">
				AND A.Deleted IS NULL
			</if>
			AND A.PIDeleted IS NULL
			AND A.PIBusinessState = '02_02'
			<if test="companyCode != null and companyCode != '' ">
				AND SOG.CompanyCode = #{companyCode}
				AND SOG.GroupType = 'Dept'
			</if>			
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (C.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR C.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND C.BusinessData1 = #{businessData1}
				</when>
			</choose>
			<if test="userID != null and userID != '' ">
				UNION ALL
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, B.FormPrefix
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, A.SubKind AS FormSubKind
					, C.*
					, B.EndDate AS EndDate
					,Fn_SplitString_r(C.businessdata5, '^^^', 2) as SubUserName
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
				<if test="companyCode != null and companyCode != '' ">
					INNER JOIN sys_object_group SOG  ON SOG.GroupCode = B.InitiatorUnitID
				</if>				
				WHERE A.DeputyID = #{userID}
				AND A.SubKind IN ('T000','T004','T005','T006','T008','T009','T011','T016','T017','T018','T109','T020','T021')
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				AND A.PIBusinessState = '02_02'
				<if test="companyCode != null and companyCode != '' ">
					AND SOG.CompanyCode = #{companyCode}
					AND SOG.GroupType = 'Dept'
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			</if>
		) RejectList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<otherwise>endDate</otherwise>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>
	
	<!-- 참조/회람함 목록 데이터 -->
	<select id="selectStoreTCInfoList" parameterType="cmap" resultType="cmap">
	   <include refid="oracle.include.pagingHeader"/>
			SELECT
				CirculationBoxID AS "CirculationBoxID"
				, ProcessID AS "ProcessID"
				, CirculationBoxDescriptionID AS "CirculationBoxDescriptionID"
				, FormInstID AS "FormInstID"
				, ReceiptID AS "ReceiptID"
				, ReceiptType AS "ReceiptType"
				, ReceiptName AS "ReceiptName"
				, ReceiptDate AS "ReceiptDate"
				, Kind AS "Kind"
				, State AS "State"
				, ReadDate AS "ReadDate"
				, SenderID AS "SenderID"
				, SenderName AS "SenderName"
				, Subject AS "Subject"
				, "Comment"
				, DataState AS "DataState"
				, RegID AS "RegID"
				, RegDate AS "RegDate"
				, ModID AS "ModID"
				, ModDate AS "ModDate"
				, FormSubKind AS "FormSubKind"
				, SubKind AS "SubKind"
				, InitiatorID AS "InitiatorID"
				, InitiatorName AS "InitiatorName"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, InitiatedDate AS "InitiatedDate"
				, FormID AS "FormID"
				, FormName AS "FormName"
				, FormPrefix AS "FormPrefix"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, ExtInfo AS "ExtInfo"
				, DocNo AS "DocNo"
				, PhotoPath AS "PhotoPath"
				, BodyContextOrg AS "BodyContextOrg"
				, BusinessData1 AS "BusinessData1"
				, BusinessData2 AS "BusinessData2"
				, BusinessData3 AS "BusinessData3"
				, BusinessData4 AS "BusinessData4"
				, BusinessData5 AS "BusinessData5"
				, BusinessData6 AS "BusinessData6"
				, BusinessData7 AS "BusinessData7"
				, BusinessData8 AS "BusinessData8"
				, BusinessData9 AS "BusinessData9"
				, BusinessData10 AS "BusinessData10"
			FROM (
				SELECT 	  A.CirculationBoxID
						, A.ProcessID
						, A.CirculationBoxDescriptionID
						, A.FormInstID
						, A.ReceiptID
						, A.ReceiptType
						, A.ReceiptName
						, A.ReceiptDate AS ReceiptDate
						, A.Kind
						, A.State
						, A.ReadDate AS ReadDate
						, A.SenderID
						, A.SenderName
						, A.Subject
						, A.Comment_ AS "Comment"
						, A.DataState
						, A.RegID
						, A.RegDate AS RegDate
						, A.ModID
						, A.ModDate AS ModDate
						, A.kind AS FormSubKind
						, A.kind AS SubKind
						, B.InitiatorID
						, P.InitiatorName
						, B.InitiatorUnitID
						, P.InitiatorUnitName
						, B.InitiatedDate AS InitiatedDate
						, B.DocNo
						, B.BodyContextOrg
						, C.FormID
						, F.FormName
						, C.FormPrefix
						, C.FormSubject
						, C.IsSecureDoc
						, C.IsFile
						, C.FileExt
						, C.IsComment
						, C.ApproverCode
						, C.ApproverName
						, C.ApprovalStep
						, C.ApproverSIPAddress
						, C.IsReserved
						, C.ReservedGubun
						, C.ReservedTime
						, C.Priority
						, C.IsModify
						, C.Reserved1
						, C.Reserved2
						, F.ExtInfo
						, U.PhotoPath
						, D.BusinessData1
						, D.BusinessData2
						, D.BusinessData3
						, D.BusinessData4
						, D.BusinessData5
						, D.BusinessData6
						, D.BusinessData7
						, D.BusinessData8
						, D.BusinessData9
						, D.BusinessData10
				FROM JWF_CIRCULATIONBOXARCHIVE A
				INNER JOIN JWF_FORMINSTANCEARCHIVE B ON A.FormInstID = B.FormInstID
				INNER JOIN JWF_CIRCULATIONBOXDESCARCHIVE C ON A.CIRCULATIONBOXDESCRIPTIONID = C.CIRCULATIONBOXDESCRIPTIONID
				LEFT OUTER JOIN JWF_Forms F ON C.FormID = F.FormID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
				INNER JOIN JWF_PROCESSDESCRIPTIONARCHIVE D ON B.FormInstID = D.FormInstID
				INNER JOIN JWF_PROCESSARCHIVE P ON D.ProcessDescriptionArchiveID = P.ProcessDescriptionArchiveID AND P.ParentProcessID = 0
				WHERE A.State = 'C'
				<if test="adminYn == null or adminYn == '' ">
					AND B.DeletedDate IS NULL
				</if>
				AND A.ReceiptType = 'P'
				AND A.ReceiptID = #{userID}
				AND A.DataState != 'D'
				<if test="companyCode != null and companyCode != '' ">
					AND B.EntCode = #{companyCode}
				</if>				
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) TCInfoList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		RegDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND RegDate <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND RegDate <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND RegDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("FormName")'>FormName</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		     <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , RegDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<otherwise> RegDate</otherwise>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 참조/회람함 목록 개수 데이터 -->
	<select id="selectStoreTCInfoListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
			SELECT TCInfoList.* FROM (
				SELECT A.*
						, A.kind AS FormSubKind
						, A.kind AS SubKind
						, B.InitiatorID
						, B.InitiatorName
						, B.InitiatorUnitID
						, B.InitiatorUnitName
						, B.InitiatedDate
						, B.DocNo
						, B.BodyContextOrg
						, C.FormID
						, C.FormName
						, C.FormPrefix
						, C.FormSubject
						, C.IsSecureDoc
						, C.IsFile
						, C.FileExt
						, C.IsComment
						, C.ApproverCode
						, C.ApproverName
						, C.ApprovalStep
						, C.ApproverSIPAddress
						, C.IsReserved
						, C.ReservedGubun
						, C.ReservedTime
						, C.Priority
						, C.IsModify
						, C.Reserved1
						, C.Reserved2
				FROM JWF_CIRCULATIONBOXARCHIVE A
				INNER JOIN JWF_FORMINSTANCEARCHIVE B ON A.FORMINSTID = B.FORMINSTID
				INNER JOIN JWF_CIRCULATIONBOXDESCARCHIVE C ON A.CIRCULATIONBOXDESCRIPTIONID = C.CIRCULATIONBOXDESCRIPTIONID
				INNER JOIN JWF_PROCESSDESCRIPTIONARCHIVE D ON B.FORMINSTID = D.FORMINSTID
				INNER JOIN JWF_PROCESSARCHIVE P ON D.PROCESSDESCRIPTIONARCHIVEID = P.PROCESSDESCRIPTIONARCHIVEID AND P.ParentProcessID = 0
				WHERE A.State = 'C'
				<if test="adminYn == null or adminYn == '' ">
					AND B.DeletedDate IS NULL
				</if>
				AND A.ReceiptType = 'P'
				AND A.ReceiptID = #{userID}
				AND A.DataState != 'D'
				<if test="companyCode != null and companyCode != '' ">
					AND B.EntCode = #{companyCode}
				</if>
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) TCInfoList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		RegDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND RegDate <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND RegDate <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND RegDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("FormName")'>FormName</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 참조/회람함 그룹별 목록 조회 -->
	<select id="selectStoreTCInfoGroupList" parameterType="cmap" resultType="cmap">
			SELECT 
         		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>TCInfoList."Date" </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>TCInfoList.InitiatorID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>TCInfoList.InitiatorUnitID </when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>TCInfoList.InitiatorUnitName </when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>TCInfoList.FormPrefix </when>
					<when test='searchGroupType.equalsIgnoreCase("FormName")'>TCInfoList.FormName </when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>TCInfoList.SubKind </when>
         		</choose>
			AS "fieldID"
			, COUNT(1) AS "fieldCnt"
		<if test="searchGroupType == 'Date'">
	        , TCInfoList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix' or searchGroupType == 'FormName'">
	        , TCInfoList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	        , TCInfoList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID' or searchGroupType == 'InitiatorUnitName'">
	        , TCInfoList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	        , TCInfoList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT 	  A.*
						, A.kind AS SubKind
						, B.InitiatorID
						, P.InitiatorName
						, B.InitiatorUnitID
						, P.InitiatorUnitName
						, B.FormID
						, C.FormPrefix
						, B.BodyContextOrg
						<choose>
							<when test="searchGroupType == 'Date'">
								, TO_CHAR(A.RegDate,'YYYY-MM-DD') AS "Date"
							</when>
							<otherwise>
								, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, A.RegDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
							</otherwise>
						</choose>
						, C.FormID AS BoxFormID
						, F.FormName
						, C.FormSubject
						, C.IsSecureDoc
						, C.IsFile
						, C.FileExt
						, C.IsComment
						, C.ApproverCode
						, C.ApproverName
						, C.ApprovalStep
						, C.ApproverSIPAddress
						, C.IsReserved
						, C.ReservedGubun
						, C.ReservedTime
						, C.Priority
						, C.IsModify
						, C.Reserved1
						, C.Reserved2
						, F.ExtInfo
				FROM JWF_CIRCULATIONBOXARCHIVE A
				INNER JOIN JWF_FORMINSTANCEARCHIVE B ON A.FORMINSTID = B.FORMINSTID
				INNER JOIN JWF_CIRCULATIONBOXDESCARCHIVE C ON A.CIRCULATIONBOXDESCRIPTIONID = C.CIRCULATIONBOXDESCRIPTIONID
				LEFT OUTER JOIN JWF_Forms F ON B.FormID = F.FormID
				INNER JOIN JWF_PROCESSDESCRIPTIONARCHIVE D ON B.FORMINSTID = D.FORMINSTID
				INNER JOIN JWF_PROCESSARCHIVE P ON D.PROCESSDESCRIPTIONARCHIVEID = P.PROCESSDESCRIPTIONARCHIVEID AND P.ParentProcessID = 0
				WHERE A.State = 'C'
				AND B.DeletedDate IS NULL
				AND A.ReceiptType = 'P'
				AND A.ReceiptID = #{userID}
				AND A.DataState != 'D'
				<if test="companyCode != null and companyCode != '' ">
					AND B.EntCode = #{companyCode}
				</if>
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) TCInfoList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		"Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND "Date" <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND "Date" <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
           		<choose>
					<when test='searchGroupType.equalsIgnoreCase("Date")'>TCInfoList."Date"</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>TCInfoList.InitiatorID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>TCInfoList.InitiatorUnitID</when>
					<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>TCInfoList.InitiatorUnitName</when>
					<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>TCInfoList.FormPrefix</when>
					<when test='searchGroupType.equalsIgnoreCase("FormName")'>TCInfoList.FormName</when>
					<when test='searchGroupType.equalsIgnoreCase("SubKind")'>TCInfoList.SubKind </when>
           		</choose>
			 	<if test="searchGroupType != 'Date'">
			 		<if test="searchGroupType == 'FormPrefix'">
				        , TCInfoList.FormName
				    </if>
				     <if test="searchGroupType == 'InitiatorID'">
				        , TCInfoList.InitiatorName
				    </if>
				     <if test="searchGroupType == 'InitiatorUnitID'">
				        , TCInfoList.InitiatorUnitName
				    </if>
			 	</if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 참조함 엑셀 데이터 조회 -->
	<select id="selectStoreTCInfoListExcel" parameterType="cmap" resultType="cmap">
		SELECT
			SubKind AS "SubKind"
			, FormName AS "FormName"
			, FormSubject AS "FormSubject"
			, InitiatorUnitName AS "InitiatorUnitName"
			, InitiatorName AS "InitiatorName"
			, TO_CHAR(RegDate, 'YYYY-MM-DD HH24:MI:SS') AS "RegDate"
			, BusinessData3 AS "BusinessData3"
			, BusinessData4 AS "BusinessData4"
			, BusinessData5 AS "BusinessData5"
			, SubUserName AS "SubUserName"
		FROM (
			SELECT A.CirculationBoxID
				, A.ProcessID
				, A.CirculationBoxDescriptionID
				, A.FormInstID
				, A.ReceiptID
				, A.ReceiptType
				, A.ReceiptName
				, A.ReceiptDate AS ReceiptDate
				, A.Kind
				, A.State
				, A.ReadDate AS ReadDate
				, A.SenderID
				, A.SenderName
				, A.Subject
				, A.Comment_ AS "Comment"
				, A.DataState
				, A.RegID
				, A.RegDate AS RegDate
				, A.ModID
				, A.ModDate AS ModDate
				, A.kind AS FormSubKind
				, A.kind AS SubKind
				, B.InitiatorID
				, P.InitiatorName
				, B.InitiatorUnitID
				, P.InitiatorUnitName
				, B.InitiatedDate AS InitiatedDate
				, B.BodyContextOrg
				, C.FormID
				, F.FormName
				, C.FormPrefix
				, C.FormSubject
				, C.IsSecureDoc
				, C.IsFile
				, C.FileExt
				, C.IsComment
				, C.ApproverCode
				, C.ApproverName
				, C.ApprovalStep
				, C.ApproverSIPAddress
				, C.IsReserved
				, C.ReservedGubun
				, C.ReservedTime
				, C.Priority
				, C.IsModify
				, C.Reserved1
				, F.ExtInfo
				,D.BusinessData3
				,D.BusinessData4
				,D.BusinessData5
				,Fn_SplitString_r(D.businessdata5, '^^^', 2) as SubUserName
			FROM JWF_CIRCULATIONBOXARCHIVE A
			INNER JOIN JWF_FORMINSTANCEARCHIVE B ON A.FORMINSTID = B.FORMINSTID
			INNER JOIN JWF_CIRCULATIONBOXDESCARCHIVE C ON A.CIRCULATIONBOXDESCRIPTIONID = C.CIRCULATIONBOXDESCRIPTIONID
			LEFT OUTER JOIN JWF_Forms F ON B.FormID = F.FormID
			INNER JOIN JWF_PROCESSDESCRIPTIONARCHIVE D ON B.FORMINSTID = D.FORMINSTID
			INNER JOIN JWF_PROCESSARCHIVE P ON D.PROCESSDESCRIPTIONARCHIVEID = P.PROCESSDESCRIPTIONARCHIVEID AND P.ParentProcessID = 0
			WHERE A.State = 'C'
			AND B.DeletedDate IS NULL
			AND A.ReceiptType = 'P'
			AND A.ReceiptID = #{userID}
			AND A.DataState != 'D'
			<if test="companyCode != null and companyCode != '' ">
				AND B.EntCode = #{companyCode}
			</if>			
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (D.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR D.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND D.BusinessData1 = #{businessData1}
				</when>
			</choose>
		) TCInfoList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		RegDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND RegDate <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND RegDate <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND RegDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                	AND 
	            		<choose>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID</when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix</when>
							<when test='searchGroupType.equalsIgnoreCase("FormName")'>FormName</when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
	            		</choose>
	            		= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , RegDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	, 
	    		<choose>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<otherwise> RegDate</otherwise>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>
	
	<!-- 문서분류함 목록 데이터 -->
	<select id="selectDocTypeList" parameterType="cmap" resultType="cmap">
		<include refid="oracle.include.pagingHeader"/>
		SELECT ProcessID AS "ProcessID" 
			, ProcessDescriptionID AS "ProcessDescriptionID"		
		    , BusinessData1 AS "BusinessData1"
		    , BusinessData2 AS "BusinessData2"
		    , BusinessData3 AS "BusinessData3"
		    , BusinessData4 AS "BusinessData4"
		    , BusinessData5 AS "BusinessData5"
		    , BusinessData6 AS "BusinessData6"
		    , BusinessData7 AS "BusinessData7"
		    , BusinessData8 AS "BusinessData8"
		    , BusinessData9 AS "BusinessData9"
		    , BusinessData10 AS "BusinessData10"
			, FormInstID AS "FormInstID"
			, FormID AS "FormID"
			, FormPrefix AS "FormPrefix"
			, FormName AS "FormName"
			, FormSubject AS "FormSubject"
			, IsSecureDoc AS "IsSecureDoc"
			, IsFile AS "IsFile"
			, FileExt AS "FileExt"
			, IsComment AS "IsComment"
			, DocNo AS "DocNo"
			, ApproverCode AS "ApproverCode"
			, ApproverName AS "ApproverName"
			, ApprovalStep AS "ApprovalStep"
			, ApproverSIPAddress AS "ApproverSIPAddress"
			, IsReserved AS "IsReserved"
			, ReservedGubun AS "ReservedGubun"
			, ReservedTime AS "ReservedTime"
			, Priority AS "Priority"
			, IsModify AS "IsModify"
			, Reserved1 AS "Reserved1"
			, Reserved2 AS "Reserved2"
			, InitiatorID AS "InitiatorID"
			, InitiatorName AS "InitiatorName"
			, InitiatorUnitID AS "InitiatorUnitID"
			, InitiatorUnitName AS "InitiatorUnitName"
			, EndDate AS "EndDate" 
		FROM (
			SELECT DISTINCT P.ProcessID
				, PD.*
				, P.InitiatorName
				, P.InitiatorID
				, P.InitiatorUnitID
				, P.InitiatorUnitName
				, P.EndDate 
			FROM jwf_forminstance FI
			INNER JOIN jwf_process P ON FI.FormInstID = P.FormInstID 
			INNER JOIN JWF_ProcessDescription PD ON P.ProcessDescriptionID = PD.ProcessDescriptionID 
			INNER JOIN jwf_workitem WI ON P.ProcessID = WI.ProcessID
			WHERE FI.DocClassID = #{docClassID}
			AND WI.Deleted IS NULL
			AND WI.PIDeleted IS NULL
			AND (
				(
					(WI.UserCode = #{userID} OR WI.DeputyID = #{userID})
					AND WI.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021')
					AND WI.PIBusinessState = '02_01'
				)
				OR (
					WI.UserCode = #{deptID}
					AND (WI.SubKind = 'A' OR (WI.SubKind IN ('REQCMP', 'AA') AND P.BusinessState LIKE '02_01%'))
					AND FI.FormInstID NOT IN (
						SELECT FI.FormInstID 
						FROM jwf_forminstance FI
						INNER JOIN jwf_process P ON FI.FormInstID = P.FormInstID 
						INNER JOIN jwf_workitem WI ON P.ProcessID = WI.ProcessID 
						WHERE FI.DocClassID = #{docClassID}
						AND WI.Deleted IS NULL
						AND WI.PIDeleted IS NULL
						AND (WI.UserCode = #{userID} OR WI.DeputyID = #{userID})
						AND WI.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021')
						AND WI.PIBusinessState = '02_01'
					)
				)
			)
		) DocTypeList
     	<!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    , 
    		<choose>
				<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
				<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
				<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
				<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
				<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
				<otherwise>EndDate</otherwise>
			</choose>
			<choose>
				<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
				<otherwise> DESC</otherwise>
			</choose>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>
	
	<select id="selectDocTypeListCnt" resultType="java.lang.Long">
		SELECT COUNT(*) FROM (
			SELECT DISTINCT P.ProcessID
				, PD.*
				, P.InitiatorName
				, P.InitiatorID
				, P.InitiatorUnitID
				, P.InitiatorUnitName
				, P.EndDate 
			FROM jwf_forminstance FI
			INNER JOIN jwf_process P ON FI.FormInstID = P.FormInstID 
			INNER JOIN JWF_ProcessDescription PD ON P.ProcessDescriptionID = PD.ProcessDescriptionID 
			INNER JOIN jwf_workitem WI ON P.ProcessID = WI.ProcessID
			WHERE FI.DocClassID = #{docClassID}
			AND WI.Deleted IS NULL
			AND WI.PIDeleted IS NULL
			AND (
				(
					(WI.UserCode = #{userID} OR WI.DeputyID = #{userID})
					AND WI.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021')
					AND WI.PIBusinessState = '02_01'
				)
				OR (
					WI.UserCode = #{deptID}
					AND (WI.SubKind = 'A' OR (WI.SubKind IN ('REQCMP', 'AA') AND P.BusinessState LIKE '02_01%'))
					AND FI.FormInstID NOT IN (
						SELECT FI.FormInstID 
						FROM jwf_forminstance FI
						INNER JOIN jwf_process P ON FI.FormInstID = P.FormInstID 
						INNER JOIN jwf_workitem WI ON P.ProcessID = WI.ProcessID 
						WHERE FI.DocClassID = #{docClassID}
						AND WI.Deleted IS NULL
						AND WI.PIDeleted IS NULL
						AND (WI.UserCode = #{userID} OR WI.DeputyID = #{userID})
						AND WI.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021')
						AND WI.PIBusinessState = '02_01'
					)
				)
			)
		) DocTypeList
     	<!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
		</trim>
	</select>
	
	<!-- 문서분류함 엑셀 데이터 조회 -->
	<select id="selectDocTypeListExcel" parameterType="cmap" resultType="cmap">
		SELECT ProcessID AS "ProcessID" 
			, ProcessDescriptionID AS "ProcessDescriptionID"		
		    , BusinessData1 AS "BusinessData1"
		    , BusinessData2 AS "BusinessData2"
		    , BusinessData3 AS "BusinessData3"
		    , BusinessData4 AS "BusinessData4"
		    , BusinessData5 AS "BusinessData5"
		    , BusinessData6 AS "BusinessData6"
		    , BusinessData7 AS "BusinessData7"
		    , BusinessData8 AS "BusinessData8"
		    , BusinessData9 AS "BusinessData9"
		    , BusinessData10 AS "BusinessData10"
			, FormInstID AS "FormInstID"
			, FormID AS "FormID"
			, FormPrefix AS "FormPrefix"
			, FormName AS "FormName"
			, FormSubject AS "FormSubject"
			, IsSecureDoc AS "IsSecureDoc"
			, IsFile AS "IsFile"
			, FileExt AS "FileExt"
			, IsComment AS "IsComment"
			, DocNo AS "DocNo"
			, ApproverCode AS "ApproverCode"
			, ApproverName AS "ApproverName"
			, ApprovalStep AS "ApprovalStep"
			, ApproverSIPAddress AS "ApproverSIPAddress"
			, IsReserved AS "IsReserved"
			, ReservedGubun AS "ReservedGubun"
			, ReservedTime AS "ReservedTime"
			, Priority AS "Priority"
			, IsModify AS "IsModify"
			, Reserved1 AS "Reserved1"
			, Reserved2 AS "Reserved2"
			, InitiatorID AS "InitiatorID"
			, InitiatorName AS "InitiatorName"
			, InitiatorUnitID AS "InitiatorUnitID"
			, InitiatorUnitName AS "InitiatorUnitName"
			, EndDate AS "EndDate" 
		FROM (
			SELECT DISTINCT P.ProcessID
				, PD.*
				, P.InitiatorName
				, P.InitiatorID
				, P.InitiatorUnitID
				, P.InitiatorUnitName
				, P.EndDate 
			FROM jwf_forminstance FI
			INNER JOIN jwf_process P ON FI.FormInstID = P.FormInstID 
			INNER JOIN JWF_ProcessDescription PD ON P.ProcessDescriptionID = PD.ProcessDescriptionID 
			INNER JOIN jwf_workitem WI ON P.ProcessID = WI.ProcessID
			WHERE FI.DocClassID = #{docClassID}
			AND WI.Deleted IS NULL
			AND WI.PIDeleted IS NULL
			AND (
				(
					(WI.UserCode = #{userID} OR WI.DeputyID = #{userID})
					AND WI.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021')
					AND WI.PIBusinessState = '02_01'
				)
				OR (
					WI.UserCode = #{deptID}
					AND (WI.SubKind = 'A' OR (WI.SubKind IN ('REQCMP', 'AA') AND P.BusinessState LIKE '02_01%'))
					AND FI.FormInstID NOT IN (
						SELECT FI.FormInstID 
						FROM jwf_forminstance FI
						INNER JOIN jwf_process P ON FI.FormInstID = P.FormInstID 
						INNER JOIN jwf_workitem WI ON P.ProcessID = WI.ProcessID 
						WHERE FI.DocClassID = #{docClassID}
						AND WI.Deleted IS NULL
						AND WI.PIDeleted IS NULL
						AND (WI.UserCode = #{userID} OR WI.DeputyID = #{userID})
						AND WI.SubKind IN ('T000','T004','T005','T006','T009','T011','T016','T017','T018','T019','T020','T021')
						AND WI.PIBusinessState = '02_01'
					)
				)
			)
		) DocTypeList
     	<!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
	    		AND 
	    		<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		   , 
    		<choose>
				<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
				<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
				<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
				<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
				<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
				<otherwise>EndDate</otherwise>
			</choose>
			<choose>
				<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
				<otherwise> DESC</otherwise>
			</choose>
		</trim>
	</select>
</mapper>