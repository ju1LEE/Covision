<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://www.mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="user.deptapprovalList">
    <!-- 완료함 목록 데이터 -->
	<select id="selectDeptDraftCompleteList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessArchiveID AS "ProcessArchiveID"
				, PerformerID AS "PerformerID"
				, WorkitemArchiveID AS "WorkitemArchiveID"
				, SubKind AS "SubKind"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, FormPrefix AS "FormPrefix"
				, ProcessDescriptionArchiveID AS "ProcessDescriptionArchiveID"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, DocNo AS "DocNo"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, InitiatorName AS "InitiatorName"
				, InitiatorID AS "InitiatorID"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, EndDate AS "EndDate"
				, PhotoPath AS "PhotoPath"
				, BusinessData1 AS "BusinessData1"
				, BusinessData2 AS "BusinessData2"
				, BusinessData3 AS "BusinessData3"
				, BusinessData4 AS "BusinessData4"
				, BusinessData5 AS "BusinessData5"
				, BusinessData6 AS "BusinessData6"
				, BusinessData7 AS "BusinessData7"
				, BusinessData8 AS "BusinessData8"
				, BusinessData9 AS "BusinessData9"
				, BusinessData10 AS "BusinessData10"
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
				, BodyContextOrg "BodyContextOrg"
				</if>
			FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkItemID AS WorkitemArchiveID
					, A.SubKind
					, A.UserCode
					, A.UserName
					, C.ProcessDescriptionID AS ProcessDescriptionArchiveID
					, C.FormInstID, C.FormID, C.FormPrefix, C.FormName, C.FormSubject, C.IsSecureDoc, C.IsFile, C.FileExt, C.IsComment, C.ApproverCode, C.ApproverName, C.ApprovalStep, C.ApproverSIPAddress, C.IsReserved, C.ReservedGubun, C.ReservedTime, C.Priority, C.IsModify
					, C.Reserved1, C.Reserved2, C.BusinessData1, C.BusinessData2, C.BusinessData3, C.BusinessData4, C.BusinessData5, C.BusinessData6, C.BusinessData7, C.BusinessData8, C.BusinessData9, C.BusinessData10, C.DocNo
					, B.InitiatorName
					, B.InitiatorID
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, B.endDate AS EndDate
					, U.PhotoPath
					, F.ExtInfo
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
				LEFT OUTER JOIN JWF_Forms F ON C.FormID = F.FormID 
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND B.ProcessState = 528
				AND A.SubKind = 'A'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptDraftCompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 완료함 목록 개수 데이터 -->
	<select id="selectDeptDraftCompleteListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
		    SELECT DeptDraftCompleteList.* FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkItemID AS WorkitemArchiveID
					, A.SubKind
					, A.UserCode
					, A.UserName
					, C.ProcessDescriptionID AS ProcessDescriptionArchiveID
					, C.FormInstID, C.FormID, C.FormPrefix, C.FormName, C.FormSubject, C.IsSecureDoc, C.IsFile, C.FileExt, C.IsComment, C.ApproverCode, C.ApproverName, C.ApprovalStep, C.ApproverSIPAddress, C.IsReserved, C.ReservedGubun, C.ReservedTime, C.Priority, C.IsModify
					, C.Reserved1, C.Reserved2, C.BusinessData1, C.BusinessData2, C.BusinessData3, C.BusinessData4, C.BusinessData5, C.BusinessData6, C.BusinessData7, C.BusinessData8, C.BusinessData9, C.BusinessData10, C.DocNo
					, B.InitiatorName
					, B.InitiatorID
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, B.endDate AS EndDate
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
					FROM JWF_Workitem A
					INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
					INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID					
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND B.ProcessState = 528
				AND A.SubKind = 'A'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptDraftCompleteList
		    <!-- 검색 데이터 Where 절 -->
		    <trim prefix="WHERE" prefixOverrides="AND |OR ">
			  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  		endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			  	</if>
			  	<if test="viewStartDate != null and viewStartDate != '' ">
					AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
				</if>
				<if test="viewEndDate != null and viewEndDate != '' ">
					AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
				</if>
				<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND 
					<choose>
						<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
						<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
						<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
						<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
						<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
						<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
						<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
					</choose> 
					LIKE '%' || #{searchWord} || '%'
				</if>
				<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND (
						FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
						InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
						InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
					)
				</if>
				<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
					<choose>
		                <when test="searchGroupType == 'Date' ">
		                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
		                </when>
		                <otherwise>
		                     AND 
		                    <choose>
								<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
								<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
							</choose> 
							= #{searchGroupWord}
		                </otherwise>
		            </choose>
				</if>
				<if test="userNm != null and userNm !=''">
					AND InitiatorName LIKE '%' || #{userNm} || '%'
				</if>
				<if test="titleNm != null and titleNm !=''">
					AND FormSubject LIKE '%' || #{titleNm} || '%'
				</if>
			</trim>
		) A
	</select>

	<!-- 완료함 그룹별 목록 조회 -->
	<select id="selectDeptDraftCompleteGroupList" parameterType="cmap" resultType="cmap">
		<if test="searchGroupType == 'Date'">
		    SELECT DeptDraftCompleteList."Date" AS "fieldID"
			, COUNT(DeptDraftCompleteList."Date") AS "fieldCnt"
	        , DeptDraftCompleteList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	    	SELECT DeptDraftCompleteList.FormPrefix AS "fieldID"
			, COUNT(DeptDraftCompleteList.FormPrefix) AS "fieldCnt"
	        , DeptDraftCompleteList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	     	SELECT DeptDraftCompleteList.InitiatorID AS "fieldID"
			, COUNT(DeptDraftCompleteList.InitiatorID) AS "fieldCnt"
	        , DeptDraftCompleteList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	     	SELECT DeptDraftCompleteList.InitiatorUnitID AS "fieldID"
			, COUNT(DeptDraftCompleteList.InitiatorUnitID) AS "fieldCnt"
	        , DeptDraftCompleteList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	     	SELECT DeptDraftCompleteList.SubKind AS "fieldID"
			, COUNT(DeptDraftCompleteList.SubKind) AS "fieldCnt"
	        , DeptDraftCompleteList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkItemID AS WorkitemArchiveID
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.endDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(B.endDate,'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
					, C.*
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID					 
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND B.ProcessState = 528
				AND A.SubKind = 'A'
				AND A.Deleted IS NULL
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptDraftCompleteList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    "Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND "Date" <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND "Date" <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
		  	    <if test="searchGroupType == 'Date'">
			 		DeptDraftCompleteList."Date"
			 	</if>
		 	    <if test="searchGroupType == 'FormPrefix'">
		 	    	DeptDraftCompleteList.FormPrefix
			        , DeptDraftCompleteList.FormName
			    </if>
			     <if test="searchGroupType == 'InitiatorID'">
			     	DeptDraftCompleteList.InitiatorID
			        , DeptDraftCompleteList.InitiatorName
			    </if>
			     <if test="searchGroupType == 'InitiatorUnitID'">
			     	DeptDraftCompleteList.InitiatorUnitID
			        , DeptDraftCompleteList.InitiatorUnitName
			    </if>
			     <if test="searchGroupType == 'SubKind'">
			     	DeptDraftCompleteList.SubKind
			    </if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 완료함 엑셀 데이터 조회 -->
	<select id="selectDeptDraftCompleteListExcel" parameterType="cmap" resultType="cmap">
			SELECT
				SubKind AS "SubKind"
				, FormSubject AS "FormSubject"
				, InitiatorUnitName AS "InitiatorUnitName"
				, InitiatorName AS "InitiatorName"
				, IsFile AS "IsFile"
				, FormName AS "FormName"
				, DocNo AS "DocNo"
				, TO_CHAR(EndDate, 'YYYY-MM-DD HH24:MI:SS') AS "EndDate"
			FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkItemID AS WorkitemArchiveID
					, A.SubKind
					, A.UserCode
					, A.UserName
					, C.*
					, B.InitiatorName
					, B.InitiatorID
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, B.EndDate AS EndDate
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND B.ProcessState = 528
				AND A.SubKind = 'A'
				AND A.Deleted IS NULL
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptDraftCompleteList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	   endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose>
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>

    <!-- 발신함 목록 데이터 -->
    <select id="selectDeptSenderCompleteList" parameterType="cmap" resultType="cmap">
        <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessArchiveID AS "ProcessArchiveID"
				, PerformerID AS "PerformerID"
				, WorkitemArchiveID AS "WorkitemArchiveID"
				, SubKind AS "SubKind"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, FormPrefix AS "FormPrefix"
				, ProcessDescriptionArchiveID AS "ProcessDescriptionArchiveID"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, DocNo AS "DocNo"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, InitiatorName AS "InitiatorName"
				, InitiatorID AS "InitiatorID"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, EndDate AS "EndDate"
				, PhotoPath AS "PhotoPath"
				, BusinessData1 AS "BusinessData1"
				, BusinessData2 AS "BusinessData2"
				, BusinessData3 AS "BusinessData3"
				, BusinessData4 AS "BusinessData4"
				, BusinessData5 AS "BusinessData5"
				, BusinessData6 AS "BusinessData6"
				, BusinessData7 AS "BusinessData7"
				, BusinessData8 AS "BusinessData8"
				, BusinessData9 AS "BusinessData9"
				, BusinessData10 AS "BusinessData10"
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
				, BodyContextOrg AS "BodyContextOrg"
				</if>
			FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkItemID AS WorkitemArchiveID
					, A.SubKind
					, A.UserCode
					, A.UserName
					, C.ProcessDescriptionID AS ProcessDescriptionArchiveID
					, C.FormInstID, C.FormID, C.FormPrefix, C.FormName, C.FormSubject, C.IsSecureDoc, C.IsFile, C.FileExt, C.IsComment, C.ApproverCode, C.ApproverName, C.ApprovalStep, C.ApproverSIPAddress, C.IsReserved, C.ReservedGubun, C.ReservedTime, C.Priority, C.IsModify
					, C.Reserved1, C.Reserved2, C.BusinessData1, C.BusinessData2, C.BusinessData3, C.BusinessData4, C.BusinessData5, C.BusinessData6, C.BusinessData7, C.BusinessData8, C.BusinessData9, C.BusinessData10, C.DocNo
					, B.InitiatorName
					, B.InitiatorID
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, B.endDate AS EndDate
					, U.PhotoPath
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND B.ProcessState = 528
				AND A.SubKind = 'S'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptSenderCompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		 <include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 발신함 목록 개수 데이터 -->
	<select id="selectDeptSenderCompleteListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
		    SELECT DeptSenderCompleteList.* FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkItemID AS WorkitemArchiveID
					, A.SubKind
					, A.UserCode
					, A.UserName
					, C.ProcessDescriptionID AS ProcessDescriptionArchiveID
					, C.FormInstID, C.FormID, C.FormPrefix, C.FormName, C.FormSubject, C.IsSecureDoc, C.IsFile, C.FileExt, C.IsComment, C.ApproverCode, C.ApproverName, C.ApprovalStep, C.ApproverSIPAddress, C.IsReserved, C.ReservedGubun, C.ReservedTime, C.Priority, C.IsModify
					, C.Reserved1, C.Reserved2, C.BusinessData1, C.BusinessData2, C.BusinessData3, C.BusinessData4, C.BusinessData5, C.BusinessData6, C.BusinessData7, C.BusinessData8, C.BusinessData9, C.BusinessData10, C.DocNo
					, B.InitiatorName
					, B.InitiatorID
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, B.endDate AS EndDate
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND B.ProcessState = 528
				AND A.SubKind = 'S'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptSenderCompleteList
		    <!-- 검색 데이터 Where 절 -->
		    <trim prefix="WHERE" prefixOverrides="AND |OR ">
			  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	    endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			  	</if>
			  	<if test="viewStartDate != null and viewStartDate != '' ">
					AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
				</if>
				<if test="viewEndDate != null and viewEndDate != '' ">
					AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
				</if>
				<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND 
						<choose>
							<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
							<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
							<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
							<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
							<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
							<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
							<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
						</choose> 
						LIKE '%' || #{searchWord} || '%'
				</if>
				<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND (
						FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
						InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
						InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
					)
				</if>
				<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
					<choose>
		                <when test="searchGroupType == 'Date' ">
		                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
		                </when>
		                <otherwise>
		                    AND 
		                    <choose>
								<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
								<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
							</choose> 
							= #{searchGroupWord}
		                </otherwise>
		            </choose>
				</if>
				<if test="userNm != null and userNm !=''">
					AND InitiatorName LIKE '%' || #{userNm} || '%'
				</if>
				<if test="titleNm != null and titleNm !=''">
					AND FormSubject LIKE '%' || #{titleNm} || '%'
				</if>
			</trim>
		) A
	</select>

	<!-- 발신함 그룹별 목록 조회 -->
	<select id="selectDeptSenderCompleteGroupList" parameterType="cmap" resultType="cmap">
		<if test="searchGroupType == 'Date'">
		    SELECT DeptSenderCompleteList."Date" AS "fieldID"
			, COUNT(DeptSenderCompleteList."Date") AS "fieldCnt"
	        , DeptSenderCompleteList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	    	SELECT DeptSenderCompleteList.FormPrefix AS "fieldID"
			, COUNT(DeptSenderCompleteList.FormPrefix) AS "fieldCnt"
	        , DeptSenderCompleteList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	     	SELECT DeptSenderCompleteList.InitiatorID AS "fieldID"
			, COUNT(DeptSenderCompleteList.InitiatorID) AS "fieldCnt"
	        , DeptSenderCompleteList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	     	SELECT DeptSenderCompleteList.InitiatorUnitID AS "fieldID"
			, COUNT(DeptSenderCompleteList.InitiatorUnitID) AS "fieldCnt"
	        , DeptSenderCompleteList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	     	SELECT DeptSenderCompleteList.SubKind AS "fieldID"
			, COUNT(DeptSenderCompleteList.SubKind) AS "fieldCnt"
	        , DeptSenderCompleteList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkItemID AS WorkitemArchiveID
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, C.*
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.endDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(B.endDate,'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND B.ProcessState = 528
				AND A.SubKind = 'S'
				AND A.Deleted IS NULL
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptSenderCompleteList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    "Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND "Date" <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND "Date" <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
		  	    <if test="searchGroupType == 'Date'">
			 		DeptSenderCompleteList."Date"
			 	</if>
		 		<if test="searchGroupType == 'FormPrefix'">
		 			DeptSenderCompleteList.FormPrefix
			        , DeptSenderCompleteList.FormName
			    </if>
			     <if test="searchGroupType == 'InitiatorID'">
			     	DeptSenderCompleteList.InitiatorID
			        , DeptSenderCompleteList.InitiatorName
			    </if>
			     <if test="searchGroupType == 'InitiatorUnitID'">
			     	DeptSenderCompleteList.InitiatorUnitID
			        , DeptSenderCompleteList.InitiatorUnitName
			    </if>
			     <if test="searchGroupType == 'SubKind'">
			     	DeptSenderCompleteList.SubKind
			    </if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 발신함 엑셀 데이터 조회 -->
	<select id="selectDeptSenderCompleteListExcel" parameterType="cmap" resultType="cmap">
			SELECT
				SubKind AS "SubKind"
				,FormSubject AS "FormSubject"
				,InitiatorUnitName AS "InitiatorUnitName"
				,InitiatorName AS "InitiatorName"
				,IsFile AS "IsFile"
				,FormName AS "FormName"
				,NVL(DocNo, ' ') AS "DocNo"
				,TO_CHAR(EndDate, 'YYYY-MM-DD HH24:MI:SS') AS "EndDate"
			FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkItemID AS WorkitemArchiveID
					, A.SubKind
					, A.UserCode
					, A.UserName
					, C.*
					, B.InitiatorName
					, B.InitiatorID
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, B.EndDate AS endDate
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND A.SubKind = 'S'
				AND A.Deleted IS NULL
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptSenderCompleteList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	   endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		  	<if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>

	<!-- 수신함 목록 데이터 -->
	<select id="selectDeptReceiveList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessID AS "ProcessID"
				, WorkItemID AS "WorkItemID"
				, PerformerID AS "PerformerID"
				, TaskID AS "TaskID"
				, SubKind AS "SubKind"
				, FormSubKind AS "FormSubKind"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, ProcessDescriptionID AS "ProcessDescriptionID"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormPrefix AS "FormPrefix"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, InitiatorName AS "InitiatorName"
				, InitiatorID AS "InitiatorID"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, "MODE"
				, Created AS "Created"
				, ReadDate AS "ReadDate"
				, ExtInfo AS "ExtInfo"
				, PhotoPath AS "PhotoPath"
				, SchemaContext AS "SchemaContext"
				, BusinessData1 AS "BusinessData1"
				, BusinessData2 AS "BusinessData2"
				, BusinessData3 AS "BusinessData3"
				, BusinessData4 AS "BusinessData4"
				, BusinessData5 AS "BusinessData5"
				, BusinessData6 AS "BusinessData6"
				, BusinessData7 AS "BusinessData7"
				, BusinessData8 AS "BusinessData8"
				, BusinessData9 AS "BusinessData9"
				, BusinessData10 AS "BusinessData10"
			FROM (
				SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, B.TaskID
					, C.SubKind
					, C.SubKind AS FormSubKind
					, C.UserCode
					, C.UserName
					, D.*
					, A.InitiatorName
					, A.InitiatorID
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, CASE B.State WHEN 288 THEN 'REDRAFT' ELSE 'COMPLETE' END AS "MODE"
					, TO_CHAR(B.Created, 'YYYY-MM-DD HH24:MI:SS') AS Created
					, TO_CHAR(R.ReadDate, 'YYYY-MM-DD HH24:MI:SS') AS ReadDate
					, F.ExtInfo
					, U.PhotoPath
					, NVL(JF.SchemaContext, '') as SchemaContext
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				LEFT OUTER JOIN jwf_docreadhistory R ON A.ProcessID = R.ProcessID AND R.UserID = #{userID} AND R.AdminYN = 'N' AND R.FormInstID > 0
				LEFT OUTER JOIN JWF_Forms F ON D.FormID = F.FormID
				LEFT OUTER JOIN jwf_formsschema JF ON F.SchemaID = JF.SchemaID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.InitiatorID
				WHERE C.UserCode = #{deptID}
				AND C.SubKind IN ('R', 'C', 'AD', 'AS', 'AE')
				AND C.State = 1
				AND B.State = 288
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptReceiveList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    Created BETWEEN #{startDate} AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
		  	 </if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND Created BETWEEN #{searchGroupWord} AND TO_CHAR(TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY"  prefixOverrides =",">
		    <if test ="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
			    , Priority DESC 
		    </if>
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , Created Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
					<when test='sortColumn.equalsIgnoreCase("Created")'>Created</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 수신함 목록 개수 데이터 -->
	<select id="selectDeptReceiveListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
	    	SELECT DeptReceiveList.* FROM (
				SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, B.TaskID
					, C.SubKind
					, C.SubKind AS FormSubKind
					, C.UserCode
					, C.UserName
					, D.*
					, A.InitiatorName
					, A.InitiatorID
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, CASE B.State WHEN 288 THEN 'REDRAFT' ELSE 'COMPLETE' END AS "MODE"
					, TO_CHAR(B.Created, 'YYYY-MM-DD HH24:MI:SS') AS Created
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				WHERE C.UserCode = #{deptID}
				AND C.SubKind IN ('R', 'C', 'AD', 'AS', 'AE')
				AND C.State = 1
				AND B.State = 288
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptReceiveList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    Created BETWEEN #{startDate} AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
		  	 </if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND Created BETWEEN #{searchGroupWord} AND TO_CHAR(TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 수신함 그룹별 목록 조회 -->
	<select id="selectDeptReceiveGroupList" parameterType="cmap" resultType="cmap">
		<if test="searchGroupType == 'Date'">
		    SELECT DeptReceiveList."Date" AS "fieldID"
			, COUNT(DeptReceiveList."Date") AS "fieldCnt"
	        , DeptReceiveList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	    	SELECT DeptReceiveList.FormPrefix AS "fieldID"
			, COUNT(DeptReceiveList.FormPrefix) AS "fieldCnt"
	        , DeptReceiveList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
			SELECT DeptReceiveList.InitiatorID AS "fieldID"
			, COUNT(DeptReceiveList.InitiatorID) AS "fieldCnt"	     
	        , DeptReceiveList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	     	SELECT DeptReceiveList.InitiatorUnitID AS "fieldID"
			, COUNT(DeptReceiveList.InitiatorUnitID) AS "fieldCnt"
	        , DeptReceiveList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	     	SELECT DeptReceiveList.SubKind AS "fieldID"
			, COUNT(DeptReceiveList.SubKind) AS "fieldCnt"
	        , DeptReceiveList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT A.ProcessID
						, B.WorkItemID
						, C.PerformerID
						, A.InitiatorID
						, A.InitiatorName
						, A.InitiatorUnitID
						, A.InitiatorUnitName
						, C.UserCode
						, C.UserName
						, C.SubKind
						, D.FormSubject as Subject
						, D.*
						<choose>
							<when test="searchGroupType == 'Date'">
								, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.Created), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
							</when>
							<otherwise>
								, TO_CHAR(B.Created,'YYYY-MM-DD') AS "Date"
							</otherwise>
						</choose>
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				WHERE C.UserCode = #{deptID}
				AND C.SubKind IN ('R', 'C', 'AD', 'AS', 'AE')
				AND C.State = 1
				AND B.State = 288
				AND A.ProcessState = 288
				AND A.DeleteDate IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptReceiveList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    "Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
		  	    <if test="searchGroupType == 'Date'">
			 		DeptReceiveList."Date"
			 	</if>
		 		<if test="searchGroupType == 'FormPrefix'">
		 			DeptReceiveList.FormPrefix
			        , DeptReceiveList.FormName
			    </if>
			     <if test="searchGroupType == 'InitiatorID'">
			     	DeptReceiveList.InitiatorID
			        , DeptReceiveList.InitiatorName
			    </if>
			     <if test="searchGroupType == 'InitiatorUnitID'">
			     	DeptReceiveList.InitiatorUnitID
			        , DeptReceiveList.InitiatorUnitName
			    </if>
			     <if test="searchGroupType == 'SubKind'">
			     	DeptReceiveList.SubKind
			    </if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 수신함 엑셀 데이터 조회 -->
	<select id="selectDeptReceiveListExcel" parameterType="cmap" resultType="cmap">
		SELECT
			SubKind AS "SubKind"
			, FormSubject AS "FormSubject"
			, InitiatorUnitName AS "InitiatorUnitName"
			, InitiatorName AS "InitiatorName"
			, TO_CHAR(Created, 'YYYY-MM-DD HH24:MI:SS') AS "Created"
			, FormName AS "FormName"
		FROM (
			SELECT A.ProcessID
				, B.WorkItemID
				, C.PerformerID
				, C.SubKind
				, C.UserCode
				, C.UserName
				, D.FormSubject as Subject
				, D.*
				, A.InitiatorName
				, A.InitiatorID
				, A.InitiatorUnitID
				, A.InitiatorUnitName
				, CASE B.State WHEN 288 THEN 'REDRAFT' ELSE 'COMPLETE' END AS "MODE"
				, B.Created AS Created
			FROM JWF_Process A
			INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
			INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
			INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
			WHERE C.UserCode = #{deptID}
			AND C.SubKind IN ('R', 'C', 'AD', 'AS', 'AE')
			AND C.State = 1
			AND B.State = 288
			AND A.ProcessState = 288
			AND A.DeleteDate IS NULL
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (D.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR D.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND D.BusinessData1 = #{businessData1}
				</when>
			</choose>
		) DeptReceiveList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	   Created BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	 </if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND Created BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                     AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY"  prefixOverrides =",">
		    <if test = "sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
				, Priority DESC 
		    </if>
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , Created Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>

	<!-- 수신완료함(수신처리함) 목록 데이터 -->
	<select id="selectDeptReceiveCompleteList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessArchiveID AS "ProcessArchiveID"
				, PerformerID AS "PerformerID"
				, WorkitemArchiveID AS "WorkitemArchiveID"
				, FormPrefix AS "FormPrefix"
				, Subject AS "Subject"
				, ProcessDescriptionArchiveID AS "ProcessDescriptionArchiveID"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, DocNo AS "DocNo"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, InitiatorName AS "InitiatorName"
				, InitiatorID AS "InitiatorID"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, SubKind AS "SubKind"
				, EndDate AS "EndDate"
				, PhotoPath AS "PhotoPath"
				, BusinessData1 AS "BusinessData1"
				, BusinessData2 AS "BusinessData2"
				, BusinessData3 AS "BusinessData3"
				, BusinessData4 AS "BusinessData4"
				, BusinessData5 AS "BusinessData5"
				, BusinessData6 AS "BusinessData6"
				, BusinessData7 AS "BusinessData7"
				, BusinessData8 AS "BusinessData8"
				, BusinessData9 AS "BusinessData9"
				, BusinessData10 AS "BusinessData10"
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
				, BodyContextOrg AS "BodyContextOrg"
				</if>
			FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkItemID AS WorkitemArchiveID
					, C.FormSubject as Subject
					, C.ProcessDescriptionID as ProcessDescriptionArchiveID
					, C.*
					, B.InitiatorName
					, B.InitiatorID
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, B.endDate AS EndDate
					, U.PhotoPath
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND B.ProcessState = 528
				AND A.SubKind IN ('REQCMP', 'AA')
				AND B.BusinessState LIKE '02_01%'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptReceiveCompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		 	<if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 수신완료함(수신처리함) 목록 개수 데이터 -->
	<select id="selectDeptReceiveCompleteListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
	    	SELECT DeptReceiveCompleteList.* FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkItemID AS WorkitemArchiveID
					, C.FormSubject as Subject
					, C.*
					, B.InitiatorName
					, B.InitiatorID
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, B.endDate AS EndDate
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND B.ProcessState = 528
				AND A.SubKind IN ('REQCMP', 'AA')
				AND B.BusinessState LIKE '02_01%'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptReceiveCompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                     AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 수신완료함 그룹별 목록 조회 -->
	<select id="selectDeptReceiveCompleteGroupList" parameterType="cmap" resultType="cmap">
		<if test="searchGroupType == 'Date'">
		    SELECT DeptReceiveCompleteList."Date" AS "fieldID"
			, COUNT(DeptReceiveCompleteList."Date") AS "fieldCnt"
	        , DeptReceiveCompleteList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	    	SELECT DeptReceiveCompleteList.FormPrefix AS "fieldID"
			, COUNT(DeptReceiveCompleteList.FormPrefix) AS "fieldCnt"
	        , DeptReceiveCompleteList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	     	SELECT DeptReceiveCompleteList.InitiatorID AS "fieldID"
			, COUNT(DeptReceiveCompleteList.InitiatorID) AS "fieldCnt"
	        , DeptReceiveCompleteList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	     	SELECT DeptReceiveCompleteList.InitiatorUnitID AS "fieldID"
			, COUNT(DeptReceiveCompleteList.InitiatorUnitID) AS "fieldCnt"
	        , DeptReceiveCompleteList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	     	SELECT DeptReceiveCompleteList.SubKind AS "fieldID"
			, COUNT(DeptReceiveCompleteList.SubKind) AS "fieldCnt"
	        , DeptReceiveCompleteList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT	B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkItemID AS WorkitemArchiveID
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, C.*
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.endDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(B.endDate,'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND B.ProcessState = 528
				AND A.SubKind IN ('REQCMP', 'AA')
				AND B.BusinessState LIKE '02_01%'
				AND A.Deleted IS NULL
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptReceiveCompleteList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    "Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND "Date" <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND "Date" <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
		  	    <if test="searchGroupType == 'Date'">
			 		DeptReceiveCompleteList."Date"
			 	</if>
		 		<if test="searchGroupType == 'FormPrefix'">
		 			DeptReceiveCompleteList.FormPrefix
			        , DeptReceiveCompleteList.FormName
			    </if>
			     <if test="searchGroupType == 'InitiatorID'">
			     	DeptReceiveCompleteList.InitiatorID
			        , DeptReceiveCompleteList.InitiatorName
			    </if>
			     <if test="searchGroupType == 'InitiatorUnitID'">
			     	DeptReceiveCompleteList.InitiatorUnitID
			        , DeptReceiveCompleteList.InitiatorUnitName
			    </if>
			     <if test="searchGroupType == 'SubKind'">
			     	DeptReceiveCompleteList.SubKind
			    </if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 수신완료함(수신처리함) 엑셀 데이터 조회 -->
	<select id="selectDeptReceiveCompleteListExcel" parameterType="cmap" resultType="cmap">
		SELECT
			SubKind AS "SubKind"
			, FormSubject AS "FormSubject"
			, InitiatorUnitName AS "InitiatorUnitName"
			, InitiatorName AS "InitiatorName"
			, IsFile AS "IsFile"
			, FormName AS "FormName"
			, NVL(DocNo, ' ') AS "DocNo"
			, TO_CHAR(EndDate, 'YYYY-MM-DD HH24:MI:SS') AS "EndDate"
		FROM (
			SELECT B.ProcessID AS ProcessArchiveID
				, A.PerformerID
				, A.WorkItemID AS WorkitemArchiveID
				, C.*
				, B.InitiatorName
				, B.InitiatorID
				, B.InitiatorUnitID
				, B.InitiatorUnitName
				, A.UserCode
				, A.UserName
				, A.SubKind
				, B.EndDate AS EndDate
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					, D.BodyContextOrg
				</if>
			FROM JWF_Workitem A
			INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
			INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
			<if test="searchType != null and searchType == 'BodyContextOrg' ">
				INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
			</if>
			WHERE A.UserCode = #{deptID}
			AND B.ProcessState = 528
			AND A.SubKind IN ('REQCMP', 'AA')
			AND B.BusinessState LIKE '02_01%'
			AND A.Deleted IS NULL
			AND A.PIDeleted IS NULL
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (C.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR C.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND C.BusinessData1 = #{businessData1}
				</when>
			</choose>
		) DeptReceiveCompleteList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	   endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		  	<if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>

	<!-- 수신공람함 목록 데이터 -->
	<select id="selectDeptReceiveExhibitList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessArchiveID AS "ProcessArchiveID"
				, PerformerID AS "PerformerID"
				, WorkitemArchiveID AS "WorkitemArchiveID"
				, FormPrefix AS "FormPrefix"
				, Subject AS "Subject"
				, ProcessDescriptionArchiveID AS "ProcessDescriptionArchiveID"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, DocNo AS "DocNo"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, InitiatorName AS "InitiatorName"
				, InitiatorID AS "InitiatorID"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, SubKind AS "SubKind"
				, EndDate AS "EndDate"
				, PhotoPath AS "PhotoPath"
				, BusinessData1 AS "BusinessData1"
				, BusinessData2 AS "BusinessData2"
				, BusinessData3 AS "BusinessData3"
				, BusinessData4 AS "BusinessData4"
				, BusinessData5 AS "BusinessData5"
				, BusinessData6 AS "BusinessData6"
				, BusinessData7 AS "BusinessData7"
				, BusinessData8 AS "BusinessData8"
				, BusinessData9 AS "BusinessData9"
				, BusinessData10 AS "BusinessData10"
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
				, BodyContextOrg AS "BodyContextOrg"
				</if>
			FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkItemID AS WorkitemArchiveID
					, C.FormSubject as Subject
					, C.*
					, B.InitiatorName
					, B.InitiatorID
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, B.endDate AS EndDate
					, U.PhotoPath
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND A.SubKind = 'RE'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptReceiveCompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		 	<if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 수신공람함 목록 개수 데이터 -->
	<select id="selectDeptReceiveExhibitListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
	    	SELECT DeptReceiveCompleteList.* FROM (
				SELECT B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkItemID AS WorkitemArchiveID
					, C.FormSubject as Subject
					, C.*
					, B.InitiatorName
					, B.InitiatorID
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, B.endDate AS EndDate
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND B.ProcessState = 528
				AND A.SubKind = 'RE'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptReceiveCompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	 </if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 수신공람함 그룹별 목록 조회 -->
	<select id="selectDeptReceiveExhibitGroupList" parameterType="cmap" resultType="cmap">
		<if test="searchGroupType == 'Date'">
		    SELECT DeptReceiveCompleteList."Date" AS "fieldID"
			, COUNT(DeptReceiveCompleteList."Date") AS "fieldCnt"
	        , DeptReceiveCompleteList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	    	SELECT DeptReceiveCompleteList.FormPrefix AS "fieldID"
			, COUNT(DeptReceiveCompleteList.FormPrefix) AS "fieldCnt"
	        , DeptReceiveCompleteList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	     	SELECT DeptReceiveCompleteList.InitiatorID AS "fieldID"
			, COUNT(DeptReceiveCompleteList.InitiatorID) AS "fieldCnt"
	        , DeptReceiveCompleteList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	     	SELECT DeptReceiveCompleteList.InitiatorUnitID AS "fieldID"
			, COUNT(DeptReceiveCompleteList.InitiatorUnitID) AS "fieldCnt"
	        , DeptReceiveCompleteList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	     	SELECT DeptReceiveCompleteList.SubKind AS "fieldID"
			, COUNT(DeptReceiveCompleteList.SubKind) AS "fieldCnt"
	        , DeptReceiveCompleteList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT	B.ProcessID AS ProcessArchiveID
					, A.PerformerID
					, A.WorkItemID AS WorkitemArchiveID
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, A.UserCode
					, A.UserName
					, A.SubKind
					, C.*
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.endDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(B.endDate,'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_Workitem A
				INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
				INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND A.SubKind = 'RE'
				AND A.Deleted IS NULL
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptReceiveCompleteList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    "Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
		  	    <if test="searchGroupType == 'Date'">
			 		DeptReceiveCompleteList."Date"
			 	</if>
		 		<if test="searchGroupType == 'FormPrefix'">
		 			DeptReceiveCompleteList.FormPrefix
			        , DeptReceiveCompleteList.FormName
			    </if>
			     <if test="searchGroupType == 'InitiatorID'">
			     	DeptReceiveCompleteList.InitiatorID
			        , DeptReceiveCompleteList.InitiatorName
			    </if>
			     <if test="searchGroupType == 'InitiatorUnitID'">
			     	DeptReceiveCompleteList.InitiatorUnitID
			        , DeptReceiveCompleteList.InitiatorUnitName
			    </if>
			     <if test="searchGroupType == 'SubKind'">
			     	DeptReceiveCompleteList.SubKind
			    </if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 수신공람함 엑셀 데이터 조회 -->
	<select id="selectDeptReceiveExhibitListExcel" parameterType="cmap" resultType="cmap">
		SELECT
			SubKind AS "SubKind"
			, FormSubject AS "FormSubject"
			, InitiatorUnitName AS "InitiatorUnitName"
			, InitiatorName AS "InitiatorName"
			, IsFile AS "IsFile"
			, FormName AS "FormName"
			, NVL(DocNo, ' ') AS "DocNo"
			, TO_CHAR(EndDate, 'YYYY-MM-DD HH24:MI:SS') AS "EndDate"
		FROM (
			SELECT B.ProcessID AS ProcessArchiveID
				, A.PerformerID
				, A.WorkItemID AS WorkitemArchiveID
				, C.*
				, B.InitiatorName
				, B.InitiatorID
				, B.InitiatorUnitID
				, B.InitiatorUnitName
				, A.UserCode
				, A.UserName
				, A.SubKind
				, B.EndDate AS EndDate
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					, D.BodyContextOrg
				</if>
			FROM JWF_Workitem A
			INNER JOIN JWF_Process B ON B.ProcessID = A.ProcessID
			INNER JOIN JWF_ProcessDescription C ON B.ProcessDescriptionID = C.ProcessDescriptionID
			<if test="searchType != null and searchType == 'BodyContextOrg' ">
				INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
			</if>
			WHERE A.UserCode = #{deptID}
			AND B.ProcessState = 528
			AND A.SubKind = 'RE'
			AND A.Deleted IS NULL
			AND A.PIDeleted IS NULL
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (C.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR C.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND C.BusinessData1 = #{businessData1}
				</when>
			</choose>
		) DeptReceiveCompleteList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	   endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                     AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		  	<if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>

	<!-- 참조/회람 목록 데이터 -->
	<select id="selectDeptTCInfoList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				CirculationBoxID AS "CirculationBoxID"
				, ProcessID AS "ProcessID"
				, CirculationBoxDescriptionID AS "CirculationBoxDescriptionID"
				, FormInstID AS "FormInstID"
				, ReceiptID AS "ReceiptID"
				, ReceiptType AS "ReceiptType"
				, ReceiptName AS "ReceiptName"
				, ReceiptDate AS "ReceiptDate"
				, SubKind AS "SubKind"
				, FormSubKind AS "FormSubKind"
				, State AS "State"
				, ReadDate AS "ReadDate"
				, SenderID AS "SenderID"
				, SenderName AS "SenderName"
				, Subject AS "Subject"
				, "Comment"
				, DataState AS "DataState"
				, RegID AS "RegID"
				, RegDate AS "RegDate"
				, ModID AS "ModID"
				, ModDate AS "ModDate"
				, InitiatorID AS "InitiatorID"
				, InitiatorName AS "InitiatorName"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, InitiatedDate AS "InitiatedDate"
				, FormID AS "FormID"
				, FormPrefix AS "FormPrefix"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, ReadCheck AS "ReadCheck"
				, DocNo AS "DocNo"
				, PhotoPath AS "PhotoPath"
				, BodyContextOrg AS "BodyContextOrg"
				, BusinessData1 AS "BusinessData1"
				, BusinessData2 AS "BusinessData2"
				, BusinessData3 AS "BusinessData3"
				, BusinessData4 AS "BusinessData4"
				, BusinessData5 AS "BusinessData5"
				, BusinessData6 AS "BusinessData6"
				, BusinessData7 AS "BusinessData7"
				, BusinessData8 AS "BusinessData8"
				, BusinessData9 AS "BusinessData9"
				, BusinessData10 AS "BusinessData10"
			FROM (
					SELECT
						A.CirculationBoxID
					   , A.ProcessID
					   , A.CirculationBoxDescriptionID
					   , A.FormInstID
					   , A.ReceiptID
					   , A.ReceiptType
					   , A.ReceiptName
					   , A.ReceiptDate
					   , A.Kind AS SubKind
					   , A.Kind AS FormSubKind
					   , A.State
					   , A.ReadDate AS ReadDate
					   , A.SenderID
					   , A.SenderName
					   , A.Subject
					   , A.Comment_ AS "Comment"
					   , A.DataState
					   , A.RegID
					   , A.RegDate AS RegDate
					   , A.ModID
					   , A.ModDate AS ModDate
					   , B.InitiatorID
						, B.InitiatorName
						, B.InitiatorUnitID
						, B.InitiatorUnitName
						, B.InitiatedDate AS InitiatedDate
						, B.DocNo
						, B.BodyContextOrg
						, C.FormID AS FormID
						, C.FormPrefix
						, C.FormName
						, C.FormSubject
						, C.IsSecureDoc
						, C.IsFile
						, C.FileExt
						, C.IsComment
						, C.ApproverCode
						, C.ApproverName
						, C.ApprovalStep
						, C.ApproverSIPAddress
						, C.IsReserved
						, C.ReservedGubun
						, C.ReservedTime
						, C.Priority
						, C.IsModify
						, C.Reserved1
						, C.Reserved2
						, U.PhotoPath
						<choose>
			                <when test="DBName == 'COVI_APPROVAL4J' ">
			                    ,(CASE
									WHEN D.UserCode IS NOT NULL
										THEN 'Y'
									ELSE 'N'
								END) AS ReadCheck
			                </when>
			                <otherwise>
			                    , 'Y' AS ReadCheck
			                </otherwise>
			            </choose>
						, F.ExtInfo
						, E.BusinessData1
						, E.BusinessData2
						, E.BusinessData3
						, E.BusinessData4
						, E.BusinessData5
						, E.BusinessData6
						, E.BusinessData7
						, E.BusinessData8
						, E.BusinessData9
						, E.BusinessData10
					FROM JWF_CirculationBox A
					INNER JOIN JWF_FormInstance B ON A.FormInstID = B.FormInstID
					INNER JOIN JWF_CirculationBoxDescription C ON A.CirculationBoxDescriptionID = C.CirculationBoxDescriptionID
					LEFT OUTER JOIN JWF_Forms F ON B.FormID = F.FormID
					LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
					INNER JOIN jwf_processdescription E ON B.FormInstID = E.FormInstID
					INNER JOIN jwf_process P ON E.ProcessDescriptionID = P.ProcessDescriptionID AND P.ParentProcessID = 0
					LEFT OUTER JOIN jwf_circulationread D ON A.CirculationBoxID = D.CirculationBoxID AND D.UserCode = #{userID}
					WHERE A.State = 'C'
					<if test="adminYn == null or adminYn == '' ">
						AND B.DeletedDate IS NULL
					</if>
					AND A.ReceiptType = 'U'
					AND A.ReceiptID =  #{deptID}
					<if test='requestType != null and requestType.equalsIgnoreCase("DocList")'>AND P.BusinessState like '02_01%'</if>
					AND A.DataState != 'D'
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (E.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR E.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND E.BusinessData1 = #{businessData1}
						</when>
					</choose>
			) DeptTCInfoList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		RegDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND RegDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND RegDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
		  				AND RegDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , RegDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatedDate")'>InitiatedDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 참조/회람함 목록 개수 데이터 -->
	<select id="selectDeptTCInfoListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
	    	SELECT DeptTCInfoList.* FROM (
				SELECT A.CirculationBoxID
				   , A.ProcessID
				   , A.CirculationBoxDescriptionID
				   , A.FormInstID
				   , A.ReceiptID
				   , A.ReceiptType
				   , A.ReceiptName
				   , TO_CHAR(A.ReceiptDate, 'YYYY-MM-DD HH24:MI:SS') AS ReceiptDate
				   , A.Kind AS SubKind
				   , A.Kind AS FormSubKind
				   , A.State
				   , TO_CHAR(A.ReadDate, 'YYYY-MM-DD HH24:MI:SS') AS ReadDate
				   , A.SenderID
				   , A.SenderName
				   , A.Subject
				   , A.Comment_ AS "Comment"
				   , A.DataState
				   , A.RegID
				   , TO_CHAR(A.RegDate, 'YYYY-MM-DD HH24:MI:SS') AS RegDate
				   , A.ModID
				   , TO_CHAR(A.ModDate, 'YYYY-MM-DD HH24:MI:SS') AS ModDate
				   , B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, TO_CHAR(B.InitiatedDate, 'YYYY-MM-DD HH24:MI:SS') AS InitiatedDate
					, B.DocNo
					, B.BodyContextOrg
					, C.FormID AS FormID
					, C.FormPrefix
					, C.FormName
					, C.FormSubject
					, C.IsSecureDoc
					, C.IsFile
					, C.FileExt
					, C.IsComment
					, C.ApproverCode
					, C.ApproverName
					, C.ApprovalStep
					, C.ApproverSIPAddress
					, C.IsReserved
					, C.ReservedGubun
					, C.ReservedTime
					, C.Priority
					, C.IsModify
					, C.Reserved1
					, C.Reserved2
				FROM JWF_CirculationBox A
				INNER JOIN JWF_FormInstance B ON A.FormInstID = B.FormInstID
				INNER JOIN JWF_CirculationBoxDescription C ON A.CirculationBoxDescriptionID = C.CirculationBoxDescriptionID
				INNER JOIN jwf_processdescription D ON B.FormInstID = D.FormInstID
				INNER JOIN jwf_process P ON D.ProcessDescriptionID = P.ProcessDescriptionID AND P.ParentProcessID = 0
				WHERE A.State = 'C'
				<if test="adminYn == null or adminYn == '' ">
					AND B.DeletedDate IS NULL
				</if>
				AND A.ReceiptType = 'U'
				AND A.ReceiptID =  #{deptID}
				<if test='requestType != null and requestType.equalsIgnoreCase("DocList")'>AND P.BusinessState like '02_01%'</if>
				AND A.DataState != 'D'
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptTCInfoList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		RegDate BETWEEN #{startDate} AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND RegDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND RegDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
		  	   			AND RegDate BETWEEN #{searchGroupWord} AND TO_CHAR(TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 참조/회람함 그룹별 목록 조회 -->
	<select id="selectDeptTCInfoGroupList" parameterType="cmap" resultType="cmap">
		<if test="searchGroupType == 'Date'">
		    SELECT DeptTCInfoList."Date" AS "fieldID"
			, COUNT(DeptTCInfoList."Date") AS "fieldCnt"
	        , DeptTCInfoList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	    	SELECT DeptTCInfoList.FormPrefix AS "fieldID"
			, COUNT(DeptTCInfoList.FormPrefix) AS "fieldCnt"
	        , DeptTCInfoList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	     	SELECT DeptTCInfoList.InitiatorID AS "fieldID"
			, COUNT(DeptTCInfoList.InitiatorID) AS "fieldCnt"
	        , DeptTCInfoList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	     	SELECT DeptTCInfoList.InitiatorUnitID AS "fieldID"
			, COUNT(DeptTCInfoList.InitiatorUnitID) AS "fieldCnt"
	        , DeptTCInfoList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	     	SELECT DeptTCInfoList.SubKind AS "fieldID"
			, COUNT(DeptTCInfoList.SubKind) AS "fieldCnt"
	        , DeptTCInfoList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT 	  A.*
						, A.Kind AS SubKind
						, B.InitiatorID
						, B.InitiatorName
						, B.InitiatorUnitID
						, B.InitiatorUnitName
						, B.BodyContextOrg
						, C.FormID
						, C.FormPrefix
						, C.FormName
						, C.FormSubject
						<choose>
							<when test="searchGroupType == 'Date'">
								, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, A.RegDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
							</when>
							<otherwise>
								, TO_CHAR(A.RegDate,'YYYY-MM-DD') AS "Date"
							</otherwise>
						</choose>
				FROM JWF_CirculationBox A
				INNER JOIN JWF_FormInstance B ON A.FormInstID = B.FormInstID
				INNER JOIN JWF_CirculationBoxDescription C ON A.CirculationBoxDescriptionID = C.CirculationBoxDescriptionID
				INNER JOIN jwf_processdescription D ON B.FormInstID = D.FormInstID
				INNER JOIN jwf_process P ON D.ProcessDescriptionID = P.ProcessDescriptionID AND P.ParentProcessID = 0
				WHERE A.State = 'C'
				AND B.DeletedDate IS NULL
				AND A.ReceiptType = 'U'
				AND A.ReceiptID =  #{deptID}
				AND A.DataState != 'D'
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptTCInfoList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    "Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	 </if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND "Date" <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND "Date" <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
		  	    <if test="searchGroupType == 'Date'">
			 		DeptTCInfoList."Date"
			 	</if>
		 		<if test="searchGroupType == 'FormPrefix'">
		 			DeptTCInfoList.FormPrefix
			        , DeptTCInfoList.FormName
			    </if>
			     <if test="searchGroupType == 'InitiatorID'">
			     	DeptTCInfoList.InitiatorID
			        , DeptTCInfoList.InitiatorName
			    </if>
			     <if test="searchGroupType == 'InitiatorUnitID'">
					DeptTCInfoList.InitiatorUnitID				     
			        , DeptTCInfoList.InitiatorUnitName
			    </if>
			     <if test="searchGroupType == 'SubKind'">
					DeptTCInfoList.SubKind
			    </if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 참조/회람함 엑셀 데이터 조회 -->
	<select id="selectDeptTCInfoListExcel" parameterType="cmap" resultType="cmap">
			SELECT
				SubKind AS "SubKind"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, InitiatorUnitName AS "InitiatorUnitName"
				, InitiatorName AS "InitiatorName"
				, TO_CHAR(RegDate, 'YYYY-MM-DD HH24:MI:SS') AS "RegDate"
				, DocNo AS "DocNo"
			FROM (
				SELECT  A.CirculationBoxID
				   , A.ProcessID
				   , A.CirculationBoxDescriptionID
				   , A.FormInstID
				   , A.ReceiptID
				   , A.ReceiptType
				   , A.ReceiptName
				   , TO_CHAR(A.ReceiptDate, 'YYYY-MM-DD HH24:MI:SS') AS ReceiptDate
				   , A.ReceiptDate
				   , A.Kind AS SubKind
				   , A.State
				   , TO_CHAR(A.ReadDate, 'YYYY-MM-DD HH24:MI:SS') AS ReadDate
				   , A.SenderID
				   , A.SenderName
				   , A.Subject
				   , A.Comment_ AS "Comment"
				   , A.DataState
				   , A.RegID
				   , A.RegDate AS RegDate
				   , A.ModID
				   , TO_CHAR(A.ModDate, 'YYYY-MM-DD HH24:MI:SS') AS ModDate
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, TO_CHAR(B.InitiatedDate, 'YYYY-MM-DD HH24:MI:SS') AS InitiatedDate
					, B.BodyContextOrg
					, B.DocNo
					, C.FormID AS FormID
					, C.FormPrefix
					, C.FormName
					, C.FormSubject
					, C.IsSecureDoc
					, C.IsFile
					, C.FileExt
					, C.IsComment
					, C.ApproverCode
					, C.ApproverName
					, C.ApprovalStep
					, C.ApproverSIPAddress
					, C.IsReserved
					, C.ReservedGubun
					, C.ReservedTime
					, C.Priority
					, C.IsModify
					, C.Reserved1
					, C.Reserved2
				FROM JWF_CirculationBox A
				INNER JOIN JWF_FormInstance B ON A.FormInstID = B.FormInstID
				INNER JOIN JWF_CirculationBoxDescription C ON A.CirculationBoxDescriptionID = C.CirculationBoxDescriptionID
				INNER JOIN jwf_processdescription D ON B.FormInstID = D.FormInstID
				INNER JOIN jwf_process P ON D.ProcessDescriptionID = P.ProcessDescriptionID AND P.ParentProcessID = 0
				WHERE A.State = 'C'
				AND B.DeletedDate IS NULL
				AND A.ReceiptType = 'U'
				AND A.ReceiptID =  #{deptID}
				AND A.DataState != 'D'
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptTCInfoList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	   RegDate BETWEEN #{startDate} AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND RegDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND RegDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			   <choose>
	                <when test="searchGroupType == 'Date' ">
		  	   			AND RegDate BETWEEN #{searchGroupWord} AND TO_CHAR(TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		  	<if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , RegDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>

	<!-- 진행함 목록 데이터 -->
	<select id="selectDeptReceiveProcessList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessID AS "ProcessID"
				, WorkItemID AS "WorkItemID"
				, PerformerID AS "PerformerID"
				, SubKind AS "SubKind"
				, FormSubKind AS "FormSubKind"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, ProcessDescriptionID AS "ProcessDescriptionID"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormPrefix AS "FormPrefix"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, InitiatorName AS "InitiatorName"
				, InitiatorID AS "InitiatorID"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, Created AS "Created"
				, "Mode"
				, Charge AS "Charge"
				, PhotoPath AS "PhotoPath"
				, BusinessData1 AS "BusinessData1"
				, BusinessData2 AS "BusinessData2"
				, BusinessData3 AS "BusinessData3"
				, BusinessData4 AS "BusinessData4"
				, BusinessData5 AS "BusinessData5"
				, BusinessData6 AS "BusinessData6"
				, BusinessData7 AS "BusinessData7"
				, BusinessData8 AS "BusinessData8"
				, BusinessData9 AS "BusinessData9"
				, BusinessData10 AS "BusinessData10"
			FROM (
				SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, C.SubKind
					, C.SubKind AS FormSubKind
					, C.UserCode
					, C.UserName
					, D.*
					, A.InitiatorName
					, A.InitiatorID
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, TO_CHAR(B.Created, 'YYYY-MM-DD HH24:MI:SS') AS Created
					, CASE B.STATE WHEN 288 THEN 'REDRAFT' ELSE 'PROCESS' END AS "Mode"
					, B.Charge
					, U.PhotoPath
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.InitiatorID
				WHERE C.UserCode = #{deptID}
				AND C.SubKind IN ('R', 'C', 'AD', 'AS', 'AE')
				AND C.State = 1
				AND B.State = 528
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>

				UNION ALL

				SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, C.SubKind
					, C.SubKind AS FormSubKind
					, C.UserCode
					, C.UserName
					, D.*
					, A.InitiatorName
					, A.InitiatorID
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, TO_CHAR(B.Created, 'YYYY-MM-DD HH24:MI:SS') AS Created
					, CASE B.STATE WHEN 288 THEN 'REDRAFT' ELSE 'PROCESS' END AS "Mode"
					, B.Charge
					, U.PhotoPath
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = A.InitiatorID
				WHERE C.UserCode = #{deptID}
				AND C.SubKind IN ('T008')
				AND B.Name IN ('ReceiptBox', 'CoordiReceiptBox')
				AND C.State = 1
				AND B.State = 288
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptReceiveProcessList
		    <!-- 검색 데이터 Where 절 -->
		    <trim prefix="WHERE" prefixOverrides="AND |OR ">
			  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	    Created BETWEEN #{startDate} AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
			  	 </if>
				<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND 
						<choose>
							<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
							<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
							<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
							<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
							<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
							<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
							<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
						</choose> 
						LIKE '%' || #{searchWord} || '%'
				</if>
				<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND (
						FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
						InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
						InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
					)
				</if>
				<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
					<choose>
		                <when test="searchGroupType == 'Date' ">
			  	    		AND Created BETWEEN #{searchGroupWord} AND TO_CHAR(TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
		                </when>
		                <otherwise>
		                    AND 
		                    <choose>
								<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
								<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
							</choose> 
							= #{searchGroupWord}
		                </otherwise>
		            </choose>
				</if>
				<if test="userNm != null and userNm !=''">
					AND InitiatorName LIKE '%' || #{userNm} || '%'
				</if>
				<if test="titleNm != null and titleNm !=''">
					AND FormSubject LIKE '%' || #{titleNm} || '%'
				</if>
			</trim>
		    <!-- Order by 절 -->
			<trim prefix="ORDER BY"  prefixOverrides =",">
			    <if test = "sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
					, Priority DESC 
			    </if>
			    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
			        , Created Desc
			    </if>
			  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
				 	<choose>
						<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
						<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
						<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
						<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
						<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
						<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
						<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
						<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
						<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
						<when test='sortColumn.equalsIgnoreCase("Created")'>Created</when>
						<when test='sortColumn.equalsIgnoreCase("UserName")'>UserName</when>
					</choose>
					<choose>
						<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
						<otherwise> DESC</otherwise>
					</choose>
				</if>
			</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 진행함 목록 개수 데이터 -->
	<select id="selectDeptReceiveProcessListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
	    	SELECT DeptReceiveProcessList.* FROM (
				SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, C.SubKind
					, C.SubKind AS FormSubKind
					, C.UserCode
					, C.UserName
					, D.*
					, A.InitiatorName
					, A.InitiatorID
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, TO_CHAR(B.Created, 'YYYY-MM-DD HH24:MI:SS') AS Created
					, CASE B.STATE WHEN 288 THEN 'REDRAFT' ELSE 'PROCESS' END AS "Mode"
					, B.Charge
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				WHERE C.UserCode = #{deptID}
				AND C.SubKind IN ('R', 'C', 'AD', 'AS', 'AE')
				AND C.State = 1
				AND B.State = 528
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>

				UNION ALL

				SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, C.SubKind
					, C.SubKind AS FormSubKind
					, C.UserCode
					, C.UserName
					, D.*
					, A.InitiatorName
					, A.InitiatorID
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, TO_CHAR(B.Created, 'YYYY-MM-DD HH24:MI:SS') AS Created
					, CASE B.STATE WHEN 288 THEN 'REDRAFT' ELSE 'PROCESS' END AS "Mode"
					, B.Charge
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				WHERE C.UserCode = #{deptID}
				AND C.SubKind IN ('T008')
				AND B.Name IN ('ReceiptBox', 'CoordiReceiptBox')
				AND C.State = 1
				AND B.State = 288
				AND A.ProcessState = 288
				<if test="adminYn == null or adminYn == '' ">
					AND A.DeleteDate IS NULL
				</if>
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptReceiveProcessList
		    <!-- 검색 데이터 Where 절 -->
		    <trim prefix="WHERE" prefixOverrides="AND |OR ">
			  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  	    Created BETWEEN #{startDate} AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
			  	 </if>
				<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND 
					<choose>
						<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
						<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
						<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
						<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
						<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
						<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
						<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
					</choose> 
					LIKE '%' || #{searchWord} || '%'
				</if>
				<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND (
						FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
						InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
						InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
					)
				</if>
				<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
					<choose>
		                <when test="searchGroupType == 'Date' ">
			  	    		AND Created BETWEEN #{searchGroupWord} AND TO_CHAR(TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
		                </when>
		                <otherwise>
							AND 
		                    <choose>
								<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
								<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
							</choose> 
							= #{searchGroupWord}
		                </otherwise>
		            </choose>
				</if>
				<if test="userNm != null and userNm !=''">
					AND InitiatorName LIKE '%' || #{userNm} || '%'
				</if>
				<if test="titleNm != null and titleNm !=''">
					AND FormSubject LIKE '%' || #{titleNm} || '%'
				</if>
			</trim>
		) A
	</select>

	<!-- 진행함 그룹별 목록 조회 -->
	<select id="selectDeptReceiveProcessGroupList" parameterType="cmap" resultType="cmap">
		<if test="searchGroupType == 'Date'">
		    SELECT DeptReceiveProcessList."Date" AS "fieldID"
			, COUNT(DeptReceiveProcessList."Date") AS "fieldCnt"
	        , DeptReceiveProcessList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormPrefix'">
	    	SELECT DeptReceiveProcessList.FormPrefix AS "fieldID"
			, COUNT(DeptReceiveProcessList.FormPrefix) AS "fieldCnt"
	        , DeptReceiveProcessList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	     	SELECT DeptReceiveProcessList.InitiatorID AS "fieldID"
			, COUNT(DeptReceiveProcessList.InitiatorID) AS "fieldCnt"
	        , DeptReceiveProcessList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitID'">
	     	SELECT DeptReceiveProcessList.InitiatorUnitID AS "fieldID"
			, COUNT(DeptReceiveProcessList.InitiatorUnitID) AS "fieldCnt"
	        , DeptReceiveProcessList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	     	SELECT DeptReceiveProcessList.SubKind AS "fieldID"
			, COUNT(DeptReceiveProcessList.SubKind) AS "fieldCnt"
	        , DeptReceiveProcessList.SubKind as "fieldName"
	    </if>
			FROM (
			SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, C.SubKind
					, C.UserCode
					, C.UserName
					, D.FormSubject as Subject
					, D.*
					, A.InitiatorName
					, A.InitiatorID
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.Created), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(B.Created,'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
					, CASE B.STATE WHEN 288 THEN 'REDRAFT' ELSE 'PROCESS' END AS "Mode"
					, B.Charge
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				WHERE C.UserCode = #{deptID}
				AND C.SubKind IN ('R', 'C', 'AD', 'AS', 'AE')
				AND C.State = 1
				AND B.State = 528
				AND A.ProcessState = 288
				AND A.DeleteDate IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
				
				UNION ALL

				SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, C.SubKind
					, C.UserCode
					, C.UserName
					, D.FormSubject as Subject
					, D.*
					, A.InitiatorName
					, A.InitiatorID
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.Created), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(B.Created,'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
					, CASE B.STATE WHEN 288 THEN 'REDRAFT' ELSE 'PROCESS' END AS "Mode"
					, B.Charge
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				WHERE C.UserCode = #{deptID}
				AND C.SubKind IN ('T008')
				AND B.Name IN ('ReceiptBox', 'CoordiReceiptBox')
				AND C.State = 1
				AND B.State = 288
				AND A.ProcessState = 288
				AND A.DeleteDate IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptReceiveProcessList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    "Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	 </if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
		  	    <if test="searchGroupType == 'Date'">
			 		DeptReceiveProcessList."Date"
			 	</if>
		 		<if test="searchGroupType == 'FormPrefix'">
		 			DeptReceiveProcessList.FormPrefix
			        , DeptReceiveProcessList.FormName
			    </if>
			     <if test="searchGroupType == 'InitiatorID'">
			     	DeptReceiveProcessList.InitiatorID
			        , DeptReceiveProcessList.InitiatorName
			    </if>
			     <if test="searchGroupType == 'InitiatorUnitID'">
			     	DeptReceiveProcessList.InitiatorUnitID
			        , DeptReceiveProcessList.InitiatorUnitName
			    </if>
			     <if test="searchGroupType == 'SubKind'">
			     	DeptReceiveProcessList.SubKind
			    </if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 진행함 엑셀 데이터 조회 -->
	<select id="selectDeptReceiveProcessListExcel" parameterType="cmap" resultType="cmap">
			SELECT
				SubKind AS "SubKind"
				, FormSubject AS "FormSubject"
				, InitiatorUnitName AS "InitiatorUnitName"
				, InitiatorName AS "InitiatorName"
				, TO_CHAR(Created, 'YYYY-MM-DD HH24:MI:SS')  AS "Created"
				, FormName AS "FormName"
			FROM (
				SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, C.SubKind
					, C.UserCode
					, C.UserName
					, D.FormSubject as Subject
					, D.*
					, A.InitiatorName
					, A.InitiatorID
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, B.Created AS Created
					, CASE B.STATE WHEN 288 THEN 'REDRAFT' ELSE 'PROCESS' END AS "Mode"
					, B.Charge
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				WHERE C.UserCode = #{deptID}
				AND C.SubKind IN ('R', 'C', 'AD', 'AS', 'AE')
				AND C.State = 1
				AND B.State = 528
				AND A.ProcessState = 288
				AND A.DeleteDate IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>

				UNION ALL

				SELECT A.ProcessID
					, B.WorkItemID
					, C.PerformerID
					, C.SubKind
					, C.UserCode
					, C.UserName
					, D.FormSubject as Subject
					, D.*
					, A.InitiatorName
					, A.InitiatorID
					, A.InitiatorUnitID
					, A.InitiatorUnitName
					, B.Created AS Created
					, CASE B.STATE WHEN 288 THEN 'REDRAFT' ELSE 'PROCESS' END AS "Mode"
					, B.Charge
				FROM JWF_Process A
				INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
				INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
				INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
				WHERE C.UserCode = #{deptID}
				AND C.SubKind IN ('T008')
				AND B.Name IN ('ReceiptBox', 'CoordiReceiptBox')
				AND C.State = 1
				AND B.State = 288
				AND A.ProcessState = 288
				AND A.DeleteDate IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptReceiveProcessList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
				Created BETWEEN #{startDate} AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
		  	</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
			  	    	AND Created BETWEEN #{searchGroupWord} AND TO_CHAR(TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY"  prefixOverrides =",">
		    <if test = "sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
				, Priority DESC 
		    </if>
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , Created Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>

	<select id="selectDeptProcessNotDocReadCnt" resultType="java.lang.Long">
	    SELECT COUNT(DeptReceiveList.FormInstID) FROM (
			SELECT A.ProcessID
				, B.WorkItemID
				, C.PerformerID
				, C.SubKind
				, C.SubKind AS FormSubKind
				, C.UserCode
				, C.UserName
				, D.*
				, A.InitiatorName
				, A.InitiatorID
				, A.InitiatorUnitID
				, A.InitiatorUnitName
				, CASE B.State WHEN 288 THEN 'REDRAFT' ELSE 'COMPLETE' END AS "MODE"
				, TO_CHAR(B.Created, 'YYYY-MM-DD HH24:MI:SS') AS Created
			FROM JWF_Process A
			INNER JOIN JWF_Workitem B ON A.ProcessID = B.ProcessID
			INNER JOIN JWF_Performer C ON B.WorkItemID = C.WorkItemID
			INNER JOIN JWF_ProcessDescription D ON A.ProcessDescriptionID = D.ProcessDescriptionID
			WHERE C.UserCode = #{deptID}
			AND C.SubKind IN ('R', 'C', 'AD', 'AS', 'AE')
			AND C.State = 1
			AND B.State = 288
			AND A.ProcessState = 288
			<if test="adminYn == null or adminYn == '' ">
				AND A.DeleteDate IS NULL
			</if>
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (D.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR D.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND D.BusinessData1 = #{businessData1}
				</when>
			</choose>
		) DeptReceiveList
		WHERE NOT EXISTS (
				SELECT
						DISTINCT R.FormInstID
				FROM
						jwf_docreadhistory R
						INNER JOIN jwf_forminstance FI ON R.FormInstID = FI.FormInstID
				WHERE AdminYN = 'N'
				AND UserID = #{userID}
				AND DeptReceiveList.FormInstID = R.FormInstID
			)
	</select>

	<select id="selectDeptTCInfoNotDocReadCnt" resultType="java.lang.Long">
		SELECT count(*)
		FROM (
			SELECT A.CirculationBoxID
			FROM JWF_CirculationBox A
			INNER JOIN JWF_FormInstance B ON A.FormInstID = B.FormInstID
			INNER JOIN JWF_CirculationBoxDescription C ON A.CirculationBoxDescriptionID = C.CirculationBoxDescriptionID
			LEFT OUTER JOIN jwf_circulationread D ON A.CirculationBoxID = D.CirculationBoxID AND D.UserCode = #{userID}
			INNER JOIN jwf_processdescription E ON B.FormInstID = E.FormInstID
			INNER JOIN jwf_process P ON E.ProcessDescriptionID = P.ProcessDescriptionID AND P.ParentProcessID = 0
			WHERE A.State = 'C'
			AND A.ReceiptType = 'U'
			AND A.ReceiptID =  #{deptID}
			AND A.DataState != 'D'
			AND D.UserCode IS NULL
			<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (E.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR E.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND E.BusinessData1 = #{businessData1}
				</when>
			</choose>
		) AA
	</select>
	
	<select id="selectDeptTCInfoSingleDocRead" resultType="java.lang.Long">
	    SELECT COUNT(*)
	    FROM (
		    SELECT A.CirculationBoxID
			FROM JWF_CirculationBox A
			INNER JOIN JWF_CirculationBoxDescription B ON A.CirculationBoxDescriptionID = B.CirculationBoxDescriptionID
			LEFT OUTER JOIN jwf_circulationread C ON A.CirculationBoxID = C.CirculationBoxID AND C.UserCode = #{userID}
			INNER JOIN jwf_processdescription D ON B.FormInstID = D.FormInstID
			INNER JOIN jwf_process P ON D.ProcessDescriptionID = P.ProcessDescriptionID AND P.ParentProcessID = 0
			WHERE A.State = 'C'
			AND A.ReceiptType = 'U'
			AND A.ReceiptID = #{deptID}
			AND A.DataState != 'D'
	 		AND A.ProcessID = #{ProcessID}
	 		AND A.FormInstID = #{FormInstID}
	 		<choose>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
					AND (D.BusinessData1 IS NULL
						<if test='bizDataList != null'>
							OR D.BusinessData1 IN 
							<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
								#{item}
							</foreach>
						</if>
					)
				</when>
				<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
					AND D.BusinessData1 = #{businessData1}
				</when>
			</choose>
		) AA
	</select>
	
	<!-- 부서결재함- 특정부서 부서조회-->
	<select id="selectDeptDirectorAllCount" parameterType="cmap" resultType="int">
		<![CDATA[
	    SELECT COUNT(*) AS CNT FROM (
			SELECT b.UnitName,b.UnitCode
			FROM JWF_DIRECTOR A 
			LEFT OUTER JOIN JWF_DIRECTORMEMBER B ON A.USERCODE = B.USERCODE
			WHERE	A.UserCode = #{UserCode}
			AND	A.EntCode IN ('ORGROOT', #{EntCode})
			AND ((A.AuthEndDate IS NULL) OR (TO_CHAR(A.AuthStartDate,'YYYYMMDD')  <= TO_CHAR(sysdate,'YYYYMMDD') AND TO_CHAR(A.AuthEndDate,'YYYYMMDD')  >= TO_CHAR(sysdate,'YYYYMMDD')))
			
			UNION ALL
							
			SELECT B.TargetUnitName AS UnitName,B.TargetUnitCode AS UnitCode
			FROM jwf_unitdirector A 
			LEFT OUTER JOIN jwf_unitdirectormember B ON A.UnitCode = B.UnitCode
			WHERE	A.UnitCode = #{UnitCode}
			AND	A.EntCode IN ('ORGROOT', #{EntCode})
			AND ((A.AuthEndDate IS NULL) OR (TO_CHAR(A.AuthStartDate,'YYYYMMDD')  <= TO_CHAR(sysdate,'YYYYMMDD') AND TO_CHAR(A.AuthEndDate,'YYYYMMDD')  >= TO_CHAR(sysdate,'YYYYMMDD')))
		) A
		]]>
	</select>
	
	<select id="selectDeptDirector" parameterType="cmap" resultType="cmap">
	    <![CDATA[
			SELECT
					B.UnitName AS "UnitName"
					,B.UnitCode AS "UnitCode"
					, TO_CHAR(B.ViewStartDate, 'YYYY-MM-DD') AS "ViewStartDate"
					, TO_CHAR(B.ViewEndDate, 'YYYY-MM-DD') AS "ViewEndDate"
			FROM JWF_DIRECTOR A 
			LEFT OUTER JOIN JWF_DIRECTORMEMBER B ON A.USERCODE = B.USERCODE
			WHERE	A.UserCode = #{UserCode}
			AND	A.EntCode IN ('ORGROOT', #{EntCode})
			AND ((A.AuthEndDate IS NULL) OR (TO_CHAR(A.AuthStartDate,'YYYYMMDD')  <= TO_CHAR(sysdate,'YYYYMMDD') AND TO_CHAR(A.AuthEndDate,'YYYYMMDD')  >= TO_CHAR(sysdate,'YYYYMMDD')))
	    ]]>
	</select>
	
	<select id="selectDeptUnitDirector" parameterType="cmap" resultType="cmap">
	    <![CDATA[
		    SELECT
					B.TargetUnitName AS "UnitName"
					,B.TargetUnitCode AS "UnitCode"
					,TO_CHAR(B.ViewStartDate, 'YYYY-MM-DD') AS "ViewStartDate"
					,TO_CHAR(B.ViewEndDate, 'YYYY-MM-DD') AS "ViewEndDate"
			FROM jwf_unitdirector A 
			LEFT OUTER JOIN jwf_unitdirectormember B ON A.UnitCode = B.UnitCode
			WHERE	A.UnitCode = #{UnitCode}
			AND A.EntCode IN ('ORGROOT', #{EntCode})
			AND ((A.AuthEndDate IS NULL) OR (TO_CHAR(A.AuthStartDate,'YYYYMMDD')  <= TO_CHAR(sysdate,'YYYYMMDD') AND TO_CHAR(A.AuthEndDate,'YYYYMMDD')  >= TO_CHAR(sysdate,'YYYYMMDD')))
		]]>
	</select>
	
	<!-- 완료함 목록 데이터 -->
	<select id="selectStoreDeptDraftCompleteList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				ProcessArchiveID AS "ProcessArchiveID"
				, PerformerID AS "PerformerID"
				, WorkitemArchiveID AS "WorkitemArchiveID"
				, SubKind AS "SubKind"
				, UserCode AS "UserCode"
				, UserName AS "UserName"
				, FormPrefix AS "FormPrefix"
				, ProcessDescriptionArchiveID AS "ProcessDescriptionArchiveID"
				, FormInstID AS "FormInstID"
				, FormID AS "FormID"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, DocNo AS "DocNo"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, InitiatorName AS "InitiatorName"
				, InitiatorID AS "InitiatorID"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, EndDate AS "EndDate"
				, PhotoPath AS "PhotoPath"
				, BusinessData1 AS "BusinessData1"
				, BusinessData2 AS "BusinessData2"
				, BusinessData3 AS "BusinessData3"
				, BusinessData4 AS "BusinessData4"
				, BusinessData5 AS "BusinessData5"
				, BusinessData6 AS "BusinessData6"
				, BusinessData7 AS "BusinessData7"
				, BusinessData8 AS "BusinessData8"
				, BusinessData9 AS "BusinessData9"
				, BusinessData10 AS "BusinessData10"
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
				, BodyContextOrg "BodyContextOrg"
				</if>
			FROM (
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, A.SubKind
					, A.UserCode
					, A.UserName
					, B.FormPrefix
					, C.*
					, B.InitiatorName
					, B.InitiatorID
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, B.endDate AS EndDate
					, U.PhotoPath
					, F.ExtInfo
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID					
				LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
				LEFT OUTER JOIN JWF_Forms F ON C.FormID = F.FormID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND A.SubKind = 'A'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptDraftCompleteList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 완료함 목록 개수 데이터 -->
	<select id="selectStoreDeptDraftCompleteListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
		    SELECT DeptDraftCompleteList.* FROM (
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, A.SubKind
					, A.UserCode
					, A.UserName
					, B.FormPrefix
					, C.*
					, B.InitiatorName
					, B.InitiatorID
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, B.endDate AS EndDate
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID					
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND A.SubKind = 'A'
				<if test="adminYn == null or adminYn == '' ">
					AND A.Deleted IS NULL
				</if>
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptDraftCompleteList
		    <!-- 검색 데이터 Where 절 -->
		    <trim prefix="WHERE" prefixOverrides="AND |OR ">
			  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
			  		endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			  	</if>
			  	<if test="viewStartDate != null and viewStartDate != '' ">
					AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
				</if>
				<if test="viewEndDate != null and viewEndDate != '' ">
					AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
				</if>
				<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND 
					<choose>
						<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
						<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
						<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
						<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
						<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
						<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
						<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
					</choose> 
					LIKE '%' || #{searchWord} || '%'
				</if>
				<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
					AND (
						FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
						InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
						InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
					)
				</if>
				<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
					<choose>
		                <when test="searchGroupType == 'Date' ">
		                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
		                </when>
		                <otherwise>
		                     AND 
		                    <choose>
								<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
								<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
								<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
							</choose> 
							= #{searchGroupWord}
		                </otherwise>
		            </choose>
				</if>
				<if test="userNm != null and userNm !=''">
					AND InitiatorName LIKE '%' || #{userNm} || '%'
				</if>
				<if test="titleNm != null and titleNm !=''">
					AND FormSubject LIKE '%' || #{titleNm} || '%'
				</if>
			</trim>
		) A
	</select>

	<!-- 완료함 그룹별 목록 조회 -->
	<select id="selectStoreDeptDraftCompleteGroupList" parameterType="cmap" resultType="cmap">
		<if test="searchGroupType == 'Date'">
		    SELECT DeptDraftCompleteList."Date" AS "fieldID"
			, COUNT(DeptDraftCompleteList."Date") AS "fieldCnt"
	        , DeptDraftCompleteList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormName'">
	    	SELECT DeptDraftCompleteList.FormPrefix AS "fieldID"
			, COUNT(DeptDraftCompleteList.FormPrefix) AS "fieldCnt"
	        , DeptDraftCompleteList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	     	SELECT DeptDraftCompleteList.InitiatorID AS "fieldID"
			, COUNT(DeptDraftCompleteList.InitiatorID) AS "fieldCnt"
	        , DeptDraftCompleteList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitName'">
	     	SELECT DeptDraftCompleteList.InitiatorUnitID AS "fieldID"
			, COUNT(DeptDraftCompleteList.InitiatorUnitID) AS "fieldCnt"
	        , DeptDraftCompleteList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	     	SELECT DeptDraftCompleteList.SubKind AS "fieldID"
			, COUNT(DeptDraftCompleteList.SubKind) AS "fieldCnt"
	        , DeptDraftCompleteList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, B.FormPrefix
					, A.UserCode
					, A.UserName
					, A.SubKind
					<choose>
						<when test="searchGroupType == 'Date'">
							, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, B.endDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
						</when>
						<otherwise>
							, TO_CHAR(B.endDate,'YYYY-MM-DD') AS "Date"
						</otherwise>
					</choose>
					, C.*
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND A.SubKind = 'A'
				AND A.Deleted IS NULL
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptDraftCompleteList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    "Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND "Date" <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND "Date" <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
		  	    <if test="searchGroupType == 'Date'">
			 		DeptDraftCompleteList."Date"
			 	</if>
		 	    <if test="searchGroupType == 'FormName'">
		 	    	DeptDraftCompleteList.FormPrefix
			        , DeptDraftCompleteList.FormName
			    </if>
			     <if test="searchGroupType == 'InitiatorID'">
			     	DeptDraftCompleteList.InitiatorID
			        , DeptDraftCompleteList.InitiatorName
			    </if>
			     <if test="searchGroupType == 'InitiatorUnitName'">
			     	DeptDraftCompleteList.InitiatorUnitID
			        , DeptDraftCompleteList.InitiatorUnitName
			    </if>
			     <if test="searchGroupType == 'SubKind'">
			     	DeptDraftCompleteList.SubKind
			    </if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 완료함 엑셀 데이터 조회 -->
	<select id="selectStoreDeptDraftCompleteListExcel" parameterType="cmap" resultType="cmap">
			SELECT
				SubKind AS "SubKind"
				, FormSubject AS "FormSubject"
				, InitiatorUnitName AS "InitiatorUnitName"
				, InitiatorName AS "InitiatorName"
				, IsFile AS "IsFile"
				, FormName AS "FormName"
				, DocNo AS "DocNo"
				, TO_CHAR(EndDate, 'YYYY-MM-DD HH24:MI:SS') AS "EndDate"
			FROM (
				SELECT B.ProcessArchiveID
					, A.PerformerID
					, A.WorkitemArchiveID
					, A.SubKind
					, A.UserCode
					, A.UserName
					, C.*
					, B.InitiatorName
					, B.InitiatorID
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, B.EndDate AS EndDate
					<if test="searchType != null and searchType == 'BodyContextOrg' ">
						, D.BodyContextOrg
					</if>
				FROM JWF_WorkitemArchive A
				INNER JOIN JWF_ProcessArchive B ON B.ProcessArchiveID = A.ProcessArchiveID
				INNER JOIN JWF_ProcessDescriptionArchive C ON B.ProcessDescriptionArchiveID = C.ProcessDescriptionArchiveID
				<if test="searchType != null and searchType == 'BodyContextOrg' ">
					INNER JOIN JWF_FormInstance D ON B.FormInstID = D.FormInstID
				</if>
				WHERE A.UserCode = #{deptID}
				AND A.SubKind = 'A'
				AND A.Deleted IS NULL
				AND A.PIDeleted IS NULL
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (C.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR C.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND C.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptDraftCompleteList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	   endDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND endDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND endDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			    <choose>
	                <when test="searchGroupType == 'Date' ">
	                    AND endDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose>
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , endDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>
			<!-- 참조/회람 목록 데이터 -->
	<select id="selectStoreDeptTCInfoList" parameterType="cmap" resultType="cmap">
	    <include refid="oracle.include.pagingHeader"/>
			SELECT
				CirculationBoxID AS "CirculationBoxID"
				, ProcessID AS "ProcessID"
				, CirculationBoxDescriptionID AS "CirculationBoxDescriptionID"
				, FormInstID AS "FormInstID"
				, ReceiptID AS "ReceiptID"
				, ReceiptType AS "ReceiptType"
				, ReceiptName AS "ReceiptName"
				, ReceiptDate AS "ReceiptDate"
				, SubKind AS "SubKind"
				, FormSubKind AS "FormSubKind"
				, State AS "State"
				, ReadDate AS "ReadDate"
				, SenderID AS "SenderID"
				, SenderName AS "SenderName"
				, Subject AS "Subject"
				, "Comment"
				, DataState AS "DataState"
				, RegID AS "RegID"
				, RegDate AS "RegDate"
				, ModID AS "ModID"
				, ModDate AS "ModDate"
				, InitiatorID AS "InitiatorID"
				, InitiatorName AS "InitiatorName"
				, InitiatorUnitID AS "InitiatorUnitID"
				, InitiatorUnitName AS "InitiatorUnitName"
				, InitiatedDate AS "InitiatedDate"
				, FormID AS "FormID"
				, FormPrefix AS "FormPrefix"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, IsSecureDoc AS "IsSecureDoc"
				, IsFile AS "IsFile"
				, FileExt AS "FileExt"
				, IsComment AS "IsComment"
				, ApproverCode AS "ApproverCode"
				, ApproverName AS "ApproverName"
				, ApprovalStep AS "ApprovalStep"
				, ApproverSIPAddress AS "ApproverSIPAddress"
				, IsReserved AS "IsReserved"
				, ReservedGubun AS "ReservedGubun"
				, ReservedTime AS "ReservedTime"
				, Priority AS "Priority"
				, IsModify AS "IsModify"
				, Reserved1 AS "Reserved1"
				, Reserved2 AS "Reserved2"
				, ReadCheck AS "ReadCheck"
				, DocNo AS "DocNo"
				, PhotoPath AS "PhotoPath"
				, BodyContextOrg AS "BodyContextOrg"
				, BusinessData1 AS "BusinessData1"
				, BusinessData2 AS "BusinessData2"
				, BusinessData3 AS "BusinessData3"
				, BusinessData4 AS "BusinessData4"
				, BusinessData5 AS "BusinessData5"
				, BusinessData6 AS "BusinessData6"
				, BusinessData7 AS "BusinessData7"
				, BusinessData8 AS "BusinessData8"
				, BusinessData9 AS "BusinessData9"
				, BusinessData10 AS "BusinessData10"
			FROM (
					SELECT
						A.CirculationBoxID
					   , A.ProcessID
					   , A.CirculationBoxDescriptionID
					   , A.FormInstID
					   , A.ReceiptID
					   , A.ReceiptType
					   , A.ReceiptName
					   , A.ReceiptDate
					   , A.Kind AS SubKind
					   , A.Kind AS FormSubKind
					   , A.State
					   , A.ReadDate AS ReadDate
					   , A.SenderID
					   , A.SenderName
					   , A.Subject
					   , A.Comment_ AS "Comment"
					   , A.DataState
					   , A.RegID
					   , A.RegDate AS RegDate
					   , A.ModID
					   , A.ModDate AS ModDate
					   , B.InitiatorID
						, B.InitiatorName
						, B.InitiatorUnitID
						, B.InitiatorUnitName
						, B.InitiatedDate AS InitiatedDate
						, B.DocNo
						, B.BodyContextOrg
						, C.FormID AS FormID
						, C.FormPrefix
						, C.FormName
						, C.FormSubject
						, C.IsSecureDoc
						, C.IsFile
						, C.FileExt
						, C.IsComment
						, C.ApproverCode
						, C.ApproverName
						, C.ApprovalStep
						, C.ApproverSIPAddress
						, C.IsReserved
						, C.ReservedGubun
						, C.ReservedTime
						, C.Priority
						, C.IsModify
						, C.Reserved1
						, C.Reserved2
	                    ,(CASE
							WHEN D.UserCode IS NOT NULL
								THEN 'Y'
							ELSE 'N'
						END) AS ReadCheck
						, F.ExtInfo
						, U.PhotoPath
						, E.BusinessData1
						, E.BusinessData2
						, E.BusinessData3
						, E.BusinessData4
						, E.BusinessData5
						, E.BusinessData6
						, E.BusinessData7
						, E.BusinessData8
						, E.BusinessData9
						, E.BusinessData10
					FROM JWF_CIRCULATIONBOXARCHIVE A
					INNER JOIN JWF_FORMINSTANCEARCHIVE B ON A.FORMINSTID = B.FORMINSTID
					INNER JOIN JWF_CIRCULATIONBOXDESCARCHIVE C ON A.CIRCULATIONBOXDESCRIPTIONID = C.CIRCULATIONBOXDESCRIPTIONID
					LEFT OUTER JOIN JWF_CIRCULATIONREADARCHIVE D ON A.CirculationBoxID = D.CirculationBoxID AND D.UserCode = #{userID}
					LEFT OUTER JOIN JWF_Forms F ON B.FormID = F.FormID
					LEFT OUTER JOIN sys_object_user U ON U.UserCode = B.InitiatorID
					INNER JOIN JWF_PROCESSDESCRIPTIONARCHIVE E ON B.FORMINSTID = E.FORMINSTID
					INNER JOIN JWF_PROCESSARCHIVE P ON E.PROCESSDESCRIPTIONARCHIVEID = P.PROCESSDESCRIPTIONARCHIVEID AND P.ParentProcessID = 0
					WHERE A.State = 'C'
					<if test="adminYn == null or adminYn == '' ">
						AND B.DeletedDate IS NULL
					</if>
					AND A.ReceiptType = 'U'
					AND A.ReceiptID =  #{deptID}
					AND A.DataState != 'D'
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (E.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR E.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND E.BusinessData1 = #{businessData1}
						</when>
					</choose>
			) DeptTCInfoList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		RegDate BETWEEN TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND RegDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND RegDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>
				</choose>
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
		  				AND RegDate BETWEEN TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		    <if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , RegDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatedDate")'>InitiatedDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
		<include refid="oracle.include.pagingFooter"/>
	</select>

    <!-- 참조/회람함 목록 개수 데이터 -->
	<select id="selectStoreDeptTCInfoListCnt" resultType="java.lang.Long">
	    SELECT COUNT(*) FROM (
	    	SELECT DeptTCInfoList.* FROM (
					SELECT A.CirculationBoxID
					   , A.ProcessID
					   , A.CirculationBoxDescriptionID
					   , A.FormInstID
					   , A.ReceiptID
					   , A.ReceiptType
					   , A.ReceiptName
					   , TO_CHAR(A.ReceiptDate, 'YYYY-MM-DD HH24:MI:SS') AS ReceiptDate
					   , A.Kind AS SubKind
					   , A.Kind AS FormSubKind
					   , A.State
					   , TO_CHAR(A.ReadDate, 'YYYY-MM-DD HH24:MI:SS') AS ReadDate
					   , A.SenderID
					   , A.SenderName
					   , A.Subject
					   , A.Comment_ AS "Comment"
					   , A.DataState
					   , A.RegID
					   , TO_CHAR(A.RegDate, 'YYYY-MM-DD HH24:MI:SS') AS RegDate
					   , A.ModID
					   , TO_CHAR(A.ModDate, 'YYYY-MM-DD HH24:MI:SS') AS ModDate
					   , B.InitiatorID
						, B.InitiatorName
						, B.InitiatorUnitID
						, B.InitiatorUnitName
						, TO_CHAR(B.InitiatedDate, 'YYYY-MM-DD HH24:MI:SS') AS InitiatedDate
						, B.DocNo
						, B.BodyContextOrg
						, C.FormID AS FormID
						, C.FormPrefix
						, C.FormName
						, C.FormSubject
						, C.IsSecureDoc
						, C.IsFile
						, C.FileExt
						, C.IsComment
						, C.ApproverCode
						, C.ApproverName
						, C.ApprovalStep
						, C.ApproverSIPAddress
						, C.IsReserved
						, C.ReservedGubun
						, C.ReservedTime
						, C.Priority
						, C.IsModify
						, C.Reserved1
						, C.Reserved2
					FROM JWF_CIRCULATIONBOXARCHIVE A
					INNER JOIN JWF_FORMINSTANCEARCHIVE B ON A.FORMINSTID = B.FORMINSTID
					INNER JOIN JWF_CIRCULATIONBOXDESCARCHIVE C ON A.CIRCULATIONBOXDESCRIPTIONID = C.CIRCULATIONBOXDESCRIPTIONID
					INNER JOIN JWF_PROCESSDESCRIPTIONARCHIVE D ON B.FORMINSTID = D.FORMINSTID
					INNER JOIN JWF_PROCESSARCHIVE P ON D.PROCESSDESCRIPTIONARCHIVEID = P.PROCESSDESCRIPTIONARCHIVEID AND P.ParentProcessID = 0
					WHERE A.State = 'C'
					<if test="adminYn == null or adminYn == '' ">
						AND B.DeletedDate IS NULL
					</if>
					AND A.ReceiptType = 'U'
					AND A.ReceiptID =  #{deptID}
					AND A.DataState != 'D'
					<choose>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
							AND (D.BusinessData1 IS NULL
								<if test='bizDataList != null'>
									OR D.BusinessData1 IN 
									<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
										#{item}
									</foreach>
								</if>
							)
						</when>
						<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
							AND D.BusinessData1 = #{businessData1}
						</when>
					</choose>
			) DeptTCInfoList
	    <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  		RegDate BETWEEN #{startDate} AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
		  	</if>
		  	<if test="viewStartDate != null and viewStartDate != '' ">
				AND RegDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND RegDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%'	 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
				<choose>
	                <when test="searchGroupType == 'Date' ">
		  	   			AND RegDate BETWEEN #{searchGroupWord} AND TO_CHAR(TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		) A
	</select>

	<!-- 참조/회람함 그룹별 목록 조회 -->
	<select id="selectStoreDeptTCInfoGroupList" parameterType="cmap" resultType="cmap">
		<if test="searchGroupType == 'Date'">
		    SELECT DeptTCInfoList."Date" AS "fieldID"
			, COUNT(DeptTCInfoList."Date") AS "fieldCnt"
	        , DeptTCInfoList."Date" as "fieldName"
	    </if>
	    <if test="searchGroupType == 'FormName'">
	    	SELECT DeptTCInfoList.FormPrefix AS "fieldID"
			, COUNT(DeptTCInfoList.FormPrefix) AS "fieldCnt"
	        , DeptTCInfoList.FormName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorID'">
	     	SELECT DeptTCInfoList.InitiatorID AS "fieldID"
			, COUNT(DeptTCInfoList.InitiatorID) AS "fieldCnt"
	        , DeptTCInfoList.InitiatorName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'InitiatorUnitName'">
	     	SELECT DeptTCInfoList.InitiatorUnitID AS "fieldID"
			, COUNT(DeptTCInfoList.InitiatorUnitID) AS "fieldCnt"
	        , DeptTCInfoList.InitiatorUnitName as "fieldName"
	    </if>
	     <if test="searchGroupType == 'SubKind'">
	     	SELECT DeptTCInfoList.SubKind AS "fieldID"
			, COUNT(DeptTCInfoList.SubKind) AS "fieldCnt"
	        , DeptTCInfoList.SubKind as "fieldName"
	    </if>
			FROM (
				SELECT 	  A.*
						, A.Kind AS SubKind
						, B.InitiatorID
						, B.InitiatorName
						, B.InitiatorUnitID
						, B.InitiatorUnitName
						, B.BodyContextOrg
						, C.FormID
						, C.FormPrefix
						, C.FormName
						, C.FormSubject
						<choose>
							<when test="searchGroupType == 'Date'">
								, TO_CHAR(TO_DATE(Fn_ComURTimeZoneTrans_S(#{userID}, A.RegDate), 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD') AS "Date"
							</when>
							<otherwise>
								, TO_CHAR(A.RegDate,'YYYY-MM-DD') AS "Date"
							</otherwise>
						</choose>
				FROM JWF_CIRCULATIONBOXARCHIVE A
				INNER JOIN JWF_FORMINSTANCEARCHIVE B ON A.FORMINSTID = B.FORMINSTID
				INNER JOIN JWF_CIRCULATIONBOXDESCARCHIVE C ON A.CIRCULATIONBOXDESCRIPTIONID = C.CIRCULATIONBOXDESCRIPTIONID
				INNER JOIN JWF_PROCESSDESCRIPTIONARCHIVE D ON B.FORMINSTID = D.FORMINSTID
				INNER JOIN JWF_PROCESSARCHIVE P ON D.PROCESSDESCRIPTIONARCHIVEID = P.PROCESSDESCRIPTIONARCHIVEID AND P.ParentProcessID = 0
				WHERE A.State = 'C'
				AND B.DeletedDate IS NULL
				AND A.ReceiptType = 'U'
				AND A.ReceiptID =  #{deptID}
				AND A.DataState != 'D'
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptTCInfoList
	    <!-- 검색 Where 절  -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	    "Date" BETWEEN TO_CHAR(TO_DATE(#{startDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') AND TO_CHAR(TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
		  	 </if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND "Date" <![CDATA[>=]]> TO_CHAR(TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND "Date" <![CDATA[<=]]> TO_CHAR(TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 	OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
		<!-- Group By 절 -->
		<trim prefix="GROUP BY">
		  	<if test="searchGroupType != null and searchGroupType != '' ">
		  	    <if test="searchGroupType == 'Date'">
			 		DeptTCInfoList."Date"
			 	</if>
		 		<if test="searchGroupType == 'FormName'">
		 			DeptTCInfoList.FormPrefix
			        , DeptTCInfoList.FormName
			    </if>
			     <if test="searchGroupType == 'InitiatorID'">
			     	DeptTCInfoList.InitiatorID
			        , DeptTCInfoList.InitiatorName
			    </if>
			     <if test="searchGroupType == 'InitiatorUnitName'">
					DeptTCInfoList.InitiatorUnitID				     
			        , DeptTCInfoList.InitiatorUnitName
			    </if>
			     <if test="searchGroupType == 'SubKind'">
					DeptTCInfoList.SubKind
			    </if>
			</if>
		</trim>
		<!-- Order by 절 -->
		<trim prefix="ORDER BY">
		  	<if test="searchGroupType != null ">
			 	"fieldName" ASC
			</if>
		</trim>
	</select>

	<!-- 참조/회람함 엑셀 데이터 조회 -->
	<select id="selectStoreDeptTCInfoListExcel" parameterType="cmap" resultType="cmap">
			SELECT
				SubKind AS "SubKind"
				, FormName AS "FormName"
				, FormSubject AS "FormSubject"
				, InitiatorUnitName AS "InitiatorUnitName"
				, InitiatorName AS "InitiatorName"
				, TO_CHAR(RegDate, 'YYYY-MM-DD HH24:MI:SS') AS "RegDate"
			FROM (
				SELECT  A.CirculationBoxID
				   , A.ProcessID
				   , A.CirculationBoxDescriptionID
				   , A.FormInstID
				   , A.ReceiptID
				   , A.ReceiptType
				   , A.ReceiptName
				   , TO_CHAR(A.ReceiptDate, 'YYYY-MM-DD HH24:MI:SS') AS ReceiptDate
				   , A.ReceiptDate
				   , A.Kind AS SubKind
				   , A.State
				   , TO_CHAR(A.ReadDate, 'YYYY-MM-DD HH24:MI:SS') AS ReadDate
				   , A.SenderID
				   , A.SenderName
				   , A.Subject
				   , A.Comment_ AS "Comment"
				   , A.DataState
				   , A.RegID
				   , A.RegDate AS RegDate
				   , A.ModID
				   , TO_CHAR(A.ModDate, 'YYYY-MM-DD HH24:MI:SS') AS ModDate
					, B.InitiatorID
					, B.InitiatorName
					, B.InitiatorUnitID
					, B.InitiatorUnitName
					, TO_CHAR(B.InitiatedDate, 'YYYY-MM-DD HH24:MI:SS') AS InitiatedDate
					, B.BodyContextOrg
					, C.FormID AS FormID
					, C.FormPrefix
					, C.FormName
					, C.FormSubject
					, C.IsSecureDoc
					, C.IsFile
					, C.FileExt
					, C.IsComment
					, C.ApproverCode
					, C.ApproverName
					, C.ApprovalStep
					, C.ApproverSIPAddress
					, C.IsReserved
					, C.ReservedGubun
					, C.ReservedTime
					, C.Priority
					, C.IsModify
					, C.Reserved1
					, C.Reserved2
				FROM JWF_CIRCULATIONBOXARCHIVE A
				INNER JOIN JWF_FORMINSTANCEARCHIVE B ON A.FORMINSTID = B.FORMINSTID
				INNER JOIN JWF_CIRCULATIONBOXDESCARCHIVE C ON A.CIRCULATIONBOXDESCRIPTIONID = C.CIRCULATIONBOXDESCRIPTIONID
				INNER JOIN JWF_PROCESSDESCRIPTIONARCHIVE D ON B.FORMINSTID = D.FORMINSTID
				INNER JOIN JWF_PROCESSARCHIVE P ON D.PROCESSDESCRIPTIONARCHIVEID = P.PROCESSDESCRIPTIONARCHIVEID AND P.ParentProcessID = 0
				WHERE A.State = 'C'
				AND B.DeletedDate IS NULL
				AND A.ReceiptType = 'U'
				AND A.ReceiptID =  #{deptID}
				AND A.DataState != 'D'
				<choose>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('Y')">
						AND (D.BusinessData1 IS NULL
							<if test='bizDataList != null'>
								OR D.BusinessData1 IN 
								<foreach collection="bizDataList" item="item" index="index" separator="," open="(" close=")">
									#{item}
								</foreach>
							</if>
						)
					</when>
					<when test="isApprovalList != null and isApprovalList.equalsIgnoreCase('N')">
						AND D.BusinessData1 = #{businessData1}
					</when>
				</choose>
			) DeptTCInfoList
	     <!-- 검색 데이터 Where 절 -->
	    <trim prefix="WHERE" prefixOverrides="AND |OR ">
		  	<if test="startDate != null and startDate != '' and endDate != null and endDate != '' ">
		  	   RegDate BETWEEN #{startDate} AND TO_DATE(#{endDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
		  	</if>
			<if test="viewStartDate != null and viewStartDate != '' ">
				AND RegDate <![CDATA[>=]]> TO_DATE(#{viewStartDate}, 'YYYY-MM-DD HH24:MI:SS')
			</if>
			<if test="viewEndDate != null and viewEndDate != '' ">
				AND RegDate <![CDATA[<=]]> TO_DATE(#{viewEndDate}, 'YYYY-MM-DD HH24:MI:SS') + 1
			</if>
			<if test="searchType != null and searchType !='' and searchType != 'all' and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND 
				<choose>
					<when test='searchType.equalsIgnoreCase("FormSubject")'>FormSubject </when>
					<when test='searchType.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName </when>
					<when test='searchType.equalsIgnoreCase("InitiatorName")'>InitiatorName </when>
					<when test='searchType.equalsIgnoreCase("FormName")'>FormName </when>
					<when test='searchType.equalsIgnoreCase("DocNo")'>DocNo </when>
					<when test='searchType.equalsIgnoreCase("BodyContextOrg")'>BodyContextOrg </when>
					<when test='searchType.equalsIgnoreCase("Subject")'>Subject </when>					
				</choose> 
				LIKE '%' || #{searchWord} || '%'
			</if>
			<if test="searchType == 'all'  and searchWord != null and searchWord != '' and searchWord.length() gt 0">
				AND (
					FormSubject LIKE '%' || #{searchWord} || '%' 			OR <!-- 제목 -->
					InitiatorUnitName LIKE '%' || #{searchWord} || '%' 		OR <!-- 기안부서 -->
					InitiatorName LIKE '%' || #{searchWord} || '%'		   <!-- 기안자 -->
				)
			</if>
			<if test="searchGroupType != null and searchGroupType !='' and searchGroupWord != null and searchGroupWord != '' and searchGroupWord.length() gt 0">
			   <choose>
	                <when test="searchGroupType == 'Date' ">
		  	   			AND RegDate BETWEEN #{searchGroupWord} AND TO_CHAR(TO_DATE(#{searchGroupWord}, 'YYYY-MM-DD HH24:MI:SS') + 1, 'YYYY-MM-DD HH24:MI:SS')
	                </when>
	                <otherwise>
	                    AND 
	                    <choose>
							<when test='searchGroupType.equalsIgnoreCase("FormPrefix")'>FormPrefix </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorID")'>InitiatorID </when>
							<when test='searchGroupType.equalsIgnoreCase("InitiatorUnitID")'>InitiatorUnitID </when>
							<when test='searchGroupType.equalsIgnoreCase("SubKind")'>SubKind</when>
						</choose> 
						= #{searchGroupWord}
	                </otherwise>
	            </choose>
			</if>
			<if test="userNm != null and userNm !=''">
				AND InitiatorName LIKE '%' || #{userNm} || '%'
			</if>
			<if test="titleNm != null and titleNm !=''">
				AND FormSubject LIKE '%' || #{titleNm} || '%'
			</if>
		</trim>
	    <!-- Order by 절 -->
		<trim prefix="ORDER BY" prefixOverrides =",">
		  	<if test="sortColumn == '' or sortColumn == null or sortDirection == '' or sortDirection == null">
		        , RegDate Desc
		    </if>
		  	<if test="sortColumn != null and sortColumn != '' and sortDirection != null and sortDirection !='' ">
			 	<choose>
					<when test='sortColumn.equalsIgnoreCase("SubKind")'>SubKind</when>
					<when test='sortColumn.equalsIgnoreCase("FormSubject")'>FormSubject</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorUnitName")'>InitiatorUnitName</when>
					<when test='sortColumn.equalsIgnoreCase("InitiatorName")'>InitiatorName</when>
					<when test='sortColumn.equalsIgnoreCase("IsFile")'>IsFile</when>
					<when test='sortColumn.equalsIgnoreCase("FormName")'>FormName</when>
					<when test='sortColumn.equalsIgnoreCase("DocNo")'>DocNo</when>
					<when test='sortColumn.equalsIgnoreCase("EndDate")'>EndDate</when>
					<when test='sortColumn.equalsIgnoreCase("RegDate")'>RegDate</when>
				</choose>
				<choose>
					<when test='sortDirection.equalsIgnoreCase("ASC")'> ASC</when>
					<otherwise> DESC</otherwise>
				</choose>
			</if>
		</trim>
	</select>
</mapper>

