<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>SmartS4J - XFormEditor Preview</title>
	
	<!--CSS Include Start -->
	<!-- 공통 CSS  -->
	<link rel="stylesheet" type="text/css" href="$cssPath$/covicore/resources/css/axisj/arongi/AXJ.min.css">
	<link rel="stylesheet" type="text/css" href="$cssPath$/approval/resources/css/approval.css">
	<link rel="stylesheet" type="text/css" href="$cssPath$/covicore/resources/css/common.css">
	<link rel="stylesheet" type="text/css" href="$cssPath$/covicore/resources/css/covision/user_common_controls.css">  
	<link rel="stylesheet" type="text/css" href="$cssPath$/covicore/resources/css/covision/Controls.css">
	<link rel="stylesheet" type="text/css" href="$cssPath$/covicore/resources/css/jquery-ui-1.12.1.css">
	<link rel="stylesheet" id="themeCSS" type="text/css" href="$cssPath$/covicore/resources/css/theme/blue.css">
<!-- 	<link rel="stylesheet" type="text/css" href="$cssPath$/customizing/covision_n/css/project.css"> -->
<!-- 	<link rel="stylesheet" type="text/css" href="$cssPath$/customizing/covision_n/css/color_01.css"> -->
	<link rel="text/javascript" src="$cssPath$/customizing/covision_n/js/project.js">
	<!-- 양식개선 새 컴포넌트용 CSS (Xeasy) -->
	<link type="text/css" rel="stylesheet" href="$cssPath$/approval/resources/css/xeasy/xeasy.0.9.css">
	<link rel="stylesheet" id="languageCSS" type="text/css" href="$cssPath$/covicore/resources/css/language/ko.css">
	<link rel="stylesheet" type="text/css" href="$cssPath$/public/resources/css/public.css">
	<!--CSS Include End -->
	
	
	<!--JavaScript Include Start -->
	<!-- 공통 JavaScript  -->	
	<!-- XForm compatability -->
	<script type="text/javascript" src="/approval/resources/script/xform/Jquery-last.js"></script>
	<script type="text/javascript" src="/approval/resources/script/xform/jquery-ui-1.8.11.min.js"></script>
	<script type="text/javascript" src="/covicore/resources/script/Controls/CommonControls.js"></script> 
	<script type="text/javascript" src="/covicore/resources/script/Controls/Common.js"></script>

	<script type="text/javascript" src="/covicore/resources/script/Controls/Utils.js"></script>
	<script type="text/javascript" src="/covicore/resources/script/Controls/covision.editor.js"></script>
	<script type="text/javascript" src="/covicore/resources/script/Controls/covision.dic.js"></script>
	<script type="text/javascript" src="/covicore/resources/script/Controls/covision.common.js"></script>
	
	<!-- 양식개선 새 컴포넌트 모음 -->
	<link type="text/css" rel="stylesheet" href="$cssPath$/approval/resources/css/xeasy/xeasy.0.9.css">
	<script type="text/javascript" src="/approval/resources/script/xeasy/xeasy-number.js"></script>
	<script type="text/javascript" src="/approval/resources/script/xeasy/xeasy-numeral.js"></script>
	<script type="text/javascript" src="/approval/resources/script/xeasy/xeasy-timepicker.js"></script>
	<script type="text/javascript" src="/approval/resources/script/xeasy/xeasy.multirow.0.9.js"></script>
	<script type="text/javascript" src="/approval/resources/script/xeasy/xeasy4j.0.9.2.js"></script>

	<!-- 추가 외부 Library 모음 -->
	<script type="text/javascript" src="/approval/resources/script/forms/json2.js"></script>
	<script type="text/javascript" src="/approval/resources/script/forms/underscore.js"></script>
	<script type="text/javascript" src="/approval/resources/script/forms/jquery.xml2json.js"></script>

</head>
<body scroll="auto">
<div id="FormBody" style="display:none;">
	<div class="form_wrap">
		<!-- 메뉴가 들어 올 영역 -->
		<div id="div_formmenu" class="wordTop">
			<div class="topWrap" style="min-height: 50px;">
				<!-- 기안 -->
				<input type="button" class="blBtn" id="btDraft" name="cbBTN" value="기안" style="">
				<!-- 결재선 -->
				<input type="button" class="AXButton" id="btLine" name="cbBTN" value="결재선" style="">
				<!-- 임시저장 -->
				<input type="button" class="AXButton" id="btSave" name="cbBTN" value="임시저장" style="">
				<!-- 문서연결 -->
				<input type="button" class="AXButton" id="btDocLinked" value="문서연결" style="">
				<!-- 미리보기 -->
				<input type="button" class="AXButton" id="btPreView" name="cbBTN" value="미리보기" style="">
				<span class="wordCheck" id="divMenuRight">
				    <!--긴급-->
				    <span id="urgent" style="cursor: default;">
				    	<input type="checkbox" name="chk_urgent" id="chk_urgent" value="0" class="input_check">
				    	<label for="chk_urgent" style="user-select: none;">
				    		긴급결재
				    	</label>
				    </span>
				    <!--기밀-->
				    <span id="secrecy" style="">
				    	<input type="checkbox" name="chk_secrecy" id="chk_secrecy" value="0" class="input_check">
				    	<label for="chk_secrecy" style="user-select: none;">
				    		기밀문서
				    	</label>
				    </span>
				</span>
				<ul id="divMenu02" class="formIcn">
				</ul>
				<!-- 즐겨찾기 등록 -->
				<span id="favorformadd" class="staroff" style="display:none;"><a id="a_favorformadd" class="remove-cstf">즐겨찾기등록</a></span> 
				<!-- 즐겨찾기 제거 -->
				<span id="favorformdelete" class="staron" style=""><a id="a_favorformdelete" class="remove-cstf">즐겨찾기 제거</a></span> 
			</div>
		</div>

		<!-- 양식 상단 끝 -->
		<!-- 양식 본문 시작 -->
		<div id="bodytable" class="wordCont" style="top:100px;"><!-- 상단 영역 확장시 높이 변경(추후 알려드리겠습니다.) -->
			<div class="form_box" id="formBox">
	    		<table class="wordLayout">
	      			<colgroup>
	      				<col style="*">
	      			</colgroup>
	      			<thead>
	        			<tr>
	          				<td class="wordLeft" style="padding-top: 0px;"><!--문서양식 왼쪽 시작-->
	           					 <h2><span id="headname" class="apptit_h2 fsbTop"></span></h2>
	           					 <div id="editor">
		           					 <div id="bodytable_content">
		           					 	<!-- 결재문서 Top 영역이 들어 올 곳 -->
		           					 	
		           					 	<!-- 결재선이 들어 올 곳 -->

										<div class="fsbTop" id="divFormApvLines">
											<div>
												<!-- 일반결재 -->
												<table class="signTable" id="FormApvLines" style="">
												    <tbody><tr>
												    	<td id="AppLine" align="right" style="width: 100%;">
												    		<table class="tableStyle linePlus tCenter" id="tableAppLine1" style="width: 382px;">
																<colgroup>
																	<col style="width:30px;">
																<col style="width:88px;"><col style="width:88px;"><col style="width:88px;"><col style="width:88px;"></colgroup>
																<tbody>
																<tr><th id="AppLineTitle" rowspan="4">결<br>재</th><td>기안</td><td>과장</td><td>부장</td><td>이사</td></tr><tr><td class="signArea">홍길동</td><td class="signArea">장영실</td><td class="signArea">이순신</td><td class="signArea">이성계</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr></tbody>
															</table>
												    	</td>
														<td id="AuditAppLine" align="right" style="display: none;width:130px;">
												    		<table class="tableStyle linePlus tCenter">
																<colgroup>
																	<col style="width:30px;">
																</colgroup>
																<tbody>
																</tbody>
															</table>
												    	</td>
												    </tr>
												    <tr>
														<td id="LApvLine" align="left" style="display: none;width:50%;">
															<table class="tableStyle linePlus tCenter">
																<colgroup>
																	<col style="width:30px;">
																</colgroup>
																<tbody>
																</tbody>
															</table>
														</td>
														<td id="RApvLine" align="right" style="display: none;width:50%;">
															<table class="tableStyle linePlus tCenter">
																<colgroup>
																	<col style="width:30px;">
																</colgroup>
																<tbody>
																</tbody>
															</table>
														</td>
														<td id="AuditRApvLine" align="right" style="display: none;width:130px;">
												    		<table class="tableStyle linePlus tCenter">
																<colgroup>
																	<col style="width:30px;">
																</colgroup>
																<tbody>
																</tbody>
															</table>
												    	</td>
													</tr>
												</tbody></table>
												
												<!-- 합의목록 -->
												<div id="AssistLine" style="">
													<div id="AssistLine1">
														<table class="tableStyle linePlus t_center mt10">
															<colgroup>
															<col style="width:*"></colgroup><thead><tr><th>결재유형</th><th>부서</th><th>이름</th><th>결재일자</th><th>의견</th></tr></thead>
														<tbody><tr><td>개인합의(병렬)</td><td>연구2팀</td><td>김유신 차장</td><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>개인합의(병렬)</td><td>연구3팀</td><td>강감찬 차장</td><td>&nbsp;</td><td>&nbsp;</td></tr></tbody></table>
													</div>
												</div>
											</div>
										</div>
										<!-- 양식 상단 부분 들어 올 곳 -->
										<!-- 문서분류 -->
										<table class="tableStyle linePlus mt10 fsbTop" cellpadding="0" cellspacing="0">
										    <colgroup>
										    	<col style="width:12%">
										    	<col style="width:23%">
										    	<col style="width:12%">
										    	<col style="width:23%">
										    	<col style="width:12%">
										    	<col style="width:*">
										    </colgroup>
										    <tbody>
											    <tr>
											        <th id="TIT_INITIATOR">작성자</th>
											        <td style="text-align:left;">
											            <input type="text" data-type="mField" id="InitiatorDisplay" value="" data-binding="pre" style="width:100%; border:0px;" readonly="readonly">
											        </td>
											        <th id="TIT_INITIATOR_OU">작성부서</th>
											        <td style="text-align:left;">
											            <input type="text" data-type="mField" id="InitiatorOUDisplay" value="" data-binding="pre" style="width:100%; border:0px;" readonly="readonly">
											        </td>
											        <th id="TIT_DOC_NO">문서번호</th>
											        <td style="text-align:left;">
											            <input type="text" data-type="dField" id="DocNo" value="" data-model="FormInstanceInfo.DocNo" data-binding="pre" style="width:100%; border:0px;" readonly="readonly">
											        </td>
											    </tr>
											    <tr>
											        <th id="TIT_DOC_CLASS">문서분류</th>
											        <td>
											            <input type="text" data-type="dField" id="DocClassName" value="" data-model="FormInstanceInfo.DocClassName" data-binding="pre" style="width:70%; border:0px;" readonly="readonly">&nbsp;
											            <span data-mode="writeOnly">
											                <img src="$cssPath$/approval/resources/images/Approval/btn_organization.gif" name="btn_Process" id="btn_Process" align="absMiddle" border="0" style="cursor:pointer;" />
											            </span>
											        </td>
											        <th id="TIT_DOC_LEVEL">보안등급</th>
											        <td style="text-align:left;">
											            <select data-type="dField" id="DocLevel" data-element-type="sel_d_v" data-binding="post"><option value="100">일반문서</option><option value="200">보안문서</option><option value="300">3등급</option></select>
											        </td>
											        <th id="TIT_SAVE_TERM">보존년한</th>
											        <td style="text-align:left;">
											            <select data-type="dField" id="SaveTerm" data-element-type="sel_d_v" data-binding="post"><option value="1">1년</option><option value="3">3년</option><option value="5">5년</option><option value="7">7년</option><option value="10">10년</option><option value="99">영구</option></select>
											        </td>
											    </tr>
										    </tbody>
										</table>

										<!-- 수신처 -->
										<table class="tableStyle linePlus mt10 fsbTop" style="display: none" cellpadding="0" cellspacing="0" id="ReceiveLine">
										    <colgroup>
										        <col style="width:12%">
										        <col style="width:*">
										    </colgroup>
										    <tbody><tr>
										        <th id="TIT_RECLINE">수&nbsp;신&nbsp;처</th>
										        <td id="RecLine"></td>
										    </tr>
										</tbody></table>
										
										<!-- 참조 -->
										<table class="tableStyle linePlus mt10" style="display: none" cellpadding="0" cellspacing="0" id="CCLine">
										    <colgroup>
										        <col style="width:12%">
										        <col style="width:*">
										    </colgroup>
										    <tbody><tr>
										        <th id="TIT_L_CCINFO">참조</th>
										        <td>
										            <span id="SendCC"></span>
										        </td>
										    </tr>
										    <tr>
										        <th id="TIT_R_CCINFO">수신 참조</th>
										        <td>
										            <span id="RecCC"></span>
										        </td>
										    </tr>
										</tbody></table>
										<!-- header end -->
										<!-- bodycontext start -->

										<!-- 제목 -->
										<table class="tableStyle linePlus mt10" id="tblFormSubject" cellpadding="0" cellspacing="0">
										    <colgroup>
										        <col style="width:12%">
										        <col style="width:*">
										    </colgroup>
										    <tbody><tr>
										        <th id="TIT_SUBJECT">제목</th>
										        <td><input type="text" data-type="dField" id="Subject" value="" title="제목" data-model="FormInstanceInfo.Subject" data-binding="pre" style="width:99%; height:20px;" required="" class="input-required pattern-active pattern-required-active"></td>
										    </tr>
										</tbody>
										</table>
										<!-- 양식 template 들어 올 곳 -->
										<!--실 결재양식 내용 부분 시작 -->
										<!-- 에디터 시작 -->
										<!-- bodycontext2 start -->		
										<div id="xform_body" style="display: none;"></div>
										<!-- 에디터 끝 -->
										<!--실 결재양식 내용 부분 끝 -->

									</div>
								</div>
								<div>
									<!-- 양식 하단 부분이 들어 올 곳 -->
									<!-- 참조 -->
									<table class="tableStyle linePlus mt10" id="tbLinkInfo" cellpadding="0" cellspacing="0"><!-- class="table_5"  -->
									    <colgroup>
									        <col style="width:12%">
									        <col style="width:*">
									    </colgroup>
									    <tbody>
									    <tr style="border-top: 1px solid rgb(195, 215, 223); display: none;" id="AttFileInfoList">
									        <th id="TIT_ATTFILEINFO" class="table_5_th">첨부파일</th>
									        <td id="AttFileInfo"></td><!-- class="table_5_td" -->
									    </tr>
									    <tr id="trAttFileInfoAdd" style="display:none;">
									        <th class="table_5_th">추가파일</th>
									        <td class="table_5_td" id="AttFileInfoAdd"></td>
									    </tr>
									    <tr style="border-top:1px solid #c3d7df" id="DocLinkInfoList">
									        <th id="TIT_DOCLINKINFO" class="table_5_th">연관문서</th>
									        <td id="DocLinkInfo"></td><!-- class="table_5_td"  -->
									    </tr>
									</tbody></table>
									<br>
									<!-- 첨부 부분이 들어 올 곳 -->
									<!-- 첨부파일 시작 작성페이지의 경우 첨부파일Uload UX 조회페이지 다운로드UX표시 -->
						            <h3 id="attachTitle" class="apptit_h3"><span>첨부목록</span></h3><!-- 첨부목록 -->
						            <table class="tableStyle linePlus" id="tbFormAttach">
						              <colgroup>
						              <col style="width:12%;">
						              <col style="width:*">
						              </colgroup>
						              <tbody>
						                <tr>
						                  <th>첨부목록</th><!-- 첨부목록 -->
						                  <td>
						                  		<!-- 첨부파일 컨트롤 시작 -->
						                        <!-- 파일 컨트롤 타입 설정 : 0.None, 1.DEXTUploadX, 2.CoviFileTrans, 3.CoviSilverlightTrans, 4.CoviUploadNSlvTrans, 5.HTML 5 -->
						                        <div id="divFileControlContainer"></div>
						                        <div style="width:0px; height:0px; float:right; overflow-x:hidden;">
						                        	<input type="file" multiple="" name="FileSelect" id="FileSelect" onchange="javascript:FileSelect_onchange();" style="opacity:0;">
						                        	<input type="submit" id="btnsubmit" style="display:none;">
						                        	<input type="hidden" id="hidsaveFileName">
						                        	<input type="hidden" id="hidDeletFiles">
						                        </div>
						                        
						                        <div class="addDataBtn">
						                        	<input type="button" class="smButton" value="파일추가">
						                        	<input type="button" class="smButton" id="webhardAttach" style="" value="웹하드">
						                        	<input type="button" class="smButton" id="edmsAttach" style="display:none;" value="EDMS첨부">
						                        	<input type="button" class="smButton" value="파일삭제">
						                        	<input type="button" class="smButton" value="∧">
						                        	<input type="button" class="smButton" value="∨">
						                        	<div id="divFileLimitInfo" name="divFileLimitInfo" style="display:inline-block; margin-left:10px;"><span style="color:#999">1회 업로드 제한: 95.4MB</span></div>
						                        	<div style="cursor:default; font-weight: bold;padding-bottom: 2px;float: right;display: inline-block;border-bottom: 1px solid #ddd;position: relative;height: 20px; font-size: 11px; color: #666;width:auto !important; margin-top:3px; white-space:nowrap;">
						                        		* 허용 확장자
						                        		<div name="coviFileTooltip" style="display:none; position: absolute; width: 300px; left: -230px; top: 23px; border: 1px solid #d9d9d9; box-sizing: border-box; padding: 5px; background-color: #f5f5f5; border-radius: 5px; white-space: normal;">wmv, wma, avi, mp3, mpg, mov, asf, jpg, gif, png, swf, jpeg, xlsx, xls, txt, zip, ppt, pptx, pdf, doc, docx, hwp, mp4, apk, bin, bmp, eml, xlsm, JPG, PNG, one, log, z01, z02, z03, z04, z05, z06, z07, z08, m4a, amr, xlsb, xml, erm, html, htm</div>
						                        	</div>
						                        </div>
						                        
						                        <div style="min-height:125px;">
						                         <div class="addData">
						                         	<table class="fileHover">
						                          	<colgroup>
						                          		<col style="width:33px">
						                          		<col style="width:41px">
						                          		<col style="width:*">
						                          		<col style="width:120px">
						                          	</colgroup>
						                           	<thead>
						                           		<tr><th scope="col">
						                           			<input type="checkbox" id="attAllCheck" class="input_check">
						                           		</th>
						                           		<th scope="col">확장자</th>
						                           		<th scope="col">파일명</th>
						                           		<th scope="col" style="padding-right:10px;text-align:right;">용량</th>
						                           	</tr></thead>                           
						                          	</table>
						                         	<table id="tblFileList" class="fileHover">
						                          	<colgroup>
						                          		<col style="width:30px">
						                          		<col style="width:60px">
						                          		<col style="width:*">
						                          		<col style="width:120px">
						                          	</colgroup>
							                           <tbody id="fileInfo" style="background-color:white;">
								                           	<tr id="trFileInfoBox" style="height:99%">
								                           		<td colspan="4">
								                           			<div class="dragFileBox"><span class="dragFile">icn</span>마우스로&nbsp;파일을&nbsp;끌어&nbsp;오십시오</div>
								                           		</td>
								                           	</tr>
							                           </tbody>
						                          </table>
						                         </div>
						                        </div>
						                    </td>
						                </tr>
						                </tbody>
						            </table>
						            <!-- 첨부파일 컨트롤 끝 -->
									<div class="form_footer"></div>
								</div>
							</td>
						</tr>
					</thead>
				</table>
			</div>
		</div>
	</div>
</div>
 

<div id="xform_contents2" style="display: none; width: 732px; height: 800px !important; padding:auto; margin: 10px 20px; bordder: solid 1px !important; ">
test
</div> 
<textarea id="xform_contents_js" style="display: none; width: 732px; height: 800px !important; padding:auto; margin: 10px 20px; border: solid 1px !important; ">
test
</textarea> 

<!-- 양식 전체 end -->
<script>

    var r,
        re,
        c,
        h,
        isConvert;

    try {
    	var cssPathStr = Common.getGlobalProperties("css.path");
    	if(cssPathStr.indexOf("//") == 0) {
    		cssPathStr = "http:" + cssPathStr;
    	}
    	$("link,img").each(function(){
    		if(this.href && this.href.indexOf("$cssPath$") > -1) {
    			var sidx = this.href.indexOf("$cssPath$") + 9;
    			var eidx = this.href.length;
    			this.href = cssPathStr + this.href.substring(sidx, eidx);
    		}
    		if(this.src && this.src.indexOf("$cssPath$") > -1) {
    			var sidx = this.src.indexOf("$cssPath$") + 9;
    			var eidx = this.src.length;
    			this.src = cssPathStr + this.src.substring(sidx, eidx);    			
    		}
    	});
    	
        //source
        var $w;

        if (window.opener != null) {
            isConvert = 'n';
            $w = window.opener;
        } else {
            isConvert = 'y';
            $w = window.parent;

        }
        c = $w.$('#canvas').html();
        var header = $w.$('.xform-form-name').text();

        //restore script

        //append
        $('#xform_contents2').html(c);

        // [2016-02-24 leesm] JS 편집 기능을 위해 추가(js 파일에 저장 될 내용 넣기)
        $('#xform_contents_js').val($w.$('#canvas_js').val());

        //restore main wrapper = bodytable_content
        var $header_seperator = $('#xform_header_seperator');
        $header_seperator.attr('id', 'bodytable_content');
        //$header_seperator.after('\n');

        var $header_next = $header_seperator.nextAll();
        $header_next.appendTo($header_seperator);

        //remove attributes 
        // [2016-02-23 leesm] 불필요한 class 속성들 삭제
        h = ['sortable', 'sortable-container', 'draggable', 'ui-sortable', 'group-focus', 'container-focus',
             'xform', 'container-focus', 'element-focus', 'xform-radio', 'xform-div', 'xform-checkbox',
             'div-container', 'table-container', 'element-mode-selected', 'style-matched', 'ui-state-active',
             'editable', 'table-edit-mode', 'block_fixed', 'glowing-red', 'draggable-ignore', 'draggable-item',
             'mode-radio', 'mode-checkbox', 'selectOptionEdit'
        ];

        for (var i in h) {
            r = h[i];
            $('#xform_contents2 *').removeClass(r);
        }

        //table편집을 위해 자동으로 부여된 id를 제거
        //xformid_로 시작
        //작성중...
        $('[id^=xformid_]').removeAttr('id');

        //remove element
        $('#xform_contents2 .xform-remove-this').remove();
        $('#xform_contents2 .JCLRgrips').remove();

        //remove noscript block
        var $hb = $('#xform_contents2 .xform-header-block').children();
        if ($hb.length > 0) $hb.unwrap();

        //remove noscript block
        var $sb = $('#xform_contents2 .xform-script-block').children();
        if ($sb.length > 0) $sb.unwrap();

        //remove empty class
        $('#xform_contents2 *[class=""]').removeAttr('class');
        $('#xform_contents2 .CRC').remove();
        $('#xform_contents2 .CRL').remove();
        $('#xform_contents').val($('#xform_contents2').html());

        $('#xform_body').after($('#xform_contents2').html());
        //$('#headname').html($w.$('#hidFormname').val()); header
        $('#headname').html(header);

        //$('body *').removeClass('.ui-sortable');
        //remove focus
        if (isConvert == 'y') {
            $w.postMessage('OK', "*");
        }
        $("#FormBody").show();

        setTimeout(function () {
            EASY.init();
        }, 300);
        

    }
    catch (e) {
        if (isConvert == 'y') {
            $w.postMessage('ERROR', "*")
        }else{
        	throw e;
        }
    }

    function loadMultiRow() {
        $('.multi-row-table').each(function () {
            var table_id = makeId();
            $(this).prop('id', table_id);
            XFORM.multirow.load('', 'json', '#' + table_id, 'W', { minLength: 3, rowColor: '#EFEFEF' });
        });
    }

    function makeId() {
        var text = "";
        var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

        for (var i = 0; i < 5; i++)
            text += possible.charAt(Math.floor(Math.random() * possible.length));

        return text;
    }

    loadMultiRow();

</script>
</body>
</html>