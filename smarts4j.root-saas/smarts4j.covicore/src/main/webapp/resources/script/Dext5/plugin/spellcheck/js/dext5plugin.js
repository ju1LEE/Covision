(function(){try{var c={pluginName:"spellcheck"};G_DEPlugin.spellcheck=c;var k=DEXTTOP.DEXT5.util.xml;c.onClickToolIcon=function(){1!=c.isProcess&&(c.isProcess=!0,showProcessingBackground(),setTimeout(function(){g_findRepalceRange=null;_dext_editor._LastRange=null;doSetCaretPosition(_iframeDoc.body.firstChild,0);var m=T.toString(),m=m.replace(/,/gi,""),e=function(){if("Y"==G_SC){var a=DEXTTOP.G_CURREDITOR._BODY.innerHTML,a=a.replace(/&nbsp;/gi," "),a=a.replace(/\+/gi,"%2B"),a=a.replace(/&amp;/gi,""),
a=a.replace(/&lt;/gi,"<"),a=a.replace(/&gt;/gi,">"),a=a.replace(/style[^>]*(.*?)/gi,""),a=a.replace(/<p><br><\/p>/gi,"\n"),a=a.replace(/<br>/gi,"\n"),a=a.replace(/<br >/gi,"\n"),a=a.replace(/<o:p>/gi,"\n"),a=a.replace(/<\/o:p>/gi,"\n"),a=a.replace(/<\/p>/gi,"\n"),a=a.replace(/<\/td>/gi,"\n"),b=new RegExp(DEXTTOP.G_CURREDITOR._config.unitAttributeDelimiter,"gi"),a=a.replace(new RegExp(DEXTTOP.G_CURREDITOR._config.unitDelimiter,"gi"),""),a=a.replace(b,""),a=a.replace(/<(\/)?([a-zA-Z0-9\u3131-\u314e\uac00-\ud7a3]*)(\s[a-zA-Z0-9\u3131-\u314e\uac00-\ud7a3]*=[^>]*)?(\s)*(\/)?>/gi,
""),b=DEXTTOP.G_CURREDITOR._BODY.innerText,b=b.replace(/\u00a0/gi,""),b=b.replace(/&nbsp/gi,""),b=b.replace(/ /gi,""),b=b.replace(/\r\n/gi,""),b=b.replace(/\n/gi,""),b=b.replace(/\r/gi,""),b=b.replace(/\s/gi,""),d=___;-1<d.indexOf("?")&&(d=d.substring(0,d.indexOf("?")));var h=d.indexOf("//"),d=-1<h?d.substring(0,d.substring(h+2).indexOf("/")+(h+2)+1):d.substring(0,d.indexOf("/")+1);if(void 0==c.weakRule||null==c.weakRule||""==c.weakRule)c.weakRule=!1;a="s01"+DEXTTOP.G_CURREDITOR._config.unitAttributeDelimiter+
"DE"+DEXTTOP.G_CURREDITOR._config.unitDelimiter+"s02"+DEXTTOP.G_CURREDITOR._config.unitAttributeDelimiter+DEXTTOP.G_CURREDITOR._config.productKey+DEXTTOP.G_CURREDITOR._config.unitDelimiter+"s03"+DEXTTOP.G_CURREDITOR._config.unitAttributeDelimiter+d+DEXTTOP.G_CURREDITOR._config.unitDelimiter+"s04"+DEXTTOP.G_CURREDITOR._config.unitAttributeDelimiter+a+DEXTTOP.G_CURREDITOR._config.unitDelimiter+"s05"+DEXTTOP.G_CURREDITOR._config.unitAttributeDelimiter+c.weakRule;a=encodeURI("s00="+DEXTTOP.DEXT5.util.makeEncryptParamEx3(a));
if(""==b||null==b||void 0==b)alert(dext5_lang.plugins.spellcheck.no_content),c.isProcess=!1,hideProcessingBackground();else{b=c.handlerURL;b=DEXTTOP.DEXT5.util.setProtocolBaseDomainURL(b);b=DEXTTOP.DEXT5.util.makeDecryptReponseMessageEx3(DEXTTOP.DEXT5.ajax.postData(b,a));if(null!=b&&-1!=b.indexOf("<?xml"))b=b.split("\f");else return alert("HandlerURL\uc758 \uc124\uc815\uac12\uc774 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \n\nspellcheck/js/config.js\uc758 handlerURL\uc758 \uac12\uc744 \ud655\uc778\ud558\uc138\uc694."),
c.isProcess=!1,hideProcessingBackground(),!1;a=[];for(d=0;d<b.length;d++){for(var h=DEXTTOP.DEXT5.util.stringToXML(b[d]),g=k.count(h,"PnuErrorWord"),e=0;e<g;e++){for(var f=k.getNodeIdx(h,"PnuErrorWord",e),n=[],l=k.count(f,"CandWord"),p=0;p<l;p++)n.push(k.getNodeValueIdx(f,"CandWord",p));f={word:k.getNodeValue(f,"OrgStr"),suggestions:n};""!=n&&-1==f.word.indexOf("\n")&&-1!=DEXTTOP.G_CURREDITOR._BODY.innerText.indexOf(f.word)&&a.push(f)}c.chkWordArr=a}0==a.length?(alert(dext5_lang.plugins.spellcheck.compMsg),
c.isProcess=!1,hideProcessingBackground()):DEXT5_EDITOR.prototype.dialog.show(_dext_editor._config.webPath.plugin,"spellcheck/editor_popup.html")}}else"N"==G_SC&&(alert(m+DEXTTOP.DEXT5.util.makeDecryptReponseMessage(M5)),c.isProcess=!1,hideProcessingBackground())};if(""==G_SC)var g=setInterval(function(){""!=G_SC&&(e(),hideProcessingBackground(),clearInterval(g))},100);else e()},100))};c.onInit=function(){l("../js"+(DEXTTOP.DEXT5.isRelease?"":"_dev")+"/aes.js");l("../plugin/spellcheck/js"+(DEXTTOP.DEXT5.isRelease?
"":"_dev")+"/config.js")};var l=function(c){var e=document.getElementsByTagName("head")[0],g=document.createElement("script");g.type="text/javascript";g.src=c;e.appendChild(g)};c.onInit()}catch(q){}})();
